{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2024-08-13T01:52:18.803121Z", "invocation_id": "42a217f7-97dd-44fb-9710-8d8cb034b95e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:07.296016Z", "completed_at": "2024-08-13T01:52:07.304264Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:07.305341Z", "completed_at": "2024-08-13T01:52:10.905458Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6105101108551025, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_auth_events\"} */\ninsert into \"iceberg\".\"analytics_source\".\"src_auth_events\" (\"id\", \"ts\", \"sessionid\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"success_boolean\")\n    (\n        select \"id\", \"ts\", \"sessionid\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"success_boolean\"\n        from \"iceberg\".\"analytics_source\".\"src_auth_events__dbt_tmp\"\n    )", "query_id": "20240813_015209_00010_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_auth_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(ts AS VARCHAR) as id, \n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        level,\n        itemInSession,\n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,\n        success\n    from \"postgresql\".\"public\".\"auth_events\"\n)\n\nselect\n    id,\n    ts,\n    sessionId,\n    level,\n    itemInSession,\n    city,\n    zip,\n    state,\n    userAgent,\n    lon,\n    lat,\n    userId,\n    lastName,\n    firstName,\n    gender,\n    registration, \n    CASE \n        WHEN CAST(success AS VARCHAR) = 't' THEN true \n        WHEN CAST(success AS VARCHAR) = 'f' THEN false\n        ELSE NULL \n    END AS success_boolean\nfrom source\n\n\n\n    where ts NOT IN (SELECT ts FROM \"iceberg\".\"analytics_source\".\"src_auth_events\")\n", "relation_name": "\"iceberg\".\"analytics_source\".\"src_auth_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:10.911525Z", "completed_at": "2024-08-13T01:52:10.915037Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:10.915037Z", "completed_at": "2024-08-13T01:52:11.906953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9979603290557861, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_listen_events\"} */\ninsert into \"iceberg\".\"analytics_source\".\"src_listen_events\" (\"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\")\n    (\n        select \"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\"\n        from \"iceberg\".\"analytics_source\".\"src_listen_events__dbt_tmp\"\n    )", "query_id": "20240813_015211_00016_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_listen_events", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        CAST(_id AS VARCHAR) as id,\n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS DOUBLE) as duration,\n        ts,\n        sessionid,\n        auth,\n        level,\n        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,\n        city,\n        zip,\n        state,\n        country,\n        userAgent,\n        CAST(NULLIF(lon, '') AS DOUBLE) as lon,\n        CAST(NULLIF(lat, '') AS DOUBLE) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,\n -- Assurez-vous que userId peut aussi \u00eatre converti de cette mani\u00e8re.\n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration\n    from \"mongo\".\"demo\".\"listen_events\"\n\n)\n\nselect * from source\n\n\n    where id NOT IN (SELECT id FROM \"iceberg\".\"analytics_source\".\"src_listen_events\")\n", "relation_name": "\"iceberg\".\"analytics_source\".\"src_listen_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:11.913304Z", "completed_at": "2024-08-13T01:52:11.917631Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:11.918139Z", "completed_at": "2024-08-13T01:52:12.785305Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.874119758605957, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_page_view_events\"} */\ninsert into \"iceberg\".\"analytics_source\".\"src_page_view_events\" (\"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\")\n    (\n        select \"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\"\n        from \"iceberg\".\"analytics_source\".\"src_page_view_events__dbt_tmp\"\n    )", "query_id": "20240813_015212_00022_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_page_view_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(_id AS VARCHAR) as id,\n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        page,\n        auth,\n        level,\n        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, \n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, \n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS double) as duration\n    from \"mongo\".\"demo\".\"page_view_events\"\n)\n\nselect * from source\n\n\n    where id NOT IN (SELECT id FROM \"iceberg\".\"analytics_source\".\"src_page_view_events\")\n", "relation_name": "\"iceberg\".\"analytics_source\".\"src_page_view_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:12.791702Z", "completed_at": "2024-08-13T01:52:12.794851Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:12.795384Z", "completed_at": "2024-08-13T01:52:12.991840Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20333361625671387, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_level_by_gender\"} */\n\n  create or replace view\n    \"iceberg\".\"analytics_stage\".\"stg_user_level_by_gender\"\n  security definer\n  as\n    \n\nWITH user_subscriptions AS (\n    SELECT\n        gender,\n        level, \n        COUNT(DISTINCT userId) AS user_count\n    FROM \"iceberg\".\"analytics_source\".\"src_auth_events\"\n    WHERE gender IS NOT NULL AND level IS NOT NULL\n    GROUP BY gender, level\n)\n\nSELECT\n    gender,\n    level,\n    user_count\nFROM user_subscriptions\n  ", "query_id": "20240813_015212_00024_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_level_by_gender", "compiled": true, "compiled_code": "\n\nWITH user_subscriptions AS (\n    SELECT\n        gender,\n        level, \n        COUNT(DISTINCT userId) AS user_count\n    FROM \"iceberg\".\"analytics_source\".\"src_auth_events\"\n    WHERE gender IS NOT NULL AND level IS NOT NULL\n    GROUP BY gender, level\n)\n\nSELECT\n    gender,\n    level,\n    user_count\nFROM user_subscriptions", "relation_name": "\"iceberg\".\"analytics_stage\".\"stg_user_level_by_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:13.001660Z", "completed_at": "2024-08-13T01:52:13.005912Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:13.005912Z", "completed_at": "2024-08-13T01:52:14.346647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3471243381500244, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_streams_hourly\"} */\n\n  \n    \n\n    create table \"iceberg\".\"analytics_stage\".\"stg_streams_hourly__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, \n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,\n    COUNT(*) AS total_streams\nFROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\nGROUP BY\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')\n    )", "query_id": "20240813_015213_00025_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_streams_hourly", "compiled": true, "compiled_code": "\n\nSELECT\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, \n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,\n    COUNT(*) AS total_streams\nFROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\nGROUP BY\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')", "relation_name": "\"iceberg\".\"analytics_stage\".\"stg_streams_hourly\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:14.354201Z", "completed_at": "2024-08-13T01:52:14.357981Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:14.358509Z", "completed_at": "2024-08-13T01:52:14.467937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11640048027038574, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_top_songs_artists\"} */\n\n  create or replace view\n    \"iceberg\".\"analytics_stage\".\"stg_top_songs_artists\"\n  security definer\n  as\n    \n\nWITH song_plays AS (\n    SELECT\n        artist,\n        song,\n        COUNT(*) AS play_count\n    FROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\n    GROUP BY artist, song\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM song_plays\nORDER BY play_count DESC\n  ", "query_id": "20240813_015214_00029_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_top_songs_artists", "compiled": true, "compiled_code": "\n\nWITH song_plays AS (\n    SELECT\n        artist,\n        song,\n        COUNT(*) AS play_count\n    FROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\n    GROUP BY artist, song\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM song_plays\nORDER BY play_count DESC", "relation_name": "\"iceberg\".\"analytics_stage\".\"stg_top_songs_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:14.474487Z", "completed_at": "2024-08-13T01:52:14.480145Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:14.480145Z", "completed_at": "2024-08-13T01:52:14.581111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10877180099487305, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_unique_users\"} */\n\n  create or replace view\n    \"iceberg\".\"analytics_stage\".\"stg_unique_users\"\n  security definer\n  as\n    \n\nSELECT\n    COUNT(DISTINCT userid) AS total_unique_users\nFROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\nWHERE userid IS NOT NULL\n  ", "query_id": "20240813_015214_00030_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_unique_users", "compiled": true, "compiled_code": "\n\nSELECT\n    COUNT(DISTINCT userid) AS total_unique_users\nFROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\nWHERE userid IS NOT NULL", "relation_name": "\"iceberg\".\"analytics_stage\".\"stg_unique_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:14.587291Z", "completed_at": "2024-08-13T01:52:14.591014Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:14.591014Z", "completed_at": "2024-08-13T01:52:14.709734Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12402153015136719, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_activity_per_country\"} */\n\n  create or replace view\n    \"iceberg\".\"analytics_stage\".\"stg_user_activity_per_country\"\n  security definer\n  as\n    \n\nWITH combined_activities AS (\n  SELECT\n    country,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\n  WHERE country IS NOT NULL\n  UNION ALL\n  SELECT\n    'Unknown' AS country,\n    'auth_event' AS event_type, \n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    'Unknown' AS country, \n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  country,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY country\n  ", "query_id": "20240813_015214_00031_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_activity_per_country", "compiled": true, "compiled_code": "\n\nWITH combined_activities AS (\n  SELECT\n    country,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\n  WHERE country IS NOT NULL\n  UNION ALL\n  SELECT\n    'Unknown' AS country,\n    'auth_event' AS event_type, \n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    'Unknown' AS country, \n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  country,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY country", "relation_name": "\"iceberg\".\"analytics_stage\".\"stg_user_activity_per_country\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:14.716166Z", "completed_at": "2024-08-13T01:52:14.719843Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:14.719843Z", "completed_at": "2024-08-13T01:52:14.844589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1300520896911621, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_activity_per_location\"} */\n\n  create or replace view\n    \"iceberg\".\"analytics_stage\".\"stg_user_activity_per_location\"\n  security definer\n  as\n    \n\nWITH combined_activities AS (\n  SELECT\n    city,\n    state,\n    'auth_event' AS event_type,\n    ts,\n    userid\n FROM \"iceberg\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  state,\n  city,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY state, city\n  ", "query_id": "20240813_015214_00032_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_activity_per_location", "compiled": true, "compiled_code": "\n\nWITH combined_activities AS (\n  SELECT\n    city,\n    state,\n    'auth_event' AS event_type,\n    ts,\n    userid\n FROM \"iceberg\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_listen_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"iceberg\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  state,\n  city,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY state, city", "relation_name": "\"iceberg\".\"analytics_stage\".\"stg_user_activity_per_location\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:14.848925Z", "completed_at": "2024-08-13T01:52:14.852102Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:14.852624Z", "completed_at": "2024-08-13T01:52:15.623323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7764883041381836, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_level_by_gender\"} */\n\n  \n    \n\n    create table \"iceberg\".\"analytics\".\"mart_user_level_by_gender__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    gender,\n    level,\n    SUM(user_count) AS total_users,\n    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users\nFROM \"iceberg\".\"analytics_stage\".\"stg_user_level_by_gender\"\nGROUP BY gender, level\n    )", "query_id": "20240813_015214_00033_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_level_by_gender", "compiled": true, "compiled_code": "\n\nSELECT\n    gender,\n    level,\n    SUM(user_count) AS total_users,\n    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users\nFROM \"iceberg\".\"analytics_stage\".\"stg_user_level_by_gender\"\nGROUP BY gender, level", "relation_name": "\"iceberg\".\"analytics\".\"mart_user_level_by_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:15.630208Z", "completed_at": "2024-08-13T01:52:15.634396Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:15.634931Z", "completed_at": "2024-08-13T01:52:16.257119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6294755935668945, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_hourly_stream_evolution\"} */\n\n  \n    \n\n    create table \"iceberg\".\"analytics\".\"mart_hourly_stream_evolution__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    stream_date,\n    stream_hour,\n    total_streams,\n    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams\nFROM \"iceberg\".\"analytics_stage\".\"stg_streams_hourly\"\nORDER BY\n    stream_date,\n    stream_hour\n    )", "query_id": "20240813_015215_00037_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution", "compiled": true, "compiled_code": "\n\nSELECT\n    stream_date,\n    stream_hour,\n    total_streams,\n    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams\nFROM \"iceberg\".\"analytics_stage\".\"stg_streams_hourly\"\nORDER BY\n    stream_date,\n    stream_hour", "relation_name": "\"iceberg\".\"analytics\".\"mart_hourly_stream_evolution\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:16.263054Z", "completed_at": "2024-08-13T01:52:16.267803Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:16.268319Z", "completed_at": "2024-08-13T01:52:16.848748Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5872817039489746, "adapter_response": {"_message": "SUCCESS", "rows_affected": 14, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_top_songs_artists\"} */\n\n  \n    \n\n    create table \"iceberg\".\"analytics\".\"mart_top_songs_artists__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH top_songs AS (\n    SELECT\n        artist,\n        song,\n        play_count\n    FROM \"iceberg\".\"analytics_stage\".\"stg_top_songs_artists\"\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM top_songs\n    )", "query_id": "20240813_015216_00041_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_top_songs_artists", "compiled": true, "compiled_code": "\n\nWITH top_songs AS (\n    SELECT\n        artist,\n        song,\n        play_count\n    FROM \"iceberg\".\"analytics_stage\".\"stg_top_songs_artists\"\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM top_songs", "relation_name": "\"iceberg\".\"analytics\".\"mart_top_songs_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:16.854971Z", "completed_at": "2024-08-13T01:52:16.858109Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:16.858109Z", "completed_at": "2024-08-13T01:52:17.435126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5822563171386719, "adapter_response": {"_message": "SUCCESS", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_total_unique_users\"} */\n\n  \n    \n\n    create table \"iceberg\".\"analytics\".\"mart_total_unique_users__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    total_unique_users\nFROM \"iceberg\".\"analytics_stage\".\"stg_unique_users\"\n    )", "query_id": "20240813_015216_00045_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_total_unique_users", "compiled": true, "compiled_code": "\n\nSELECT\n    total_unique_users\nFROM \"iceberg\".\"analytics_stage\".\"stg_unique_users\"", "relation_name": "\"iceberg\".\"analytics\".\"mart_total_unique_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:17.440973Z", "completed_at": "2024-08-13T01:52:17.443568Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:17.444578Z", "completed_at": "2024-08-13T01:52:18.142168Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7032771110534668, "adapter_response": {"_message": "SUCCESS", "rows_affected": 6, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_activity_per_country\"} */\n\n  \n    \n\n    create table \"iceberg\".\"analytics\".\"mart_user_activity_per_country__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  country,\n  SUM(activity_count) AS total_activity\nFROM \"iceberg\".\"analytics_stage\".\"stg_user_activity_per_country\"\nGROUP BY country\nORDER BY SUM(activity_count) DESC\n    )", "query_id": "20240813_015217_00049_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_activity_per_country", "compiled": true, "compiled_code": "\n\nSELECT\n  country,\n  SUM(activity_count) AS total_activity\nFROM \"iceberg\".\"analytics_stage\".\"stg_user_activity_per_country\"\nGROUP BY country\nORDER BY SUM(activity_count) DESC", "relation_name": "\"iceberg\".\"analytics\".\"mart_user_activity_per_country\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-13T01:52:18.148615Z", "completed_at": "2024-08-13T01:52:18.154119Z"}, {"name": "execute", "started_at": "2024-08-13T01:52:18.154647Z", "completed_at": "2024-08-13T01:52:18.795566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6501455307006836, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.5\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_activity_per_state\"} */\n\n  \n    \n\n    create table \"iceberg\".\"analytics\".\"mart_user_activity_per_state__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  state,\n  city,\n  SUM(activity_count) AS total_activity\nFROM \"iceberg\".\"analytics_stage\".\"stg_user_activity_per_location\"\nGROUP BY state, city\nORDER BY state, SUM(activity_count) DESC\n    )", "query_id": "20240813_015218_00053_2m54m"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_activity_per_state", "compiled": true, "compiled_code": "\n\nSELECT\n  state,\n  city,\n  SUM(activity_count) AS total_activity\nFROM \"iceberg\".\"analytics_stage\".\"stg_user_activity_per_location\"\nGROUP BY state, city\nORDER BY state, SUM(activity_count) DESC", "relation_name": "\"iceberg\".\"analytics\".\"mart_user_activity_per_state\""}], "elapsed_time": 13.778477430343628, "args": {"which": "run", "log_format_file": "debug", "log_format": "default", "introspect": true, "log_level": "info", "enable_legacy_logger": false, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "vars": {}, "strict_mode": false, "indirect_selection": "eager", "project_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt", "show_resource_report": false, "use_colors_file": true, "static_parser": true, "log_level_file": "debug", "cache_selected_only": false, "print": true, "populate_cache": true, "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt", "select": [], "write_json": true, "printer_width": 80, "use_colors": true, "empty": false, "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs", "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "partial_parse": true, "log_file_max_bytes": 10485760, "quiet": false, "invocation_command": "dbt run", "version_check": true, "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "exclude": [], "require_resource_names_without_spaces": false, "favor_state": false}}