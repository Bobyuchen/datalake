{"data": {"log_version": 3, "version": "=1.8.8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Running with dbt=1.8.8", "name": "MainReportVersion", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:32.527767Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_specimen my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_procedure_occurrence", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop\\target\\my_dbt_trino_project_dbt_assets-c6dd672-4e3b951", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\my_dbt_trino_project_dbt_assets-c6dd672-4e3b951", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop\\\\target\\\\my_dbt_trino_project_dbt_assets-c6dd672-4e3b951', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'static_parser': 'True', 'invocation_command': 'dbt build --select my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_specimen my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_procedure_occurrence', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'target\\\\my_dbt_trino_project_dbt_assets-c6dd672-4e3b951', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:32.527767Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Registered adapter: trino=1.8.2", "name": "AdapterRegistered", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:33.061184Z"}}
{"data": {"checksum": "ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5", "profile": "", "target": "", "vars": "{}", "version": "1.8.8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8", "name": "StateCheckVarsHash", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:33.120386Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:33.564260Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:33.564260Z"}}
{"data": {"unused_config_paths": ["models.my_dbt_trino_project.source", "models.my_dbt_trino_project.stage"]}, "info": {"category": "", "code": "I051", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 2 unused configuration paths:\n- models.my_dbt_trino_project.source\n- models.my_dbt_trino_project.stage", "name": "UnusedResourceConfigPath", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:33.573028Z"}}
{"data": {"stat_line": "86 models, 2 operations, 15 sources, 1337 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Found 86 models, 2 operations, 15 sources, 1337 macros", "name": "FoundStats", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:33.991968Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:34.009941Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:34.009941Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 49820, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T08:20:34.025690Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 49820, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T08:20:34.281631Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 49820, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T08:20:34.281631Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 49820, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T08:20:34.281631Z"}}
{"data": {"elapsed": 0.3237423, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: SUCCESS in 0.324 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T08:20:34.607758Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T08:20:34.609529Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_omop'", "name": "NewConnection", "pid": 49820, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T08:20:34.620163Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"list_iceberg_omop\"", "name": "ConnectionUsed", "pid": 49820, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T08:20:34.645051Z"}}
{"data": {"conn_name": "list_iceberg_omop", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On list_iceberg_omop: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'", "name": "SQLQuery", "pid": 49820, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T08:20:34.646795Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 49820, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T08:20:34.648529Z"}}
{"data": {"elapsed": 0.9763715, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: SUCCESS in 0.976 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T08:20:35.625088Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On list_iceberg_omop: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T08:20:35.628172Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On list_iceberg_omop: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T08:20:35.631168Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:35.661308Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:35.662892Z"}}
{"data": {"hook_type": "on-run-start", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Running 1 on-run-start hook", "name": "HooksRunning", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:35.663926Z"}}
{"data": {"msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "name": "JinjaLogInfo", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:35.760433Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:35.818761Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'", "name": "SQLQuery", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:35.820500Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:35.822515Z"}}
{"data": {"elapsed": 0.2567479, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: SUCCESS in 0.257 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.078774Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-start-0\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.085153Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]", "name": "LogHookStartLine", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.098212Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T08:20:36.099282", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:35.666488", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-start.0 ...................................... [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.099843Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.100961Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.101509Z"}}
{"data": {"node_count": 8, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.103046Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:36.105587Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_care_site", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.111755Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "1 of 8 START sql table model omop.omop_care_site ............................... [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.113498Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Acquiring new trino connection 'model.my_dbt_trino_project.omop_care_site'", "name": "NewConnection", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.115970Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_care_site", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.116987Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.124597Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_care_site", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.127154Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.209763Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.216202Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.217210Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:36.218215Z"}}
{"data": {"elapsed": 1.210466, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (3 rows) in 1.210 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.429850Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.445246Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.445440Z"}}
{"data": {"elapsed": 0.112962, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.113 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.559231Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.564917Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.564917Z"}}
{"data": {"elapsed": 0.1198049, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.120 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.690487Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.711081Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.718474Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.720126Z"}}
{"data": {"elapsed": 0.1886741, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.189 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.910247Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.943708Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.944829Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "execution_time": 1.8307433, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:37.945893", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "1 of 8 OK created sql table model omop.omop_care_site .......................... [\u001b[32mCREATE TABLE (3 rows)\u001b[0m in 1.83s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.947554Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:37.945893", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:36.109978", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_075834_00473_u6rsp", "rows_affected": 3.0}, "execution_time": 1.8307433, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:36.126633Z", "name": "compile", "started_at": "2024-10-25T08:20:36.116987Z"}, {"completed_at": "2024-10-25T08:20:37.943708Z", "name": "execute", "started_at": "2024-10-25T08:20:36.127274Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_care_site", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.951577Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_measurement", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.953222Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "2 of 8 START sql table model omop.omop_measurement ............................. [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.954827Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "orig_conn_name": "model.my_dbt_trino_project.omop_care_site"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_care_site, now model.my_dbt_trino_project.omop_measurement)", "name": "ConnectionReused", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.955878Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_measurement", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.956989Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.965369Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_measurement", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.967281Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.981059Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.986972Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.988605Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:37.989704Z"}}
{"data": {"elapsed": 1.0197451, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 1.020 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.009570Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.018559Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.018559Z"}}
{"data": {"elapsed": 0.1042523, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.104 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.124703Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.135622Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.137630Z"}}
{"data": {"elapsed": 0.0957835, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.096 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.235144Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.241656Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.243415Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.245151Z"}}
{"data": {"elapsed": 0.1297288, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.130 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.375468Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.380292Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.381863Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "execution_time": 1.4268224, "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:39.382701", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "2 of 8 OK created sql table model omop.omop_measurement ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.43s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.384327Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:39.382701", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:37.953222", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_075836_00477_u6rsp", "rows_affected": 5.0}, "execution_time": 1.4268224, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:37.967281Z", "name": "compile", "started_at": "2024-10-25T08:20:37.958160Z"}, {"completed_at": "2024-10-25T08:20:39.380292Z", "name": "execute", "started_at": "2024-10-25T08:20:37.968371Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_measurement", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.386828Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_observation", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.388542Z"}}
{"data": {"description": "sql table model omop.omop_observation", "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "3 of 8 START sql table model omop.omop_observation ............................. [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.389506Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "orig_conn_name": "model.my_dbt_trino_project.omop_measurement"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_measurement, now model.my_dbt_trino_project.omop_observation)", "name": "ConnectionReused", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.392488Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_observation", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.394075Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_observation\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.401135Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_observation", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.405533Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.419330Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.427029Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.427029Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:39.430142Z"}}
{"data": {"elapsed": 0.7465909, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.747 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.175416Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.186701Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.187375Z"}}
{"data": {"elapsed": 0.0937745, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.094 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.282562Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.291759Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.294469Z"}}
{"data": {"elapsed": 0.0966542, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.097 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.392140Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.400111Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.404145Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.405639Z"}}
{"data": {"elapsed": 0.1276838, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.128 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.534546Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.539899Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.541412Z"}}
{"data": {"description": "sql table model omop.omop_observation", "execution_time": 1.1505461, "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:40.543034", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "3 of 8 OK created sql table model omop.omop_observation ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.15s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.543560Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:40.543034", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:39.388542", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_075837_00481_u6rsp", "rows_affected": 5.0}, "execution_time": 1.1505461, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:39.403169Z", "name": "compile", "started_at": "2024-10-25T08:20:39.395801Z"}, {"completed_at": "2024-10-25T08:20:40.539899Z", "name": "execute", "started_at": "2024-10-25T08:20:39.406566Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_observation", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.545679Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_person", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.547865Z"}}
{"data": {"description": "sql table model omop.omop_person", "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "4 of 8 START sql table model omop.omop_person .................................. [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.548963Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "orig_conn_name": "model.my_dbt_trino_project.omop_observation"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_observation, now model.my_dbt_trino_project.omop_person)", "name": "ConnectionReused", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.550644Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_person", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.551763Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_person\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.559603Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_person", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.559603Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.574042Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.580324Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.581454Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:40.582042Z"}}
{"data": {"elapsed": 0.6139664, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.614 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.196067Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.205495Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.205495Z"}}
{"data": {"elapsed": 0.0854579, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.085 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.292344Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.293482Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.301700Z"}}
{"data": {"elapsed": 0.0846279, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.085 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.387814Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.391077Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.395708Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.395708Z"}}
{"data": {"elapsed": 0.1308119, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.131 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.524054Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.533058Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.534814Z"}}
{"data": {"description": "sql table model omop.omop_person", "execution_time": 0.98590827, "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:41.536552", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "4 of 8 OK created sql table model omop.omop_person ............................. [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.99s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.536552Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:41.536552", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:40.547306", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_075839_00485_u6rsp", "rows_affected": 1.0}, "execution_time": 0.98590827, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:40.559603Z", "name": "compile", "started_at": "2024-10-25T08:20:40.552318Z"}, {"completed_at": "2024-10-25T08:20:41.533058Z", "name": "execute", "started_at": "2024-10-25T08:20:40.559603Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_person", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.538293Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.540032Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "5 of 8 START sql table model omop.omop_procedure_occurrence .................... [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.540032Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_person"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_person, now model.my_dbt_trino_project.omop_procedure_occurrence)", "name": "ConnectionReused", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.542042Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.542042Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.551834Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.551834Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.564404Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.566421Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.568461Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:41.569998Z"}}
{"data": {"elapsed": 0.4559899, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.456 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.026566Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.032296Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.033365Z"}}
{"data": {"elapsed": 0.0975777, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.098 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.131984Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.142237Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.143908Z"}}
{"data": {"elapsed": 0.1054089, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.105 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.250560Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.260862Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.263524Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.264580Z"}}
{"data": {"elapsed": 0.1259104, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.126 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.391716Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.394827Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.394827Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "execution_time": 0.8527856, "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:42.394827", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "5 of 8 OK created sql table model omop.omop_procedure_occurrence ............... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.85s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.394827Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:42.394827", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:41.540032", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_075840_00489_u6rsp", "rows_affected": 1.0}, "execution_time": 0.8527856, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:41.551834Z", "name": "compile", "started_at": "2024-10-25T08:20:41.542042Z"}, {"completed_at": "2024-10-25T08:20:42.394827Z", "name": "execute", "started_at": "2024-10-25T08:20:41.554438Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.398848Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_provider", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.398848Z"}}
{"data": {"description": "sql table model omop.omop_provider", "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "6 of 8 START sql table model omop.omop_provider ................................ [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.401269Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "orig_conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_procedure_occurrence, now model.my_dbt_trino_project.omop_provider)", "name": "ConnectionReused", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.402291Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_provider", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.402291Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_provider\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.409572Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_provider", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.411330Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.420251Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.425162Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.425162Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.427317Z"}}
{"data": {"elapsed": 0.4453344, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (6 rows) in 0.445 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.873170Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.883120Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.883120Z"}}
{"data": {"elapsed": 0.0876379, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.088 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.972330Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.978817Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:42.978817Z"}}
{"data": {"elapsed": 0.0966702, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.097 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.079126Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.085586Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.085586Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.085586Z"}}
{"data": {"elapsed": 0.1291486, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.129 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.216687Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.221330Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.221330Z"}}
{"data": {"description": "sql table model omop.omop_provider", "execution_time": 0.82106614, "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:43.223358", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "6 of 8 OK created sql table model omop.omop_provider ........................... [\u001b[32mCREATE TABLE (6 rows)\u001b[0m in 0.82s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.223358Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:43.223358", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:42.398848", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_075840_00493_u6rsp", "rows_affected": 6.0}, "execution_time": 0.82106614, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:42.411057Z", "name": "compile", "started_at": "2024-10-25T08:20:42.402291Z"}, {"completed_at": "2024-10-25T08:20:43.221330Z", "name": "execute", "started_at": "2024-10-25T08:20:42.411330Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_provider", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.223358Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_specimen", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.228284Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "7 of 8 START sql table model omop.omop_specimen ................................ [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.230048Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "orig_conn_name": "model.my_dbt_trino_project.omop_provider"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_provider, now model.my_dbt_trino_project.omop_specimen)", "name": "ConnectionReused", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.230048Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_specimen", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.230048Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.241685Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_specimen", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.243973Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.252670Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.254293Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.254293Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.254293Z"}}
{"data": {"elapsed": 0.4307522, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.431 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.688081Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.694850Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.694850Z"}}
{"data": {"elapsed": 0.0838931, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.084 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.777293Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.787646Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.787646Z"}}
{"data": {"elapsed": 0.0912774, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.091 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.877389Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.887438Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.887438Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:43.889458Z"}}
{"data": {"elapsed": 0.130573, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.131 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.020766Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.020766Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.020766Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "execution_time": 0.7971828, "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:44.027232", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "7 of 8 OK created sql table model omop.omop_specimen ........................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.80s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.028241Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:44.027232", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:43.228284", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_075841_00497_u6rsp", "rows_affected": 1.0}, "execution_time": 0.7971828, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:43.242214Z", "name": "compile", "started_at": "2024-10-25T08:20:43.230048Z"}, {"completed_at": "2024-10-25T08:20:44.020766Z", "name": "execute", "started_at": "2024-10-25T08:20:43.243973Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_specimen", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.029995Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeStart", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.031736Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "8 of 8 START sql table model omop.omop_visit_occurrence ........................ [RUN]", "name": "LogStartLine", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.033475Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_specimen"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_specimen, now model.my_dbt_trino_project.omop_visit_occurrence)", "name": "ConnectionReused", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.035213Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeCompiling", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.035213Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.045181Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeExecuting", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.050082Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.060342Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.060342Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.060342Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.067283Z"}}
{"data": {"elapsed": 0.4476006, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.448 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.515013Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.521847Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.522232Z"}}
{"data": {"elapsed": 0.0776352, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.078 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.600965Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.607834Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.608931Z"}}
{"data": {"elapsed": 0.0823052, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.082 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.692079Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.696885Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.696885Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.696885Z"}}
{"data": {"elapsed": 0.1207553, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: DROP TABLE in 0.121 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.823845Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: ROLLBACK", "name": "Rollback", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.825649Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.825649Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "execution_time": 0.7904358, "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:44.825649", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "8 of 8 OK created sql table model omop.omop_visit_occurrence ................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.79s]", "name": "LogModelResult", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.829781Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T08:20:44.825649", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.031736", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_075842_00501_u6rsp", "rows_affected": 1.0}, "execution_time": 0.7904358, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:44.050082Z", "name": "compile", "started_at": "2024-10-25T08:20:44.035213Z"}, {"completed_at": "2024-10-25T08:20:44.825649Z", "name": "execute", "started_at": "2024-10-25T08:20:44.050082Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeFinished", "pid": 49820, "thread": "Thread-1 (worker)", "ts": "2024-10-25T08:20:44.831950Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:44.831950Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:44.835890Z"}}
{"data": {"hook_type": "on-run-end", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Running 1 on-run-end hook", "name": "HooksRunning", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:44.836972Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:44.910200Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash", "name": "SQLQuery", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:44.910200Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:44.915128Z"}}
{"data": {"elapsed": 0.5663954, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: SUCCESS in 0.566 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.479450Z"}}
{"data": {"msg": "Elementary: Uploading dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Uploading dbt artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.502264Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_models] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.566072Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.705569Z"}}
{"data": {"msg": "Elementary: [dbt_models] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_models] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.711106Z"}}
{"data": {"msg": "Elementary: [dbt_models] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_models] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.718842Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.718842Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.138421 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.138421 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.718842Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.153785 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.153785 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.718842Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_tests] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.735992Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.739492Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.742960Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_tests] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.744469Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.747742Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.750140Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.011750 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.011750 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.752676Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_sources] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.759561Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.797022Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.797022Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_sources] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.797022Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.797022Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.037461 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.037461 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.797022Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.037461 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.037461 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.812748Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.818948Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.825678Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.828452Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.828452Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.828452Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.828452Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.009504 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.009504 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.828452Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.851370Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.851370Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.851370Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_metrics] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.860260Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.863519Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.865823Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.015965 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.015965 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.867578Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.881423Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.883170Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.883170Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_exposures] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.889541Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.891560Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.891560Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.010610 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.010610 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.891560Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.903563Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.907628Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.907628Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_seeds] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.907628Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.907628Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.907628Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.004065 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.004065 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.907628Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_columns] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:45.925612Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.694442Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.694442Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_columns] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.694442Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.694442Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.767089 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.767089 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.694442Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.768830 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.768830 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.694442Z"}}
{"data": {"msg": "Elementary: Uploaded dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Uploaded dbt artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.694442Z"}}
{"data": {"msg": "Elementary: Uploading run results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Uploading run results.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.717728Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.719468Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.784943Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.821063Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "SQLQuery", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:46.821063Z"}}
{"data": {"elapsed": 0.1942831, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: SUCCESS in 0.194 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.027226Z"}}
{"data": {"msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.035986Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.270550Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.281643Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',1.8307433128356934,'2024-10-25T08:20:36.127274Z','2024-10-25T08:20:37.943708Z','2024-10-25T08:20:36.116987Z','2024-10-25T08:20:36.126633Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_075834_00473_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_075834_00473_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.4268224239349365,'2024-10-25T08:20:37.968371Z','2024-10-25T08:20:39.380292Z','2024-10-25T08:20:37.958160Z','2024-10-25T08:20:37.967281Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_075836_00477_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_075836_00477_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.1505460739135742,'2024-10-25T08:20:39.406566Z','2024-10-25T08:20:40.539899Z','2024-10-25T08:20:39.395801Z','2024-10-25T08:20:39.403169Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_075837_00481_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_075837_00481_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',0.9859082698822021,'2024-10-25T08:20:40.559603Z','2024-10-25T08:20:41.533058Z','2024-10-25T08:20:40.552318Z','2024-10-25T08:20:40.559603Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_075839_00485_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_075839_00485_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',0.852785587310791,'2024-10-25T08:20:41.554438Z','2024-10-25T08:20:42.394827Z','2024-10-25T08:20:41.542042Z','2024-10-25T08:20:41.551834Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_075840_00489_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_075840_00489_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',0.82106614112854,'2024-10-25T08:20:42.411330Z','2024-10-25T08:20:43.221330Z','2024-10-25T08:20:42.402291Z','2024-10-25T08:20:42.411057Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_075840_00493_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_075840_00493_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',0.7971827983856201,'2024-10-25T08:20:43.243973Z','2024-10-25T08:20:44.020766Z','2024-10-25T08:20:43.230048Z','2024-10-25T08:20:43.242214Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_075841_00497_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_075841_00497_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',0.790435791015625,'2024-10-25T08:20:44.050082Z','2024-10-25T08:20:44.825649Z','2024-10-25T08:20:44.035213Z','2024-10-25T08:20:44.050082Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_075842_00501_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_075842_00501_u6rsp\"}')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',1.8307433128356934,'2024-10-25T08:20:36.127274Z','2024-10-25T08:20:37.943708Z','2024-10-25T08:20:36.116987Z','2024-10-25T08:20:36.126633Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_075834_00473_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_075834_00473_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.4268224239349365,'2024-10-25T08:20:37.968371Z','2024-10-25T08:20:39.380292Z','2024-10-25T08:20:37.958160Z','2024-10-25T08:20:37.967281Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_075836_00477_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_075836_00477_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.1505460739135742,'2024-10-25T08:20:39.406566Z','2024-10-25T08:20:40.539899Z','2024-10-25T08:20:39.395801Z','2024-10-25T08:20:39.403169Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_075837_00481_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_075837_00481_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',0.9859082698822021,'2024-10-25T08:20:40.559603Z','2024-10-25T08:20:41.533058Z','2024-10-25T08:20:40.552318Z','2024-10-25T08:20:40.559603Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_075839_00485_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_075839_00485_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',0.852785587310791,'2024-10-25T08:20:41.554438Z','2024-10-25T08:20:42.394827Z','2024-10-25T08:20:41.542042Z','2024-10-25T08:20:41.551834Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_075840_00489_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_075840_00489_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',0.82106614112854,'2024-10-25T08:20:42.411330Z','2024-10-25T08:20:43.221330Z','2024-10-25T08:20:42.402291Z','2024-10-25T08:20:42.411057Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_075840_00493_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_075840_00493_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',0.7971827983856201,'2024-10-25T08:20:43.243973Z','2024-10-25T08:20:44.020766Z','2024-10-25T08:20:43.230048Z','2024-10-25T08:20:43.242214Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_075841_00497_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_075841_00497_u6rsp\"}'),('430e9c38-03cc-4972-8fa3-1cbb6e903e44.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','430e9c38-03cc-4972-8fa3-1cbb6e903e44','2024-10-25 08:20:46',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',0.790435791015625,'2024-10-25T08:20:44.050082Z','2024-10-25T08:20:44.825649Z','2024-10-25T08:20:44.035213Z','2024-10-25T08:20:44.050082Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_075842_00501_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_075842_00501_u6rsp\"}')", "name": "SQLQuery", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.281643Z"}}
{"data": {"elapsed": 0.5123736, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (8 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: INSERT (8 rows) in 0.512 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.799116Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.803985Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.065475 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.065475 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.805620Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.230820 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.230820 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.807820Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.808903Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.202773 (8 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.202773 (8 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.810527Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.218899 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.218899 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.811608Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.529609 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.529609 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.813243Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.997732 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.997732 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.816444Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.083985 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.083985 (1 runs)", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.816444Z"}}
{"data": {"msg": "Elementary: Uploaded run results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Uploaded run results successfully.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.821581Z"}}
{"data": {"msg": "Elementary: Handling test results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Handling test results.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.836651Z"}}
{"data": {"msg": "Elementary: Handled test results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Handled test results successfully.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.874721Z"}}
{"data": {"msg": "Elementary: Uploading dbt invocation.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Uploading dbt invocation.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:47.903013Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.007589Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "SQLQuery", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.007589Z"}}
{"data": {"elapsed": 0.1657476, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: SUCCESS in 0.166 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.175385Z"}}
{"data": {"msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.178667Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.210813Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.210813Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('430e9c38-03cc-4972-8fa3-1cbb6e903e44',NULL,NULL,NULL,'2024-10-25 08:20:32','2024-10-25 08:20:47','2024-10-25 08:20:47',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_specimen\", \"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('430e9c38-03cc-4972-8fa3-1cbb6e903e44',NULL,NULL,NULL,'2024-10-25 08:20:32','2024-10-25 08:20:47','2024-10-25 08:20:47',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_specimen\", \"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')", "name": "SQLQuery", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.210813Z"}}
{"data": {"elapsed": 0.4855761, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "SQL status: INSERT (1 rows) in 0.486 seconds", "name": "SQLQueryStatus", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.704052Z"}}
{"data": {"msg": "Elementary: Uploaded dbt invocation successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Elementary: Uploaded dbt invocation successfully.", "name": "JinjaLogDebug", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.707343Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-end-0\"", "name": "WritingInjectedSQLForNode", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.716891Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]", "name": "LogHookStartLine", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.718631Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T08:20:48.718631", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T08:20:44.836972", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-end.0 ........................................ [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.718631Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.720366Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.720366Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.722375Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Connection 'list_iceberg' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.722375Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Connection 'list_iceberg_omop' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.722375Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Connection 'model.my_dbt_trino_project.omop_visit_occurrence' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.722375Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.725861Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 14.72 seconds", "execution_time": 14.715413, "stat_line": "8 table models, 2 project hooks"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Finished running 8 table models, 2 project hooks in 0 hours 0 minutes and 14.72 seconds (14.72s).", "name": "FinishedRunningStats", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.726240Z"}}
{"data": {"elapsed_time": 14.715413, "generated_at": "2024-10-25T08:20:48Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_075834_00473_u6rsp", "rows_affected": 3.0}, "execution_time": 1.8307433, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:36.126633Z", "name": "compile", "started_at": "2024-10-25T08:20:36.116987Z"}, {"completed_at": "2024-10-25T08:20:37.943708Z", "name": "execute", "started_at": "2024-10-25T08:20:36.127274Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_075836_00477_u6rsp", "rows_affected": 5.0}, "execution_time": 1.4268224, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:37.967281Z", "name": "compile", "started_at": "2024-10-25T08:20:37.958160Z"}, {"completed_at": "2024-10-25T08:20:39.380292Z", "name": "execute", "started_at": "2024-10-25T08:20:37.968371Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_075837_00481_u6rsp", "rows_affected": 5.0}, "execution_time": 1.1505461, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:39.403169Z", "name": "compile", "started_at": "2024-10-25T08:20:39.395801Z"}, {"completed_at": "2024-10-25T08:20:40.539899Z", "name": "execute", "started_at": "2024-10-25T08:20:39.406566Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_075839_00485_u6rsp", "rows_affected": 1.0}, "execution_time": 0.98590827, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:40.559603Z", "name": "compile", "started_at": "2024-10-25T08:20:40.552318Z"}, {"completed_at": "2024-10-25T08:20:41.533058Z", "name": "execute", "started_at": "2024-10-25T08:20:40.559603Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_075840_00489_u6rsp", "rows_affected": 1.0}, "execution_time": 0.8527856, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:41.551834Z", "name": "compile", "started_at": "2024-10-25T08:20:41.542042Z"}, {"completed_at": "2024-10-25T08:20:42.394827Z", "name": "execute", "started_at": "2024-10-25T08:20:41.554438Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_075840_00493_u6rsp", "rows_affected": 6.0}, "execution_time": 0.82106614, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:42.411057Z", "name": "compile", "started_at": "2024-10-25T08:20:42.402291Z"}, {"completed_at": "2024-10-25T08:20:43.221330Z", "name": "execute", "started_at": "2024-10-25T08:20:42.411330Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_075841_00497_u6rsp", "rows_affected": 1.0}, "execution_time": 0.7971828, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:43.242214Z", "name": "compile", "started_at": "2024-10-25T08:20:43.230048Z"}, {"completed_at": "2024-10-25T08:20:44.020766Z", "name": "execute", "started_at": "2024-10-25T08:20:43.243973Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_075842_00501_u6rsp", "rows_affected": 1.0}, "execution_time": 0.7904358, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T08:20:44.050082Z", "name": "compile", "started_at": "2024-10-25T08:20:44.035213Z"}, {"completed_at": "2024-10-25T08:20:44.825649Z", "name": "execute", "started_at": "2024-10-25T08:20:44.050082Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.727138Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.979714Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.979714Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "", "name": "Formatting", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.979714Z"}}
{"data": {"stats": {"error": 0, "pass": 8, "skip": 0, "total": 8, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "info", "msg": "Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8", "name": "StatsLine", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.979714Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-10-25T08:20:48.979714Z", "elapsed": 16.670898, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Command `dbt build` succeeded at 16:20:48.979714 after 16.67 seconds", "name": "CommandCompleted", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.979714Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 49820, "thread": "MainThread", "ts": "2024-10-25T08:20:48.979714Z"}}
