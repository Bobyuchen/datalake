{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-10-25T08:20:48.727138Z", "invocation_id": "430e9c38-03cc-4972-8fa3-1cbb6e903e44", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:36.116987Z", "completed_at": "2024-10-25T08:20:36.126633Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:36.127274Z", "completed_at": "2024-10-25T08:20:37.943708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8307433128356934, "adapter_response": {"_message": "CREATE TABLE (3 rows)", "rows_affected": 3, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_075834_00473_u6rsp"}, "message": "CREATE TABLE (3 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_care_site", "compiled": true, "compiled_code": "--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:37.958160Z", "completed_at": "2024-10-25T08:20:37.967281Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:37.968371Z", "completed_at": "2024-10-25T08:20:39.380292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4268224239349365, "adapter_response": {"_message": "CREATE TABLE (5 rows)", "rows_affected": 5, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_075836_00477_u6rsp"}, "message": "CREATE TABLE (5 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_measurement", "compiled": true, "compiled_code": "\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:39.395801Z", "completed_at": "2024-10-25T08:20:39.403169Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:39.406566Z", "completed_at": "2024-10-25T08:20:40.539899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1505460739135742, "adapter_response": {"_message": "CREATE TABLE (5 rows)", "rows_affected": 5, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_075837_00481_u6rsp"}, "message": "CREATE TABLE (5 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_observation", "compiled": true, "compiled_code": "--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:40.552318Z", "completed_at": "2024-10-25T08:20:40.559603Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:40.559603Z", "completed_at": "2024-10-25T08:20:41.533058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9859082698822021, "adapter_response": {"_message": "CREATE TABLE (1 rows)", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_075839_00485_u6rsp"}, "message": "CREATE TABLE (1 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_person", "compiled": true, "compiled_code": "\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"", "relation_name": "\"iceberg\".\"omop\".\"omop_person\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:41.542042Z", "completed_at": "2024-10-25T08:20:41.551834Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:41.554438Z", "completed_at": "2024-10-25T08:20:42.394827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.852785587310791, "adapter_response": {"_message": "CREATE TABLE (1 rows)", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_075840_00489_u6rsp"}, "message": "CREATE TABLE (1 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence", "compiled": true, "compiled_code": "\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:42.402291Z", "completed_at": "2024-10-25T08:20:42.411057Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:42.411330Z", "completed_at": "2024-10-25T08:20:43.221330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.82106614112854, "adapter_response": {"_message": "CREATE TABLE (6 rows)", "rows_affected": 6, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_075840_00493_u6rsp"}, "message": "CREATE TABLE (6 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_provider", "compiled": true, "compiled_code": "\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:43.230048Z", "completed_at": "2024-10-25T08:20:43.242214Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:43.243973Z", "completed_at": "2024-10-25T08:20:44.020766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7971827983856201, "adapter_response": {"_message": "CREATE TABLE (1 rows)", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_075841_00497_u6rsp"}, "message": "CREATE TABLE (1 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_specimen", "compiled": true, "compiled_code": "\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T08:20:44.035213Z", "completed_at": "2024-10-25T08:20:44.050082Z"}, {"name": "execute", "started_at": "2024-10-25T08:20:44.050082Z", "completed_at": "2024-10-25T08:20:44.825649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.790435791015625, "adapter_response": {"_message": "CREATE TABLE (1 rows)", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_075842_00501_u6rsp"}, "message": "CREATE TABLE (1 rows)", "failures": null, "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence", "compiled": true, "compiled_code": "\n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\""}], "elapsed_time": 14.715412855148315, "args": {"log_level": "info", "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "use_colors": true, "version_check": true, "macro_debugging": false, "resource_types": [], "use_colors_file": true, "introspect": true, "populate_cache": true, "require_resource_names_without_spaces": false, "project_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop", "target_path": "target\\my_dbt_trino_project_dbt_assets-c6dd672-4e3b951", "partial_parse": true, "show_resource_report": false, "export_saved_queries": false, "exclude_resource_types": [], "vars": {}, "log_format_file": "json", "print": true, "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop", "invocation_command": "dbt build --select my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_specimen my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_procedure_occurrence", "select": ["my_dbt_trino_project.staging.omop_care_site", "my_dbt_trino_project.staging.omop_measurement", "my_dbt_trino_project.staging.omop_observation", "my_dbt_trino_project.staging.omop_person", "my_dbt_trino_project.staging.omop_visit_occurrence", "my_dbt_trino_project.staging.omop_specimen", "my_dbt_trino_project.staging.omop_provider", "my_dbt_trino_project.staging.omop_procedure_occurrence"], "which": "build", "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "log_format": "json", "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true, "include_saved_query": false, "show": false, "strict_mode": false, "static_parser": true, "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop\\target\\my_dbt_trino_project_dbt_assets-c6dd672-4e3b951", "send_anonymous_usage_stats": false, "enable_legacy_logger": false, "write_json": true, "defer": false, "cache_selected_only": false, "partial_parse_file_diff": true, "log_level_file": "debug", "favor_state": false, "quiet": false, "empty": false}}