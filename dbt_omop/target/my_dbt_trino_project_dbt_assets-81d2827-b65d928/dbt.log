{"data": {"log_version": 3, "version": "=1.8.8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Running with dbt=1.8.8", "name": "MainReportVersion", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:33.893524Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_specimen", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop\\target\\my_dbt_trino_project_dbt_assets-81d2827-b65d928", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\my_dbt_trino_project_dbt_assets-81d2827-b65d928", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop', 'log_path': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop\\\\target\\\\my_dbt_trino_project_dbt_assets-81d2827-b65d928', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'introspect': 'True', 'invocation_command': 'dbt build --select my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_specimen', 'static_parser': 'True', 'target_path': 'target\\\\my_dbt_trino_project_dbt_assets-81d2827-b65d928', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:33.899604Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Registered adapter: trino=1.8.2", "name": "AdapterRegistered", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:34.537655Z"}}
{"data": {"checksum": "ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5", "profile": "", "target": "", "vars": "{}", "version": "1.8.8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8", "name": "StateCheckVarsHash", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:34.583897Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:35.028166Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:35.029175Z"}}
{"data": {"unused_config_paths": ["models.my_dbt_trino_project.stage", "models.my_dbt_trino_project.source"]}, "info": {"category": "", "code": "I051", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 2 unused configuration paths:\n- models.my_dbt_trino_project.stage\n- models.my_dbt_trino_project.source", "name": "UnusedResourceConfigPath", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:35.041845Z"}}
{"data": {"stat_line": "86 models, 2 operations, 15 sources, 1337 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Found 86 models, 2 operations, 15 sources, 1337 macros", "name": "FoundStats", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:35.420187Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:35.440569Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:35.442089Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 5212, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T07:20:35.454126Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 5212, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T07:20:35.664936Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 5212, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T07:20:35.664936Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 5212, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T07:20:35.666242Z"}}
{"data": {"elapsed": 0.3670671, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: SUCCESS in 0.367 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T07:20:36.033608Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T07:20:36.037166Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_omop'", "name": "NewConnection", "pid": 5212, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T07:20:36.049110Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"list_iceberg_omop\"", "name": "ConnectionUsed", "pid": 5212, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T07:20:36.079735Z"}}
{"data": {"conn_name": "list_iceberg_omop", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On list_iceberg_omop: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'", "name": "SQLQuery", "pid": 5212, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T07:20:36.081254Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 5212, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T07:20:36.083274Z"}}
{"data": {"elapsed": 1.0312386, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: SUCCESS in 1.031 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T07:20:37.113889Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On list_iceberg_omop: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T07:20:37.119573Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On list_iceberg_omop: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T07:20:37.120617Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.144183Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.144183Z"}}
{"data": {"hook_type": "on-run-start", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Running 1 on-run-start hook", "name": "HooksRunning", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.146234Z"}}
{"data": {"msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "name": "JinjaLogInfo", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.216095Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.258932Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'", "name": "SQLQuery", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.260117Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.261203Z"}}
{"data": {"elapsed": 0.2095039, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: SUCCESS in 0.210 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.470834Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-start-0\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.478932Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]", "name": "LogHookStartLine", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.490486Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T07:20:37.491998", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.147256", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-start.0 ...................................... [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.491998Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.494026Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.495594Z"}}
{"data": {"node_count": 8, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.496613Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:37.497644Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_care_site", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.502743Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "1 of 8 START sql table model omop.omop_care_site ............................... [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.505282Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Acquiring new trino connection 'model.my_dbt_trino_project.omop_care_site'", "name": "NewConnection", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.506320Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_care_site", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.507340Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.518530Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_care_site", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.522061Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.635437Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.643277Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.645431Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:37.646997Z"}}
{"data": {"elapsed": 1.2955312, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (3 rows) in 1.296 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:38.942085Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:38.962337Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:38.963853Z"}}
{"data": {"elapsed": 0.1105108, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.111 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.076462Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.085321Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.086336Z"}}
{"data": {"elapsed": 0.0964791, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.096 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.184556Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.201233Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.206990Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.208522Z"}}
{"data": {"elapsed": 0.1911007, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.191 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.401307Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.437184Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.438187Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "execution_time": 1.9333806, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:39.439700", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "1 of 8 OK created sql table model omop.omop_care_site .......................... [\u001b[32mCREATE TABLE (3 rows)\u001b[0m in 1.93s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.443065Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:39.439700", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:37.502743", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_065836_00353_u6rsp", "rows_affected": 3.0}, "execution_time": 1.9333806, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:37.522061Z", "name": "compile", "started_at": "2024-10-25T07:20:37.508852Z"}, {"completed_at": "2024-10-25T07:20:39.437184Z", "name": "execute", "started_at": "2024-10-25T07:20:37.523062Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_care_site", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.446065Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_measurement", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.447066Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "2 of 8 START sql table model omop.omop_measurement ............................. [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.450094Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "orig_conn_name": "model.my_dbt_trino_project.omop_care_site"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_care_site, now model.my_dbt_trino_project.omop_measurement)", "name": "ConnectionReused", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.451162Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_measurement", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.453175Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.461215Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_measurement", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.462216Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.478527Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.485612Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.487774Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:39.488802Z"}}
{"data": {"elapsed": 0.94289, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.943 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.432583Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.439484Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.441159Z"}}
{"data": {"elapsed": 0.0913044, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.091 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.534242Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.540433Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.541428Z"}}
{"data": {"elapsed": 0.09812, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.098 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.639981Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.646980Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.649116Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.650113Z"}}
{"data": {"elapsed": 0.1447232, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.145 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.795346Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.800368Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.802368Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "execution_time": 1.3522038, "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:40.803366", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "2 of 8 OK created sql table model omop.omop_measurement ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.35s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.804368Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:40.803366", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:39.447066", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_065837_00357_u6rsp", "rows_affected": 5.0}, "execution_time": 1.3522038, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:39.462216Z", "name": "compile", "started_at": "2024-10-25T07:20:39.453175Z"}, {"completed_at": "2024-10-25T07:20:40.800368Z", "name": "execute", "started_at": "2024-10-25T07:20:39.464859Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_measurement", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.806369Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_observation", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.808420Z"}}
{"data": {"description": "sql table model omop.omop_observation", "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "3 of 8 START sql table model omop.omop_observation ............................. [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.809421Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "orig_conn_name": "model.my_dbt_trino_project.omop_measurement"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_measurement, now model.my_dbt_trino_project.omop_observation)", "name": "ConnectionReused", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.810928Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_observation", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.811937Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_observation\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.820860Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_observation", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.824026Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.833799Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.840314Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.842657Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:40.843652Z"}}
{"data": {"elapsed": 0.7584827, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.758 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.602784Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.614738Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.616287Z"}}
{"data": {"elapsed": 0.142756, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.143 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.760798Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.770704Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.772450Z"}}
{"data": {"elapsed": 0.1182344, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.118 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.892128Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.902622Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.904971Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:41.905990Z"}}
{"data": {"elapsed": 0.1519765, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.152 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.059348Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.062720Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.064005Z"}}
{"data": {"description": "sql table model omop.omop_observation", "execution_time": 1.254086, "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:42.066017", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "3 of 8 OK created sql table model omop.omop_observation ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.25s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.066017Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:42.066017", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:40.808420", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_065839_00361_u6rsp", "rows_affected": 5.0}, "execution_time": 1.254086, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:40.823027Z", "name": "compile", "started_at": "2024-10-25T07:20:40.812936Z"}, {"completed_at": "2024-10-25T07:20:42.062720Z", "name": "execute", "started_at": "2024-10-25T07:20:40.824026Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_observation", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.068452Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_person", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.068962Z"}}
{"data": {"description": "sql table model omop.omop_person", "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "4 of 8 START sql table model omop.omop_person .................................. [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.070973Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "orig_conn_name": "model.my_dbt_trino_project.omop_observation"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_observation, now model.my_dbt_trino_project.omop_person)", "name": "ConnectionReused", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.070973Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_person", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.072363Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_person\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.082354Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_person", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.084354Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.109189Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.120730Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.122731Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.124733Z"}}
{"data": {"elapsed": 0.8290745, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.829 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.953767Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.963353Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:42.963863Z"}}
{"data": {"elapsed": 0.0864783, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.086 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.052655Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.061275Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.062787Z"}}
{"data": {"elapsed": 0.0885213, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.089 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.153420Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.160045Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.163045Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.164115Z"}}
{"data": {"elapsed": 0.1515398, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.152 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.316925Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.319433Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.320941Z"}}
{"data": {"description": "sql table model omop.omop_person", "execution_time": 1.2509811, "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:43.321954", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "4 of 8 OK created sql table model omop.omop_person ............................. [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.25s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.321954Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:43.321954", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:42.068962", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_065840_00365_u6rsp", "rows_affected": 1.0}, "execution_time": 1.2509811, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:42.084354Z", "name": "compile", "started_at": "2024-10-25T07:20:42.073693Z"}, {"completed_at": "2024-10-25T07:20:43.319433Z", "name": "execute", "started_at": "2024-10-25T07:20:42.085867Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_person", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.323954Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.325954Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "5 of 8 START sql table model omop.omop_procedure_occurrence .................... [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.326955Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_person"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_person, now model.my_dbt_trino_project.omop_procedure_occurrence)", "name": "ConnectionReused", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.327466Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.328479Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.338008Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.339633Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.354382Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.358260Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.359605Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.361625Z"}}
{"data": {"elapsed": 0.508871, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.509 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.870325Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.878379Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.879375Z"}}
{"data": {"elapsed": 0.0853745, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.085 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.966165Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.974229Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:43.975594Z"}}
{"data": {"elapsed": 0.0835992, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.084 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.060137Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.066669Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.068328Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.070200Z"}}
{"data": {"elapsed": 0.1477978, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.148 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.219011Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.224533Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.226538Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "execution_time": 0.90108013, "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:44.228620", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "5 of 8 OK created sql table model omop.omop_procedure_occurrence ............... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.90s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.228620Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:44.228620", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:43.324955", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_065841_00369_u6rsp", "rows_affected": 1.0}, "execution_time": 0.90108013, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:43.339633Z", "name": "compile", "started_at": "2024-10-25T07:20:43.329481Z"}, {"completed_at": "2024-10-25T07:20:44.224533Z", "name": "execute", "started_at": "2024-10-25T07:20:43.340543Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.231747Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_provider", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.233747Z"}}
{"data": {"description": "sql table model omop.omop_provider", "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "6 of 8 START sql table model omop.omop_provider ................................ [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.235283Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "orig_conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_procedure_occurrence, now model.my_dbt_trino_project.omop_provider)", "name": "ConnectionReused", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.237026Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_provider", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.239039Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_provider\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.249682Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_provider", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.252681Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.273963Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.283555Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.284569Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:44.287130Z"}}
{"data": {"elapsed": 0.9029864, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (6 rows) in 0.903 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.190738Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.200594Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.202164Z"}}
{"data": {"elapsed": 0.0991175, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.099 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.303129Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.313246Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.315268Z"}}
{"data": {"elapsed": 0.089423, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.089 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.405883Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.413935Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.415946Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.417455Z"}}
{"data": {"elapsed": 0.1325105, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.133 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.551802Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.557709Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.558283Z"}}
{"data": {"description": "sql table model omop.omop_provider", "execution_time": 1.3240142, "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:45.560294", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "6 of 8 OK created sql table model omop.omop_provider ........................... [\u001b[32mCREATE TABLE (6 rows)\u001b[0m in 1.32s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.562221Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:45.560294", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:44.233747", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_065842_00373_u6rsp", "rows_affected": 6.0}, "execution_time": 1.3240142, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:44.252681Z", "name": "compile", "started_at": "2024-10-25T07:20:44.240037Z"}, {"completed_at": "2024-10-25T07:20:45.557196Z", "name": "execute", "started_at": "2024-10-25T07:20:44.257718Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_provider", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.563218Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_specimen", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.565220Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "7 of 8 START sql table model omop.omop_specimen ................................ [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.567220Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "orig_conn_name": "model.my_dbt_trino_project.omop_provider"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_provider, now model.my_dbt_trino_project.omop_specimen)", "name": "ConnectionReused", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.568218Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_specimen", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.569729Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.582310Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_specimen", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.585310Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.595901Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.601578Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.603568Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:45.604570Z"}}
{"data": {"elapsed": 0.622637, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.623 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.227684Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.236347Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.237875Z"}}
{"data": {"elapsed": 0.1045226, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.105 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.343853Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.353008Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.354521Z"}}
{"data": {"elapsed": 0.082921, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.083 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.439506Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.448081Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.450088Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.451694Z"}}
{"data": {"elapsed": 0.1461019, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.146 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.599604Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.604663Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.605177Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "execution_time": 1.0384903, "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:46.606708", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "7 of 8 OK created sql table model omop.omop_specimen ........................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.04s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.606803Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:46.606708", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:45.565220", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_065844_00377_u6rsp", "rows_affected": 1.0}, "execution_time": 1.0384903, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:45.585310Z", "name": "compile", "started_at": "2024-10-25T07:20:45.570746Z"}, {"completed_at": "2024-10-25T07:20:46.603660Z", "name": "execute", "started_at": "2024-10-25T07:20:45.586306Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_specimen", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.607722Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeStart", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.609237Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "8 of 8 START sql table model omop.omop_visit_occurrence ........................ [RUN]", "name": "LogStartLine", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.610763Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_specimen"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_specimen, now model.my_dbt_trino_project.omop_visit_occurrence)", "name": "ConnectionReused", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.611777Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeCompiling", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.613287Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.624409Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeExecuting", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.628002Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.641074Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.646180Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.647193Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:46.648705Z"}}
{"data": {"elapsed": 0.6352263, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.635 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.284422Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.295345Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.296980Z"}}
{"data": {"elapsed": 0.097614, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.098 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.395327Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.403363Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.404367Z"}}
{"data": {"elapsed": 0.0967895, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.097 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.502811Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.510715Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.513235Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.514746Z"}}
{"data": {"elapsed": 0.1557394, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: DROP TABLE in 0.156 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.671510Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: ROLLBACK", "name": "Rollback", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.675635Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.676671Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "execution_time": 1.0670595, "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:47.678836", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "8 of 8 OK created sql table model omop.omop_visit_occurrence ................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.07s]", "name": "LogModelResult", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.679991Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T07:20:47.678836", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:46.609237", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_065845_00381_u6rsp", "rows_affected": 1.0}, "execution_time": 1.0670595, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:46.628002Z", "name": "compile", "started_at": "2024-10-25T07:20:46.614299Z"}, {"completed_at": "2024-10-25T07:20:47.675635Z", "name": "execute", "started_at": "2024-10-25T07:20:46.628998Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeFinished", "pid": 5212, "thread": "Thread-1 (worker)", "ts": "2024-10-25T07:20:47.681001Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:47.685523Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:47.686528Z"}}
{"data": {"hook_type": "on-run-end", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Running 1 on-run-end hook", "name": "HooksRunning", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:47.687525Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:47.784501Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash", "name": "SQLQuery", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:47.785802Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:47.787127Z"}}
{"data": {"elapsed": 0.6481403, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: SUCCESS in 0.648 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.435777Z"}}
{"data": {"msg": "Elementary: Uploading dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Uploading dbt artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.457607Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_models] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.527773Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.693911Z"}}
{"data": {"msg": "Elementary: [dbt_models] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_models] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.707109Z"}}
{"data": {"msg": "Elementary: [dbt_models] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_models] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.709779Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.712304Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.163576 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.163576 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.713314Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.186043 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.186043 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.716052Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_tests] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.724642Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.727651Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.732532Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_tests] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.734636Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.738635Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.001001 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.001001 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.740636Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.012994 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.012994 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.743563Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_sources] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.755853Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.806604Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.811694Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_sources] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.813712Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.816723Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.048498 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.048498 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.819723Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.061469 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.061469 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.821725Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.831759Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.834775Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.837776Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.839772Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.842269Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.001001 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.001001 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.844284Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.010006 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.010006 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.847806Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.858355Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.862526Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.866054Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_metrics] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.868574Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.872267Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.001009 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.001009 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.875270Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.013464 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.013464 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.877780Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.889752Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.894003Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.898388Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_exposures] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.900408Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.904109Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.001000 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.001000 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.906231Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.013257 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.013257 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.907907Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.916701Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.920502Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.923629Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_seeds] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.925785Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.928943Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.000560 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.000560 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.931092Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.011714 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.011714 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.933326Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_columns] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:48.941407Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.857324Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.860322Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_columns] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.864318Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.867317Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.912723 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.912723 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.870318Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.926459 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.926459 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.872318Z"}}
{"data": {"msg": "Elementary: Uploaded dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Uploaded dbt artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.874323Z"}}
{"data": {"msg": "Elementary: Uploading run results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Uploading run results.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.883914Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.885915Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:49.944869Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:50.000052Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "SQLQuery", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:50.001047Z"}}
{"data": {"elapsed": 0.1792523, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: SUCCESS in 0.179 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:50.181908Z"}}
{"data": {"msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:50.188495Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:50.414219Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:50.426203Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',1.9333806037902832,'2024-10-25T07:20:37.523062Z','2024-10-25T07:20:39.437184Z','2024-10-25T07:20:37.508852Z','2024-10-25T07:20:37.522061Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_065836_00353_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_065836_00353_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.3522038459777832,'2024-10-25T07:20:39.464859Z','2024-10-25T07:20:40.800368Z','2024-10-25T07:20:39.453175Z','2024-10-25T07:20:39.462216Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_065837_00357_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_065837_00357_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.2540860176086426,'2024-10-25T07:20:40.824026Z','2024-10-25T07:20:42.062720Z','2024-10-25T07:20:40.812936Z','2024-10-25T07:20:40.823027Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_065839_00361_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_065839_00361_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',1.250981092453003,'2024-10-25T07:20:42.085867Z','2024-10-25T07:20:43.319433Z','2024-10-25T07:20:42.073693Z','2024-10-25T07:20:42.084354Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_065840_00365_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_065840_00365_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',0.9010801315307617,'2024-10-25T07:20:43.340543Z','2024-10-25T07:20:44.224533Z','2024-10-25T07:20:43.329481Z','2024-10-25T07:20:43.339633Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_065841_00369_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_065841_00369_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',1.3240141868591309,'2024-10-25T07:20:44.257718Z','2024-10-25T07:20:45.557196Z','2024-10-25T07:20:44.240037Z','2024-10-25T07:20:44.252681Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_065842_00373_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_065842_00373_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',1.0384902954101562,'2024-10-25T07:20:45.586306Z','2024-10-25T07:20:46.603660Z','2024-10-25T07:20:45.570746Z','2024-10-25T07:20:45.585310Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_065844_00377_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_065844_00377_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',1.0670595169067383,'2024-10-25T07:20:46.628998Z','2024-10-25T07:20:47.675635Z','2024-10-25T07:20:46.614299Z','2024-10-25T07:20:46.628002Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_065845_00381_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_065845_00381_u6rsp\"}')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',1.9333806037902832,'2024-10-25T07:20:37.523062Z','2024-10-25T07:20:39.437184Z','2024-10-25T07:20:37.508852Z','2024-10-25T07:20:37.522061Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_065836_00353_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_065836_00353_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.3522038459777832,'2024-10-25T07:20:39.464859Z','2024-10-25T07:20:40.800368Z','2024-10-25T07:20:39.453175Z','2024-10-25T07:20:39.462216Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_065837_00357_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_065837_00357_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.2540860176086426,'2024-10-25T07:20:40.824026Z','2024-10-25T07:20:42.062720Z','2024-10-25T07:20:40.812936Z','2024-10-25T07:20:40.823027Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_065839_00361_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_065839_00361_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',1.250981092453003,'2024-10-25T07:20:42.085867Z','2024-10-25T07:20:43.319433Z','2024-10-25T07:20:42.073693Z','2024-10-25T07:20:42.084354Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_065840_00365_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_065840_00365_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',0.9010801315307617,'2024-10-25T07:20:43.340543Z','2024-10-25T07:20:44.224533Z','2024-10-25T07:20:43.329481Z','2024-10-25T07:20:43.339633Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_065841_00369_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_065841_00369_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',1.3240141868591309,'2024-10-25T07:20:44.257718Z','2024-10-25T07:20:45.557196Z','2024-10-25T07:20:44.240037Z','2024-10-25T07:20:44.252681Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_065842_00373_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_065842_00373_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',1.0384902954101562,'2024-10-25T07:20:45.586306Z','2024-10-25T07:20:46.603660Z','2024-10-25T07:20:45.570746Z','2024-10-25T07:20:45.585310Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_065844_00377_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_065844_00377_u6rsp\"}'),('9706d9b0-4eb1-4456-8c47-8a5ac700adc5.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','9706d9b0-4eb1-4456-8c47-8a5ac700adc5','2024-10-25 07:20:49',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',1.0670595169067383,'2024-10-25T07:20:46.628998Z','2024-10-25T07:20:47.675635Z','2024-10-25T07:20:46.614299Z','2024-10-25T07:20:46.628002Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_065845_00381_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_065845_00381_u6rsp\"}')", "name": "SQLQuery", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:50.428202Z"}}
{"data": {"elapsed": 0.5964054, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (8 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: INSERT (8 rows) in 0.596 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.027658Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.036687Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.055959 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.055959 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.038688Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.206144 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.206144 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.041926Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.044437Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.188892 (8 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.188892 (8 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.046973Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.202502 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.202502 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.048978Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.615970 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.615970 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.051976Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:01.051853 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:01.051853 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.054503Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.149658 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.149658 (1 runs)", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.055499Z"}}
{"data": {"msg": "Elementary: Uploaded run results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Uploaded run results successfully.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.058642Z"}}
{"data": {"msg": "Elementary: Handling test results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Handling test results.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.076113Z"}}
{"data": {"msg": "Elementary: Handled test results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Handled test results successfully.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.113621Z"}}
{"data": {"msg": "Elementary: Uploading dbt invocation.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Uploading dbt invocation.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.145653Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.280178Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "SQLQuery", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.282177Z"}}
{"data": {"elapsed": 0.203329, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: SUCCESS in 0.203 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.486947Z"}}
{"data": {"msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.492018Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.538332Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.544992Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('9706d9b0-4eb1-4456-8c47-8a5ac700adc5',NULL,NULL,NULL,'2024-10-25 07:20:33','2024-10-25 07:20:51','2024-10-25 07:20:51',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_specimen\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('9706d9b0-4eb1-4456-8c47-8a5ac700adc5',NULL,NULL,NULL,'2024-10-25 07:20:33','2024-10-25 07:20:51','2024-10-25 07:20:51',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_specimen\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')", "name": "SQLQuery", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:51.546654Z"}}
{"data": {"elapsed": 0.658482, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "SQL status: INSERT (1 rows) in 0.658 seconds", "name": "SQLQueryStatus", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.205735Z"}}
{"data": {"msg": "Elementary: Uploaded dbt invocation successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Elementary: Uploaded dbt invocation successfully.", "name": "JinjaLogDebug", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.211269Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-end-0\"", "name": "WritingInjectedSQLForNode", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.221310Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]", "name": "LogHookStartLine", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.223834Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T07:20:52.224340", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T07:20:47.688525", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-end.0 ........................................ [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.224340Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.225679Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.227096Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.227096Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Connection 'list_iceberg' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.228549Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Connection 'list_iceberg_omop' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.229607Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Connection 'model.my_dbt_trino_project.omop_visit_occurrence' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.230617Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.231619Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 16.79 seconds", "execution_time": 16.78953, "stat_line": "8 table models, 2 project hooks"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Finished running 8 table models, 2 project hooks in 0 hours 0 minutes and 16.79 seconds (16.79s).", "name": "FinishedRunningStats", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.232618Z"}}
{"data": {"elapsed_time": 16.78953, "generated_at": "2024-10-25T07:20:52Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_065836_00353_u6rsp", "rows_affected": 3.0}, "execution_time": 1.9333806, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:37.522061Z", "name": "compile", "started_at": "2024-10-25T07:20:37.508852Z"}, {"completed_at": "2024-10-25T07:20:39.437184Z", "name": "execute", "started_at": "2024-10-25T07:20:37.523062Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_065837_00357_u6rsp", "rows_affected": 5.0}, "execution_time": 1.3522038, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:39.462216Z", "name": "compile", "started_at": "2024-10-25T07:20:39.453175Z"}, {"completed_at": "2024-10-25T07:20:40.800368Z", "name": "execute", "started_at": "2024-10-25T07:20:39.464859Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_065839_00361_u6rsp", "rows_affected": 5.0}, "execution_time": 1.254086, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:40.823027Z", "name": "compile", "started_at": "2024-10-25T07:20:40.812936Z"}, {"completed_at": "2024-10-25T07:20:42.062720Z", "name": "execute", "started_at": "2024-10-25T07:20:40.824026Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_065840_00365_u6rsp", "rows_affected": 1.0}, "execution_time": 1.2509811, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:42.084354Z", "name": "compile", "started_at": "2024-10-25T07:20:42.073693Z"}, {"completed_at": "2024-10-25T07:20:43.319433Z", "name": "execute", "started_at": "2024-10-25T07:20:42.085867Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_065841_00369_u6rsp", "rows_affected": 1.0}, "execution_time": 0.90108013, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:43.339633Z", "name": "compile", "started_at": "2024-10-25T07:20:43.329481Z"}, {"completed_at": "2024-10-25T07:20:44.224533Z", "name": "execute", "started_at": "2024-10-25T07:20:43.340543Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_065842_00373_u6rsp", "rows_affected": 6.0}, "execution_time": 1.3240142, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:44.252681Z", "name": "compile", "started_at": "2024-10-25T07:20:44.240037Z"}, {"completed_at": "2024-10-25T07:20:45.557196Z", "name": "execute", "started_at": "2024-10-25T07:20:44.257718Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_065844_00377_u6rsp", "rows_affected": 1.0}, "execution_time": 1.0384903, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:45.585310Z", "name": "compile", "started_at": "2024-10-25T07:20:45.570746Z"}, {"completed_at": "2024-10-25T07:20:46.603660Z", "name": "execute", "started_at": "2024-10-25T07:20:45.586306Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_065845_00381_u6rsp", "rows_affected": 1.0}, "execution_time": 1.0670595, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T07:20:46.628002Z", "name": "compile", "started_at": "2024-10-25T07:20:46.614299Z"}, {"completed_at": "2024-10-25T07:20:47.675635Z", "name": "execute", "started_at": "2024-10-25T07:20:46.628998Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.236972Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.543615Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.544633Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "", "name": "Formatting", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.545634Z"}}
{"data": {"stats": {"error": 0, "pass": 8, "skip": 0, "total": 8, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "info", "msg": "Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8", "name": "StatsLine", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.546627Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-10-25T07:20:52.547630Z", "elapsed": 18.881897, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Command `dbt build` succeeded at 15:20:52.547630 after 18.88 seconds", "name": "CommandCompleted", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.547630Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "9706d9b0-4eb1-4456-8c47-8a5ac700adc5", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 5212, "thread": "MainThread", "ts": "2024-10-25T07:20:52.548633Z"}}
