{"data": {"log_version": 3, "version": "=1.8.8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Running with dbt=1.8.8", "name": "MainReportVersion", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:07.577447Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_specimen my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_provider", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop\\target\\my_dbt_trino_project_dbt_assets-ae51918-522b876", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\my_dbt_trino_project_dbt_assets-ae51918-522b876", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop\\\\target\\\\my_dbt_trino_project_dbt_assets-ae51918-522b876', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_specimen my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_provider', 'log_format': 'json', 'target_path': 'target\\\\my_dbt_trino_project_dbt_assets-ae51918-522b876', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:07.584515Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Registered adapter: trino=1.8.2", "name": "AdapterRegistered", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:08.269722Z"}}
{"data": {"checksum": "ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5", "profile": "", "target": "", "vars": "{}", "version": "1.8.8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8", "name": "StateCheckVarsHash", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:08.315893Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:08.858020Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:08.859285Z"}}
{"data": {"unused_config_paths": ["models.my_dbt_trino_project.stage", "models.my_dbt_trino_project.source"]}, "info": {"category": "", "code": "I051", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 2 unused configuration paths:\n- models.my_dbt_trino_project.stage\n- models.my_dbt_trino_project.source", "name": "UnusedResourceConfigPath", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:08.873429Z"}}
{"data": {"stat_line": "86 models, 2 operations, 15 sources, 1337 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Found 86 models, 2 operations, 15 sources, 1337 macros", "name": "FoundStats", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:09.324978Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:09.340905Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:09.341905Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 33132, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-30T02:09:09.350575Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 33132, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-30T02:09:09.562862Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 33132, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-30T02:09:09.564871Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 33132, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-30T02:09:09.565888Z"}}
{"data": {"elapsed": 0.0952545, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: SUCCESS in 0.095 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-30T02:09:09.661341Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-30T02:09:09.664354Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_omop'", "name": "NewConnection", "pid": 33132, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-30T02:09:09.679375Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"list_iceberg_omop\"", "name": "ConnectionUsed", "pid": 33132, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-30T02:09:09.715926Z"}}
{"data": {"conn_name": "list_iceberg_omop", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On list_iceberg_omop: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'", "name": "SQLQuery", "pid": 33132, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-30T02:09:09.717288Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 33132, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-30T02:09:09.718297Z"}}
{"data": {"elapsed": 0.3156802, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: SUCCESS in 0.316 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-30T02:09:10.034238Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On list_iceberg_omop: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-30T02:09:10.040148Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On list_iceberg_omop: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-30T02:09:10.041910Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.060700Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.061232Z"}}
{"data": {"hook_type": "on-run-start", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Running 1 on-run-start hook", "name": "HooksRunning", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.062330Z"}}
{"data": {"msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "name": "JinjaLogInfo", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.131919Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.182759Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'", "name": "SQLQuery", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.183773Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.185799Z"}}
{"data": {"elapsed": 0.1375377, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: SUCCESS in 0.138 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.323644Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-start-0\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.329698Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]", "name": "LogHookStartLine", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.340865Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-30T02:09:10.340865", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.063395", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-start.0 ...................................... [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.340865Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.342361Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.344601Z"}}
{"data": {"node_count": 8, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.346203Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:10.347599Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_care_site", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.353221Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "1 of 8 START sql table model omop.omop_care_site ............................... [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.355301Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Acquiring new trino connection 'model.my_dbt_trino_project.omop_care_site'", "name": "NewConnection", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.356611Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_care_site", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.358069Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.365201Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_care_site", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.367962Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.480752Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.490830Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.492348Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:10.494425Z"}}
{"data": {"elapsed": 5.1059074, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (3 rows) in 5.106 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.599418Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.616567Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.617662Z"}}
{"data": {"elapsed": 0.1270191, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.127 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.746509Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.753650Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.755647Z"}}
{"data": {"elapsed": 0.0591864, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.059 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.816168Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.832800Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.838845Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:15.840848Z"}}
{"data": {"elapsed": 0.6495243, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.650 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.491592Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.527860Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.528859Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "execution_time": 6.1732473, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:16.529859", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "1 of 8 OK created sql table model omop.omop_care_site .......................... [\u001b[32mCREATE TABLE (3 rows)\u001b[0m in 6.17s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.532856Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:16.529859", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:10.353221", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241030_020910_00035_7sfqi", "rows_affected": 3.0}, "execution_time": 6.1732473, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:10.367962Z", "name": "compile", "started_at": "2024-10-30T02:09:10.359078Z"}, {"completed_at": "2024-10-30T02:09:16.527860Z", "name": "execute", "started_at": "2024-10-30T02:09:10.370197Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_care_site", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.534858Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_measurement", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.535364Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "2 of 8 START sql table model omop.omop_measurement ............................. [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.537374Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "orig_conn_name": "model.my_dbt_trino_project.omop_care_site"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_care_site, now model.my_dbt_trino_project.omop_measurement)", "name": "ConnectionReused", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.538376Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_measurement", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.539377Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.548446Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_measurement", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.550557Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.561091Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.565340Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.566867Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:16.568359Z"}}
{"data": {"elapsed": 0.8811781, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.881 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.450160Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.461421Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.463462Z"}}
{"data": {"elapsed": 0.1305838, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.131 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.595121Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.606271Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.607809Z"}}
{"data": {"elapsed": 0.0610216, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.061 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.669330Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.678578Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.680692Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.681692Z"}}
{"data": {"elapsed": 0.2083806, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.208 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.891780Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.895301Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.896311Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "execution_time": 1.3579347, "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:17.896311", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "2 of 8 OK created sql table model omop.omop_measurement ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.36s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.897717Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:17.896311", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:16.535364", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241030_020916_00041_7sfqi", "rows_affected": 5.0}, "execution_time": 1.3579347, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:16.550557Z", "name": "compile", "started_at": "2024-10-30T02:09:16.540890Z"}, {"completed_at": "2024-10-30T02:09:17.895301Z", "name": "execute", "started_at": "2024-10-30T02:09:16.551569Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_measurement", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.899163Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_observation", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.900381Z"}}
{"data": {"description": "sql table model omop.omop_observation", "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "3 of 8 START sql table model omop.omop_observation ............................. [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.901897Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "orig_conn_name": "model.my_dbt_trino_project.omop_measurement"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_measurement, now model.my_dbt_trino_project.omop_observation)", "name": "ConnectionReused", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.901897Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_observation", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.902909Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_observation\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.912759Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_observation", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.915757Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.926342Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.933234Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.935235Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:17.936238Z"}}
{"data": {"elapsed": 0.7828826, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.783 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.719571Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.729200Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.730712Z"}}
{"data": {"elapsed": 0.1238573, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.124 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.856059Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.866508Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.867914Z"}}
{"data": {"elapsed": 0.0848727, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.085 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.954624Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.962300Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.965849Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:18.966850Z"}}
{"data": {"elapsed": 0.2202515, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.220 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.189618Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.195233Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.197227Z"}}
{"data": {"description": "sql table model omop.omop_observation", "execution_time": 1.2963269, "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:19.198224", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "3 of 8 OK created sql table model omop.omop_observation ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.30s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.199229Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:19.198224", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:17.900381", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241030_020917_00046_7sfqi", "rows_affected": 5.0}, "execution_time": 1.2963269, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:17.914757Z", "name": "compile", "started_at": "2024-10-30T02:09:17.904134Z"}, {"completed_at": "2024-10-30T02:09:19.195233Z", "name": "execute", "started_at": "2024-10-30T02:09:17.915757Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_observation", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.201224Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_person", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.203271Z"}}
{"data": {"description": "sql table model omop.omop_person", "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "4 of 8 START sql table model omop.omop_person .................................. [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.205321Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "orig_conn_name": "model.my_dbt_trino_project.omop_observation"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_observation, now model.my_dbt_trino_project.omop_person)", "name": "ConnectionReused", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.206405Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_person", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.207960Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_person\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.218560Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_person", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.221144Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.235554Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.243722Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.245256Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:19.246326Z"}}
{"data": {"elapsed": 0.8429906, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.843 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.090330Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.097953Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.097953Z"}}
{"data": {"elapsed": 0.1143799, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.114 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.214624Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.224561Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.227069Z"}}
{"data": {"elapsed": 0.1360859, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.136 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.364710Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.375323Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.378377Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.379411Z"}}
{"data": {"elapsed": 0.2120438, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.212 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.593893Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.599516Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.600531Z"}}
{"data": {"description": "sql table model omop.omop_person", "execution_time": 1.3966403, "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:20.603045", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "4 of 8 OK created sql table model omop.omop_person ............................. [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.40s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.603581Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:20.603045", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:19.203271", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241030_020919_00051_7sfqi", "rows_affected": 1.0}, "execution_time": 1.3966403, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:19.221144Z", "name": "compile", "started_at": "2024-10-30T02:09:19.209492Z"}, {"completed_at": "2024-10-30T02:09:20.599516Z", "name": "execute", "started_at": "2024-10-30T02:09:19.222606Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_person", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.606109Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.608134Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "5 of 8 START sql table model omop.omop_procedure_occurrence .................... [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.609657Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_person"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_person, now model.my_dbt_trino_project.omop_procedure_occurrence)", "name": "ConnectionReused", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.611166Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.613179Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.623504Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.626532Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.645335Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.649916Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.650455Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:20.651977Z"}}
{"data": {"elapsed": 0.9298352, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.930 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.582943Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.592954Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.595286Z"}}
{"data": {"elapsed": 0.1124133, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.112 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.710012Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.717627Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.720159Z"}}
{"data": {"elapsed": 0.1029102, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.103 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.824100Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.830908Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.832376Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:21.834541Z"}}
{"data": {"elapsed": 0.1679687, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.168 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.003438Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.007453Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.009457Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "execution_time": 1.3982911, "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:22.009457", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "5 of 8 OK created sql table model omop.omop_procedure_occurrence ............... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.40s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.010974Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:22.009457", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:20.607124", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241030_020920_00057_7sfqi", "rows_affected": 1.0}, "execution_time": 1.3982911, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:20.625013Z", "name": "compile", "started_at": "2024-10-30T02:09:20.614183Z"}, {"completed_at": "2024-10-30T02:09:22.007453Z", "name": "execute", "started_at": "2024-10-30T02:09:20.630604Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.012994Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_provider", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.012994Z"}}
{"data": {"description": "sql table model omop.omop_provider", "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "6 of 8 START sql table model omop.omop_provider ................................ [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.014483Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "orig_conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_procedure_occurrence, now model.my_dbt_trino_project.omop_provider)", "name": "ConnectionReused", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.016087Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_provider", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.017098Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_provider\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.025229Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_provider", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.027310Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.041482Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.048387Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.049398Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.050396Z"}}
{"data": {"elapsed": 0.6494501, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (6 rows) in 0.649 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.700753Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.708273Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.709271Z"}}
{"data": {"elapsed": 0.1173681, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.117 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.827629Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.834752Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.835770Z"}}
{"data": {"elapsed": 0.0727734, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.073 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.909545Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.917527Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.919637Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:22.920669Z"}}
{"data": {"elapsed": 0.2068241, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.207 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.129822Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.134815Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.135831Z"}}
{"data": {"description": "sql table model omop.omop_provider", "execution_time": 1.1217387, "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:23.137826", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "6 of 8 OK created sql table model omop.omop_provider ........................... [\u001b[32mCREATE TABLE (6 rows)\u001b[0m in 1.12s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.138993Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:23.137826", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:22.012994", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241030_020922_00061_7sfqi", "rows_affected": 6.0}, "execution_time": 1.1217387, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:22.027310Z", "name": "compile", "started_at": "2024-10-30T02:09:22.018096Z"}, {"completed_at": "2024-10-30T02:09:23.134815Z", "name": "execute", "started_at": "2024-10-30T02:09:22.028779Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_provider", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.141009Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_specimen", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.143043Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "7 of 8 START sql table model omop.omop_specimen ................................ [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.144563Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "orig_conn_name": "model.my_dbt_trino_project.omop_provider"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_provider, now model.my_dbt_trino_project.omop_specimen)", "name": "ConnectionReused", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.146578Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_specimen", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.147574Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.159426Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_specimen", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.161347Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.171162Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.175940Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.178051Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.179064Z"}}
{"data": {"elapsed": 0.566306, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.566 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.745554Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.753791Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.755437Z"}}
{"data": {"elapsed": 0.0930585, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.093 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.849801Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.858217Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.859938Z"}}
{"data": {"elapsed": 0.10148, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.101 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.962832Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.972368Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.975181Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:23.976876Z"}}
{"data": {"elapsed": 0.1702802, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.170 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.148257Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.152196Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.153393Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "execution_time": 1.007911, "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:24.154489", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "7 of 8 OK created sql table model omop.omop_specimen ........................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.01s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.155502Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:24.154489", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:23.143043", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241030_020923_00065_7sfqi", "rows_affected": 1.0}, "execution_time": 1.007911, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:23.161347Z", "name": "compile", "started_at": "2024-10-30T02:09:23.148577Z"}, {"completed_at": "2024-10-30T02:09:24.152196Z", "name": "execute", "started_at": "2024-10-30T02:09:23.162846Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_specimen", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.157617Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeStart", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.159285Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "8 of 8 START sql table model omop.omop_visit_occurrence ........................ [RUN]", "name": "LogStartLine", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.160934Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_specimen"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_specimen, now model.my_dbt_trino_project.omop_visit_occurrence)", "name": "ConnectionReused", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.162561Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeCompiling", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.164238Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.177611Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeExecuting", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.179235Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.189823Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.193819Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.193819Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.196372Z"}}
{"data": {"elapsed": 0.5090062, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.509 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.705125Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.711034Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.712035Z"}}
{"data": {"elapsed": 0.1019167, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.102 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.815309Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.821392Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.821392Z"}}
{"data": {"elapsed": 0.1055497, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.106 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.928547Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.937587Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.940099Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:24.941109Z"}}
{"data": {"elapsed": 0.168641, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: DROP TABLE in 0.169 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:25.111334Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: ROLLBACK", "name": "Rollback", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:25.115332Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:25.116548Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "execution_time": 0.95523715, "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:25.117798", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "8 of 8 OK created sql table model omop.omop_visit_occurrence ................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.96s]", "name": "LogModelResult", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:25.117798Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-30T02:09:25.117798", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:24.159285", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241030_020924_00069_7sfqi", "rows_affected": 1.0}, "execution_time": 0.95523715, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:24.179235Z", "name": "compile", "started_at": "2024-10-30T02:09:24.165353Z"}, {"completed_at": "2024-10-30T02:09:25.115332Z", "name": "execute", "started_at": "2024-10-30T02:09:24.180313Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeFinished", "pid": 33132, "thread": "Thread-1 (worker)", "ts": "2024-10-30T02:09:25.120105Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.122710Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.123845Z"}}
{"data": {"hook_type": "on-run-end", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Running 1 on-run-end hook", "name": "HooksRunning", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.124863Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.200329Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash", "name": "SQLQuery", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.201328Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.202329Z"}}
{"data": {"elapsed": 0.5955262, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: SUCCESS in 0.596 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.797845Z"}}
{"data": {"msg": "Elementary: Uploading dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Uploading dbt artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.815594Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_models] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:25.860990Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.035809Z"}}
{"data": {"msg": "Elementary: [dbt_models] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_models] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.047807Z"}}
{"data": {"msg": "Elementary: [dbt_models] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_models] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.049919Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.052339Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.172304 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.172304 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.054353Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.191349 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.191349 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.056353Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_tests] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.065072Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.068107Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.071845Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_tests] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.078676Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.084934Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.000993 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.000993 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.089867Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.019130 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.019130 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.093333Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_sources] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.114330Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.157517Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.160054Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_sources] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.163074Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.165075Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.039385 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.039385 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.167068Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.051503 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.051503 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.168580Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.176592Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.179117Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.182118Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.184114Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.185115Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.001012 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.001012 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.187576Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.008523 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.008523 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.189579Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.197587Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.201260Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.204265Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_metrics] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.206684Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.210670Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.212175Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.012068 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.012068 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.214182Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.221454Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.224013Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.227142Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_exposures] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.228601Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.230720Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.001190 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.001190 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.233227Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.009266 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.009266 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.234678Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.245081Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.249298Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.253802Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_seeds] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.255804Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.257801Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.001001 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.001001 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.258926Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.011726 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.011726 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.261208Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_columns] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:26.269457Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.111941Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.115088Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_columns] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.119232Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.122229Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.840002 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.840002 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.124229Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.851768 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.851768 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.126223Z"}}
{"data": {"msg": "Elementary: Uploaded dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Uploaded dbt artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.128742Z"}}
{"data": {"msg": "Elementary: Uploading run results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Uploading run results.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.136267Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.139002Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.203525Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.263924Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "SQLQuery", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.264458Z"}}
{"data": {"elapsed": 0.1812793, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: SUCCESS in 0.181 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.446883Z"}}
{"data": {"msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.451466Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.706340Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.717985Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',6.173247575759888,'2024-10-30T02:09:10.370197Z','2024-10-30T02:09:16.527860Z','2024-10-30T02:09:10.359078Z','2024-10-30T02:09:10.367962Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241030_020910_00035_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241030_020910_00035_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.3579347133636475,'2024-10-30T02:09:16.551569Z','2024-10-30T02:09:17.895301Z','2024-10-30T02:09:16.540890Z','2024-10-30T02:09:16.550557Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241030_020916_00041_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241030_020916_00041_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.2963268756866455,'2024-10-30T02:09:17.915757Z','2024-10-30T02:09:19.195233Z','2024-10-30T02:09:17.904134Z','2024-10-30T02:09:17.914757Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241030_020917_00046_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241030_020917_00046_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',1.3966403007507324,'2024-10-30T02:09:19.222606Z','2024-10-30T02:09:20.599516Z','2024-10-30T02:09:19.209492Z','2024-10-30T02:09:19.221144Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241030_020919_00051_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241030_020919_00051_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',1.3982911109924316,'2024-10-30T02:09:20.630604Z','2024-10-30T02:09:22.007453Z','2024-10-30T02:09:20.614183Z','2024-10-30T02:09:20.625013Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241030_020920_00057_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241030_020920_00057_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',1.1217386722564697,'2024-10-30T02:09:22.028779Z','2024-10-30T02:09:23.134815Z','2024-10-30T02:09:22.018096Z','2024-10-30T02:09:22.027310Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241030_020922_00061_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241030_020922_00061_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',1.007910966873169,'2024-10-30T02:09:23.162846Z','2024-10-30T02:09:24.152196Z','2024-10-30T02:09:23.148577Z','2024-10-30T02:09:23.161347Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241030_020923_00065_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241030_020923_00065_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',0.9552371501922607,'2024-10-30T02:09:24.180313Z','2024-10-30T02:09:25.115332Z','2024-10-30T02:09:24.165353Z','2024-10-30T02:09:24.179235Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241030_020924_00069_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241030_020924_00069_7sfqi\"}')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',6.173247575759888,'2024-10-30T02:09:10.370197Z','2024-10-30T02:09:16.527860Z','2024-10-30T02:09:10.359078Z','2024-10-30T02:09:10.367962Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241030_020910_00035_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241030_020910_00035_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.3579347133636475,'2024-10-30T02:09:16.551569Z','2024-10-30T02:09:17.895301Z','2024-10-30T02:09:16.540890Z','2024-10-30T02:09:16.550557Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241030_020916_00041_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241030_020916_00041_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.2963268756866455,'2024-10-30T02:09:17.915757Z','2024-10-30T02:09:19.195233Z','2024-10-30T02:09:17.904134Z','2024-10-30T02:09:17.914757Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241030_020917_00046_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241030_020917_00046_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',1.3966403007507324,'2024-10-30T02:09:19.222606Z','2024-10-30T02:09:20.599516Z','2024-10-30T02:09:19.209492Z','2024-10-30T02:09:19.221144Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241030_020919_00051_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241030_020919_00051_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',1.3982911109924316,'2024-10-30T02:09:20.630604Z','2024-10-30T02:09:22.007453Z','2024-10-30T02:09:20.614183Z','2024-10-30T02:09:20.625013Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241030_020920_00057_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241030_020920_00057_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',1.1217386722564697,'2024-10-30T02:09:22.028779Z','2024-10-30T02:09:23.134815Z','2024-10-30T02:09:22.018096Z','2024-10-30T02:09:22.027310Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241030_020922_00061_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241030_020922_00061_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',1.007910966873169,'2024-10-30T02:09:23.162846Z','2024-10-30T02:09:24.152196Z','2024-10-30T02:09:23.148577Z','2024-10-30T02:09:23.161347Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241030_020923_00065_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241030_020923_00065_7sfqi\"}'),('3821f002-4849-4e6e-a43a-a9551049e4fc.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','3821f002-4849-4e6e-a43a-a9551049e4fc','2024-10-30 02:09:27',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',0.9552371501922607,'2024-10-30T02:09:24.180313Z','2024-10-30T02:09:25.115332Z','2024-10-30T02:09:24.165353Z','2024-10-30T02:09:24.179235Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241030_020924_00069_7sfqi','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241030_020924_00069_7sfqi\"}')", "name": "SQLQuery", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:27.719986Z"}}
{"data": {"elapsed": 0.6471318, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (8 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: INSERT (8 rows) in 0.647 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.370339Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.377406Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.063050 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.063050 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.378424Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.201904 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.201904 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.380953Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.382951Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.218127 (8 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.218127 (8 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.385314Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.234752 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.234752 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.387315Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.666551 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.666551 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.388824Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:01.125873 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:01.125873 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.391292Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.236886 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.236886 (1 runs)", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.393291Z"}}
{"data": {"msg": "Elementary: Uploaded run results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Uploaded run results successfully.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.395289Z"}}
{"data": {"msg": "Elementary: Handling test results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Handling test results.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.413090Z"}}
{"data": {"msg": "Elementary: Handled test results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Handled test results successfully.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.452253Z"}}
{"data": {"msg": "Elementary: Uploading dbt invocation.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Uploading dbt invocation.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.478972Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.587504Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "SQLQuery", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.588509Z"}}
{"data": {"elapsed": 0.2050987, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: SUCCESS in 0.205 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.794752Z"}}
{"data": {"msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.801242Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.839476Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.844486Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('3821f002-4849-4e6e-a43a-a9551049e4fc',NULL,NULL,NULL,'2024-10-30 02:09:07','2024-10-30 02:09:28','2024-10-30 02:09:28',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_specimen\", \"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_provider\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('3821f002-4849-4e6e-a43a-a9551049e4fc',NULL,NULL,NULL,'2024-10-30 02:09:07','2024-10-30 02:09:28','2024-10-30 02:09:28',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_specimen\", \"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_provider\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')", "name": "SQLQuery", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:28.846487Z"}}
{"data": {"elapsed": 0.6042342, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "SQL status: INSERT (1 rows) in 0.604 seconds", "name": "SQLQueryStatus", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.451399Z"}}
{"data": {"msg": "Elementary: Uploaded dbt invocation successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Elementary: Uploaded dbt invocation successfully.", "name": "JinjaLogDebug", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.455435Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-end-0\"", "name": "WritingInjectedSQLForNode", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.466857Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]", "name": "LogHookStartLine", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.468860Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-30T02:09:29.470102", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-30T02:09:25.125877", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-end.0 ........................................ [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.470102Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.471116Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.472116Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.474118Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Connection 'list_iceberg' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.475115Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Connection 'list_iceberg_omop' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.476573Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Connection 'model.my_dbt_trino_project.omop_visit_occurrence' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.478128Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.479148Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 20.14 seconds", "execution_time": 20.136223, "stat_line": "8 table models, 2 project hooks"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Finished running 8 table models, 2 project hooks in 0 hours 0 minutes and 20.14 seconds (20.14s).", "name": "FinishedRunningStats", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.479148Z"}}
{"data": {"elapsed_time": 20.136223, "generated_at": "2024-10-30T02:09:29Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241030_020910_00035_7sfqi", "rows_affected": 3.0}, "execution_time": 6.1732473, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:10.367962Z", "name": "compile", "started_at": "2024-10-30T02:09:10.359078Z"}, {"completed_at": "2024-10-30T02:09:16.527860Z", "name": "execute", "started_at": "2024-10-30T02:09:10.370197Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241030_020916_00041_7sfqi", "rows_affected": 5.0}, "execution_time": 1.3579347, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:16.550557Z", "name": "compile", "started_at": "2024-10-30T02:09:16.540890Z"}, {"completed_at": "2024-10-30T02:09:17.895301Z", "name": "execute", "started_at": "2024-10-30T02:09:16.551569Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241030_020917_00046_7sfqi", "rows_affected": 5.0}, "execution_time": 1.2963269, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:17.914757Z", "name": "compile", "started_at": "2024-10-30T02:09:17.904134Z"}, {"completed_at": "2024-10-30T02:09:19.195233Z", "name": "execute", "started_at": "2024-10-30T02:09:17.915757Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241030_020919_00051_7sfqi", "rows_affected": 1.0}, "execution_time": 1.3966403, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:19.221144Z", "name": "compile", "started_at": "2024-10-30T02:09:19.209492Z"}, {"completed_at": "2024-10-30T02:09:20.599516Z", "name": "execute", "started_at": "2024-10-30T02:09:19.222606Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241030_020920_00057_7sfqi", "rows_affected": 1.0}, "execution_time": 1.3982911, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:20.625013Z", "name": "compile", "started_at": "2024-10-30T02:09:20.614183Z"}, {"completed_at": "2024-10-30T02:09:22.007453Z", "name": "execute", "started_at": "2024-10-30T02:09:20.630604Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241030_020922_00061_7sfqi", "rows_affected": 6.0}, "execution_time": 1.1217387, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:22.027310Z", "name": "compile", "started_at": "2024-10-30T02:09:22.018096Z"}, {"completed_at": "2024-10-30T02:09:23.134815Z", "name": "execute", "started_at": "2024-10-30T02:09:22.028779Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241030_020923_00065_7sfqi", "rows_affected": 1.0}, "execution_time": 1.007911, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:23.161347Z", "name": "compile", "started_at": "2024-10-30T02:09:23.148577Z"}, {"completed_at": "2024-10-30T02:09:24.152196Z", "name": "execute", "started_at": "2024-10-30T02:09:23.162846Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241030_020924_00069_7sfqi", "rows_affected": 1.0}, "execution_time": 0.95523715, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-30T02:09:24.179235Z", "name": "compile", "started_at": "2024-10-30T02:09:24.165353Z"}, {"completed_at": "2024-10-30T02:09:25.115332Z", "name": "execute", "started_at": "2024-10-30T02:09:24.180313Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.483678Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.761161Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.763391Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "", "name": "Formatting", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.764619Z"}}
{"data": {"stats": {"error": 0, "pass": 8, "skip": 0, "total": 8, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "info", "msg": "Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8", "name": "StatsLine", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.765624Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-10-30T02:09:29.766631Z", "elapsed": 22.444399, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Command `dbt build` succeeded at 10:09:29.766631 after 22.44 seconds", "name": "CommandCompleted", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.767631Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "3821f002-4849-4e6e-a43a-a9551049e4fc", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 33132, "thread": "MainThread", "ts": "2024-10-30T02:09:29.768635Z"}}
