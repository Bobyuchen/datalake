{"data": {"log_version": 3, "version": "=1.8.8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Running with dbt=1.8.8", "name": "MainReportVersion", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:34.920185Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_specimen", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop\\target\\my_dbt_trino_project_dbt_assets-d3cf470-729816a", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\my_dbt_trino_project_dbt_assets-d3cf470-729816a", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop\\\\target\\\\my_dbt_trino_project_dbt_assets-d3cf470-729816a', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_visit_occurrence my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_specimen', 'target_path': 'target\\\\my_dbt_trino_project_dbt_assets-d3cf470-729816a', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:34.926601Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Registered adapter: trino=1.8.2", "name": "AdapterRegistered", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:35.567436Z"}}
{"data": {"checksum": "ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5", "profile": "", "target": "", "vars": "{}", "version": "1.8.8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8", "name": "StateCheckVarsHash", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:35.617089Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:36.114632Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:36.116292Z"}}
{"data": {"unused_config_paths": ["models.my_dbt_trino_project.source", "models.my_dbt_trino_project.stage"]}, "info": {"category": "", "code": "I051", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 2 unused configuration paths:\n- models.my_dbt_trino_project.source\n- models.my_dbt_trino_project.stage", "name": "UnusedResourceConfigPath", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:36.127527Z"}}
{"data": {"stat_line": "86 models, 2 operations, 15 sources, 1337 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Found 86 models, 2 operations, 15 sources, 1337 macros", "name": "FoundStats", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:36.511934Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:36.529526Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:36.531159Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 59280, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T06:20:36.541201Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 59280, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T06:20:36.788850Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 59280, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T06:20:36.789860Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59280, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T06:20:36.791126Z"}}
{"data": {"elapsed": 0.1106502, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: SUCCESS in 0.111 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T06:20:36.901496Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T06:20:36.903495Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_omop'", "name": "NewConnection", "pid": 59280, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T06:20:36.911827Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"list_iceberg_omop\"", "name": "ConnectionUsed", "pid": 59280, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T06:20:36.935355Z"}}
{"data": {"conn_name": "list_iceberg_omop", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On list_iceberg_omop: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'", "name": "SQLQuery", "pid": 59280, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T06:20:36.936350Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59280, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T06:20:36.937350Z"}}
{"data": {"elapsed": 0.1606964, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: SUCCESS in 0.161 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T06:20:37.097226Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On list_iceberg_omop: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T06:20:37.101119Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On list_iceberg_omop: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T06:20:37.102114Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.114504Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.115523Z"}}
{"data": {"hook_type": "on-run-start", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Running 1 on-run-start hook", "name": "HooksRunning", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.116140Z"}}
{"data": {"msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "name": "JinjaLogInfo", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.170270Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.213787Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'", "name": "SQLQuery", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.213787Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.216213Z"}}
{"data": {"elapsed": 0.0738349, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: SUCCESS in 0.074 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.289591Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-start-0\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.294123Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]", "name": "LogHookStartLine", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.302642Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T06:20:37.304155", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.117152", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-start.0 ...................................... [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.305166Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.306233Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.307242Z"}}
{"data": {"node_count": 8, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.308254Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:37.308254Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_care_site", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.315324Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "1 of 8 START sql table model omop.omop_care_site ............................... [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.316670Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Acquiring new trino connection 'model.my_dbt_trino_project.omop_care_site'", "name": "NewConnection", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.318943Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_care_site", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.318943Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.326232Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_care_site", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.328670Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.401031Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.406030Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.407027Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.408033Z"}}
{"data": {"elapsed": 0.5088943, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (3 rows) in 0.509 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.917232Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.929777Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:37.930869Z"}}
{"data": {"elapsed": 0.0970808, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.097 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.028298Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.034242Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.035305Z"}}
{"data": {"elapsed": 0.1080974, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.108 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.144547Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.162098Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.169164Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.170614Z"}}
{"data": {"elapsed": 0.2443775, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.244 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.416640Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.447426Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.448424Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "execution_time": 1.1324949, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:38.450423", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "1 of 8 OK created sql table model omop.omop_care_site .......................... [\u001b[32mCREATE TABLE (3 rows)\u001b[0m in 1.13s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.452428Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:38.450423", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:37.315324", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_055835_00275_u6rsp", "rows_affected": 3.0}, "execution_time": 1.1324949, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:37.328670Z", "name": "compile", "started_at": "2024-10-25T06:20:37.320320Z"}, {"completed_at": "2024-10-25T06:20:38.447426Z", "name": "execute", "started_at": "2024-10-25T06:20:37.330165Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_care_site", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.454797Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_measurement", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.456963Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "2 of 8 START sql table model omop.omop_measurement ............................. [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.458975Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "orig_conn_name": "model.my_dbt_trino_project.omop_care_site"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_care_site, now model.my_dbt_trino_project.omop_measurement)", "name": "ConnectionReused", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.459975Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_measurement", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.461326Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.471094Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_measurement", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.473651Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.489180Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.500131Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.501641Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.503163Z"}}
{"data": {"elapsed": 0.4757706, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.476 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.979306Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.984834Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:38.986833Z"}}
{"data": {"elapsed": 0.0809571, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.081 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.068242Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.074310Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.075313Z"}}
{"data": {"elapsed": 0.0808374, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.081 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.157551Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.163455Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.165450Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.166552Z"}}
{"data": {"elapsed": 0.1580142, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.158 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.324891Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.329803Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.330805Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "execution_time": 0.87255025, "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:39.332525", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "2 of 8 OK created sql table model omop.omop_measurement ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 0.87s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.335103Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:39.332525", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:38.455805", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_055836_00279_u6rsp", "rows_affected": 5.0}, "execution_time": 0.87255025, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:38.473651Z", "name": "compile", "started_at": "2024-10-25T06:20:38.462338Z"}, {"completed_at": "2024-10-25T06:20:39.329803Z", "name": "execute", "started_at": "2024-10-25T06:20:38.475044Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_measurement", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.336394Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_observation", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.338531Z"}}
{"data": {"description": "sql table model omop.omop_observation", "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "3 of 8 START sql table model omop.omop_observation ............................. [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.340047Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "orig_conn_name": "model.my_dbt_trino_project.omop_measurement"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_measurement, now model.my_dbt_trino_project.omop_observation)", "name": "ConnectionReused", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.341064Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_observation", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.342061Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_observation\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.350609Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_observation", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.353600Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.368255Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.376467Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.379216Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.380229Z"}}
{"data": {"elapsed": 0.4232366, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.423 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.803647Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.811790Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.814009Z"}}
{"data": {"elapsed": 0.0922982, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.092 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.907445Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.913312Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:39.914313Z"}}
{"data": {"elapsed": 0.0946887, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.095 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.009825Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.018234Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.020243Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.020243Z"}}
{"data": {"elapsed": 0.1562017, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.156 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.177934Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.181942Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.181942Z"}}
{"data": {"description": "sql table model omop.omop_observation", "execution_time": 0.8423395, "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:40.183404", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "3 of 8 OK created sql table model omop.omop_observation ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 0.84s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.183404Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:40.183404", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:39.338531", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_055837_00283_u6rsp", "rows_affected": 5.0}, "execution_time": 0.8423395, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:39.353600Z", "name": "compile", "started_at": "2024-10-25T06:20:39.343062Z"}, {"completed_at": "2024-10-25T06:20:40.181942Z", "name": "execute", "started_at": "2024-10-25T06:20:39.354603Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_observation", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.185828Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_person", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.187839Z"}}
{"data": {"description": "sql table model omop.omop_person", "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "4 of 8 START sql table model omop.omop_person .................................. [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.189318Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "orig_conn_name": "model.my_dbt_trino_project.omop_observation"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_observation, now model.my_dbt_trino_project.omop_person)", "name": "ConnectionReused", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.191689Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_person", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.191689Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_person\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.201622Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_person", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.204965Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.221048Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.228784Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.231306Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.232308Z"}}
{"data": {"elapsed": 0.383768, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.384 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.616734Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.624461Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.625456Z"}}
{"data": {"elapsed": 0.082828, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.083 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.710086Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.718137Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.719192Z"}}
{"data": {"elapsed": 0.0779913, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.078 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.798095Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.803986Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.805473Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.806471Z"}}
{"data": {"elapsed": 0.1252365, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.125 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.933004Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.936778Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.937878Z"}}
{"data": {"description": "sql table model omop.omop_person", "execution_time": 0.74829817, "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:40.938975", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "4 of 8 OK created sql table model omop.omop_person ............................. [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.75s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.939725Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:40.938975", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.187839", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_055838_00287_u6rsp", "rows_affected": 1.0}, "execution_time": 0.74829817, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:40.203949Z", "name": "compile", "started_at": "2024-10-25T06:20:40.193146Z"}, {"completed_at": "2024-10-25T06:20:40.936778Z", "name": "execute", "started_at": "2024-10-25T06:20:40.204965Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_person", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.941644Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.943266Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "5 of 8 START sql table model omop.omop_procedure_occurrence .................... [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.944863Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_person"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_person, now model.my_dbt_trino_project.omop_procedure_occurrence)", "name": "ConnectionReused", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.946014Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.947113Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.953712Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.955938Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.969445Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.972167Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.974404Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:40.974404Z"}}
{"data": {"elapsed": 0.4039575, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.404 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.378598Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.384595Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.385594Z"}}
{"data": {"elapsed": 0.0890531, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.089 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.476047Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.483119Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.483671Z"}}
{"data": {"elapsed": 0.0933852, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.093 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.577839Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.582848Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.584855Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.585853Z"}}
{"data": {"elapsed": 0.1470683, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.147 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.734326Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.738724Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.739796Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "execution_time": 0.79543996, "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:41.741453", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "5 of 8 OK created sql table model omop.omop_procedure_occurrence ............... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.80s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.742561Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:41.741453", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:40.943266", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_055839_00291_u6rsp", "rows_affected": 1.0}, "execution_time": 0.79543996, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:40.955430Z", "name": "compile", "started_at": "2024-10-25T06:20:40.948214Z"}, {"completed_at": "2024-10-25T06:20:41.738179Z", "name": "execute", "started_at": "2024-10-25T06:20:40.957236Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.744892Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_provider", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.746703Z"}}
{"data": {"description": "sql table model omop.omop_provider", "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "6 of 8 START sql table model omop.omop_provider ................................ [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.748322Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "orig_conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_procedure_occurrence, now model.my_dbt_trino_project.omop_provider)", "name": "ConnectionReused", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.750013Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_provider", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.751107Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_provider\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.762621Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_provider", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.765487Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.781460Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.790053Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.792125Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:41.793270Z"}}
{"data": {"elapsed": 0.3424187, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (6 rows) in 0.342 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.136118Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.142779Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.143789Z"}}
{"data": {"elapsed": 0.0969138, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.097 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.241401Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.247566Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.248946Z"}}
{"data": {"elapsed": 0.0780394, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.078 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.327752Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.333767Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.336295Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.337294Z"}}
{"data": {"elapsed": 0.1561089, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.156 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.494074Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.499701Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.500984Z"}}
{"data": {"description": "sql table model omop.omop_provider", "execution_time": 0.7525811, "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:42.501985", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "6 of 8 OK created sql table model omop.omop_provider ........................... [\u001b[32mCREATE TABLE (6 rows)\u001b[0m in 0.75s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.501985Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:42.501985", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:41.746091", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_055840_00295_u6rsp", "rows_affected": 6.0}, "execution_time": 0.7525811, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:41.764841Z", "name": "compile", "started_at": "2024-10-25T06:20:41.751674Z"}, {"completed_at": "2024-10-25T06:20:42.499701Z", "name": "execute", "started_at": "2024-10-25T06:20:41.766563Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_provider", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.504836Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_specimen", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.505849Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "7 of 8 START sql table model omop.omop_specimen ................................ [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.506861Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "orig_conn_name": "model.my_dbt_trino_project.omop_provider"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_provider, now model.my_dbt_trino_project.omop_specimen)", "name": "ConnectionReused", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.508874Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_specimen", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.510263Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.523573Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_specimen", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.526015Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.536849Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.541408Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.543425Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.543934Z"}}
{"data": {"elapsed": 0.3983225, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.398 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.942874Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.951453Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:42.952702Z"}}
{"data": {"elapsed": 0.0939167, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.094 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.048268Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.059668Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.061360Z"}}
{"data": {"elapsed": 0.0898644, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.090 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.152849Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.159816Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.161817Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.162816Z"}}
{"data": {"elapsed": 0.1459803, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.146 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.309495Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.314034Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.315038Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "execution_time": 0.8081627, "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:43.316037", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "7 of 8 OK created sql table model omop.omop_specimen ........................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.81s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.316346Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:43.316037", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:42.505849", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_055840_00299_u6rsp", "rows_affected": 1.0}, "execution_time": 0.8081627, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:42.525289Z", "name": "compile", "started_at": "2024-10-25T06:20:42.510263Z"}, {"completed_at": "2024-10-25T06:20:43.313025Z", "name": "execute", "started_at": "2024-10-25T06:20:42.527072Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_specimen", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.317461Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeStart", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.320290Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "8 of 8 START sql table model omop.omop_visit_occurrence ........................ [RUN]", "name": "LogStartLine", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.321442Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_specimen"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_specimen, now model.my_dbt_trino_project.omop_visit_occurrence)", "name": "ConnectionReused", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.323596Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeCompiling", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.325105Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.337124Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeExecuting", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.339242Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.347529Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.350633Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.351974Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.352985Z"}}
{"data": {"elapsed": 0.4049263, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.405 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.758408Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.765688Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.767215Z"}}
{"data": {"elapsed": 0.0925127, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.093 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.861141Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.872115Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.873214Z"}}
{"data": {"elapsed": 0.1007396, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.101 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.975212Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.981213Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.983211Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:43.984213Z"}}
{"data": {"elapsed": 0.1441318, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: DROP TABLE in 0.144 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:44.129121Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: ROLLBACK", "name": "Rollback", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:44.134123Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:44.135123Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "execution_time": 0.8130381, "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:44.136634", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "8 of 8 OK created sql table model omop.omop_visit_occurrence ................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.81s]", "name": "LogModelResult", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:44.137647Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T06:20:44.136634", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:43.320290", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_055841_00303_u6rsp", "rows_affected": 1.0}, "execution_time": 0.8130381, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:43.339242Z", "name": "compile", "started_at": "2024-10-25T06:20:43.326115Z"}, {"completed_at": "2024-10-25T06:20:44.133125Z", "name": "execute", "started_at": "2024-10-25T06:20:43.340243Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeFinished", "pid": 59280, "thread": "Thread-1 (worker)", "ts": "2024-10-25T06:20:44.139809Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.142330Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.143331Z"}}
{"data": {"hook_type": "on-run-end", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Running 1 on-run-end hook", "name": "HooksRunning", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.144328Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.243914Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash", "name": "SQLQuery", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.245913Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.246914Z"}}
{"data": {"elapsed": 0.3590997, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: SUCCESS in 0.359 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.606552Z"}}
{"data": {"msg": "Elementary: Uploading dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Uploading dbt artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.620602Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_models] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.661884Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.807554Z"}}
{"data": {"msg": "Elementary: [dbt_models] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_models] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.823810Z"}}
{"data": {"msg": "Elementary: [dbt_models] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_models] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.829328Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.837861Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.143657 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.143657 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.841863Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.174966 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.174966 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.846994Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_tests] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.859691Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.864714Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.869712Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_tests] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.872714Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.876725Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.000998 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.000998 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.879103Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.017542 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.017542 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.882099Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_sources] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.893626Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.948138Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.950887Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_sources] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.952889Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.957105Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.050755 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.050755 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.959105Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.062468 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.062468 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.961618Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.970826Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.973821Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.976824Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.978824Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.980824Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000998 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000998 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.982824Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.011000 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.011000 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.984823Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.994182Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:44.997176Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.001613Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_metrics] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.004619Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.008878Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.010878Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.014689 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.014689 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.012878Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.021876Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.024889Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.027397Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_exposures] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.029401Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.032597Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.035150Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.010721 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.010721 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.038270Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.049488Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.052890Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.056267Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_seeds] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.058262Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.060268Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.001389 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.001389 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.062772Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.010780 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.010780 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.067297Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_columns] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.079570Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.960052Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.963050Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_columns] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.966048Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.969062Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.878461 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.878461 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.973071Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.890495 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.890495 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.975071Z"}}
{"data": {"msg": "Elementary: Uploaded dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Uploaded dbt artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.977071Z"}}
{"data": {"msg": "Elementary: Uploading run results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Uploading run results.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.985924Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:45.988503Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.062002Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.118856Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "SQLQuery", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.120122Z"}}
{"data": {"elapsed": 0.1169257, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: SUCCESS in 0.117 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.238171Z"}}
{"data": {"msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.244627Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.503326Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.524304Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',1.1324949264526367,'2024-10-25T06:20:37.330165Z','2024-10-25T06:20:38.447426Z','2024-10-25T06:20:37.320320Z','2024-10-25T06:20:37.328670Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_055835_00275_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_055835_00275_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',0.8725502490997314,'2024-10-25T06:20:38.475044Z','2024-10-25T06:20:39.329803Z','2024-10-25T06:20:38.462338Z','2024-10-25T06:20:38.473651Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_055836_00279_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_055836_00279_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',0.8423395156860352,'2024-10-25T06:20:39.354603Z','2024-10-25T06:20:40.181942Z','2024-10-25T06:20:39.343062Z','2024-10-25T06:20:39.353600Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_055837_00283_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_055837_00283_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',0.748298168182373,'2024-10-25T06:20:40.204965Z','2024-10-25T06:20:40.936778Z','2024-10-25T06:20:40.193146Z','2024-10-25T06:20:40.203949Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_055838_00287_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_055838_00287_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',0.7954399585723877,'2024-10-25T06:20:40.957236Z','2024-10-25T06:20:41.738179Z','2024-10-25T06:20:40.948214Z','2024-10-25T06:20:40.955430Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_055839_00291_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_055839_00291_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',0.7525811195373535,'2024-10-25T06:20:41.766563Z','2024-10-25T06:20:42.499701Z','2024-10-25T06:20:41.751674Z','2024-10-25T06:20:41.764841Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_055840_00295_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_055840_00295_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',0.8081626892089844,'2024-10-25T06:20:42.527072Z','2024-10-25T06:20:43.313025Z','2024-10-25T06:20:42.510263Z','2024-10-25T06:20:42.525289Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_055840_00299_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_055840_00299_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',0.8130381107330322,'2024-10-25T06:20:43.340243Z','2024-10-25T06:20:44.133125Z','2024-10-25T06:20:43.326115Z','2024-10-25T06:20:43.339242Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_055841_00303_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_055841_00303_u6rsp\"}')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',1.1324949264526367,'2024-10-25T06:20:37.330165Z','2024-10-25T06:20:38.447426Z','2024-10-25T06:20:37.320320Z','2024-10-25T06:20:37.328670Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_055835_00275_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_055835_00275_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',0.8725502490997314,'2024-10-25T06:20:38.475044Z','2024-10-25T06:20:39.329803Z','2024-10-25T06:20:38.462338Z','2024-10-25T06:20:38.473651Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_055836_00279_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_055836_00279_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',0.8423395156860352,'2024-10-25T06:20:39.354603Z','2024-10-25T06:20:40.181942Z','2024-10-25T06:20:39.343062Z','2024-10-25T06:20:39.353600Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_055837_00283_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_055837_00283_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',0.748298168182373,'2024-10-25T06:20:40.204965Z','2024-10-25T06:20:40.936778Z','2024-10-25T06:20:40.193146Z','2024-10-25T06:20:40.203949Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_055838_00287_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_055838_00287_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',0.7954399585723877,'2024-10-25T06:20:40.957236Z','2024-10-25T06:20:41.738179Z','2024-10-25T06:20:40.948214Z','2024-10-25T06:20:40.955430Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_055839_00291_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_055839_00291_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',0.7525811195373535,'2024-10-25T06:20:41.766563Z','2024-10-25T06:20:42.499701Z','2024-10-25T06:20:41.751674Z','2024-10-25T06:20:41.764841Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_055840_00295_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_055840_00295_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',0.8081626892089844,'2024-10-25T06:20:42.527072Z','2024-10-25T06:20:43.313025Z','2024-10-25T06:20:42.510263Z','2024-10-25T06:20:42.525289Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_055840_00299_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_055840_00299_u6rsp\"}'),('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3','2024-10-25 06:20:46',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',0.8130381107330322,'2024-10-25T06:20:43.340243Z','2024-10-25T06:20:44.133125Z','2024-10-25T06:20:43.326115Z','2024-10-25T06:20:43.339242Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_055841_00303_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_055841_00303_u6rsp\"}')", "name": "SQLQuery", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.527683Z"}}
{"data": {"elapsed": 0.4337398, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (8 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: INSERT (8 rows) in 0.434 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.964700Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.972022Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.071487 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.071487 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.974192Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.138417 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.138417 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.976937Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.002000 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.002000 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.978579Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.214944 (8 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.214944 (8 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.980774Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.233455 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.233455 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.982439Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.463145 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.463145 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.984079Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.865663 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.865663 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.986371Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.982458 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.982458 (1 runs)", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.987907Z"}}
{"data": {"msg": "Elementary: Uploaded run results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Uploaded run results successfully.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:46.990163Z"}}
{"data": {"msg": "Elementary: Handling test results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Handling test results.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.005326Z"}}
{"data": {"msg": "Elementary: Handled test results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Handled test results successfully.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.042533Z"}}
{"data": {"msg": "Elementary: Uploading dbt invocation.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Uploading dbt invocation.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.071059Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.182507Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "SQLQuery", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.183800Z"}}
{"data": {"elapsed": 0.1238158, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: SUCCESS in 0.124 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.308652Z"}}
{"data": {"msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.313663Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.363564Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.376458Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3',NULL,NULL,NULL,'2024-10-25 06:20:34','2024-10-25 06:20:47','2024-10-25 06:20:47',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_specimen\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3',NULL,NULL,NULL,'2024-10-25 06:20:34','2024-10-25 06:20:47','2024-10-25 06:20:47',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_visit_occurrence\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_specimen\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')", "name": "SQLQuery", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.378837Z"}}
{"data": {"elapsed": 0.4272684, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "SQL status: INSERT (1 rows) in 0.427 seconds", "name": "SQLQueryStatus", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.808191Z"}}
{"data": {"msg": "Elementary: Uploaded dbt invocation successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Elementary: Uploaded dbt invocation successfully.", "name": "JinjaLogDebug", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.814265Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-end-0\"", "name": "WritingInjectedSQLForNode", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.832576Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]", "name": "LogHookStartLine", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.835440Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T06:20:47.837236", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T06:20:44.145327", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-end.0 ........................................ [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.837875Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.839748Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.840889Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.843902Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Connection 'list_iceberg' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.846409Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Connection 'list_iceberg_omop' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.846409Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Connection 'model.my_dbt_trino_project.omop_visit_occurrence' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.847421Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.849421Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 11.32 seconds", "execution_time": 11.3178, "stat_line": "8 table models, 2 project hooks"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Finished running 8 table models, 2 project hooks in 0 hours 0 minutes and 11.32 seconds (11.32s).", "name": "FinishedRunningStats", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.850421Z"}}
{"data": {"elapsed_time": 11.3178, "generated_at": "2024-10-25T06:20:47Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_055835_00275_u6rsp", "rows_affected": 3.0}, "execution_time": 1.1324949, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:37.328670Z", "name": "compile", "started_at": "2024-10-25T06:20:37.320320Z"}, {"completed_at": "2024-10-25T06:20:38.447426Z", "name": "execute", "started_at": "2024-10-25T06:20:37.330165Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_055836_00279_u6rsp", "rows_affected": 5.0}, "execution_time": 0.87255025, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:38.473651Z", "name": "compile", "started_at": "2024-10-25T06:20:38.462338Z"}, {"completed_at": "2024-10-25T06:20:39.329803Z", "name": "execute", "started_at": "2024-10-25T06:20:38.475044Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_055837_00283_u6rsp", "rows_affected": 5.0}, "execution_time": 0.8423395, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:39.353600Z", "name": "compile", "started_at": "2024-10-25T06:20:39.343062Z"}, {"completed_at": "2024-10-25T06:20:40.181942Z", "name": "execute", "started_at": "2024-10-25T06:20:39.354603Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_055838_00287_u6rsp", "rows_affected": 1.0}, "execution_time": 0.74829817, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:40.203949Z", "name": "compile", "started_at": "2024-10-25T06:20:40.193146Z"}, {"completed_at": "2024-10-25T06:20:40.936778Z", "name": "execute", "started_at": "2024-10-25T06:20:40.204965Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_055839_00291_u6rsp", "rows_affected": 1.0}, "execution_time": 0.79543996, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:40.955430Z", "name": "compile", "started_at": "2024-10-25T06:20:40.948214Z"}, {"completed_at": "2024-10-25T06:20:41.738179Z", "name": "execute", "started_at": "2024-10-25T06:20:40.957236Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_055840_00295_u6rsp", "rows_affected": 6.0}, "execution_time": 0.7525811, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:41.764841Z", "name": "compile", "started_at": "2024-10-25T06:20:41.751674Z"}, {"completed_at": "2024-10-25T06:20:42.499701Z", "name": "execute", "started_at": "2024-10-25T06:20:41.766563Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_055840_00299_u6rsp", "rows_affected": 1.0}, "execution_time": 0.8081627, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:42.525289Z", "name": "compile", "started_at": "2024-10-25T06:20:42.510263Z"}, {"completed_at": "2024-10-25T06:20:43.313025Z", "name": "execute", "started_at": "2024-10-25T06:20:42.527072Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_055841_00303_u6rsp", "rows_affected": 1.0}, "execution_time": 0.8130381, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T06:20:43.339242Z", "name": "compile", "started_at": "2024-10-25T06:20:43.326115Z"}, {"completed_at": "2024-10-25T06:20:44.133125Z", "name": "execute", "started_at": "2024-10-25T06:20:43.340243Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:47.856337Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:48.126115Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:48.127149Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "", "name": "Formatting", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:48.128150Z"}}
{"data": {"stats": {"error": 0, "pass": 8, "skip": 0, "total": 8, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "info", "msg": "Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8", "name": "StatsLine", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:48.129399Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-10-25T06:20:48.130415Z", "elapsed": 13.45532, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Command `dbt build` succeeded at 14:20:48.130415 after 13.46 seconds", "name": "CommandCompleted", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:48.130415Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "cb62c0ae-f9a3-4ce6-ab27-e0120b6b67b3", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 59280, "thread": "MainThread", "ts": "2024-10-25T06:20:48.131424Z"}}
