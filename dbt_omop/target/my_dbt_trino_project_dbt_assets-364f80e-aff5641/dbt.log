{"data": {"log_version": 3, "version": "=1.8.8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Running with dbt=1.8.8", "name": "MainReportVersion", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:27.822291Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_specimen my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_visit_occurrence", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop\\target\\my_dbt_trino_project_dbt_assets-364f80e-aff5641", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt-omop", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\my_dbt_trino_project_dbt_assets-364f80e-aff5641", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\\\Users\\\\ASUS\\\\Desktop\\\\work\\\\datalake\\\\dbt-omop\\\\target\\\\my_dbt_trino_project_dbt_assets-364f80e-aff5641', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select my_dbt_trino_project.staging.omop_measurement my_dbt_trino_project.staging.omop_provider my_dbt_trino_project.staging.omop_person my_dbt_trino_project.staging.omop_care_site my_dbt_trino_project.staging.omop_specimen my_dbt_trino_project.staging.omop_observation my_dbt_trino_project.staging.omop_procedure_occurrence my_dbt_trino_project.staging.omop_visit_occurrence', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'target\\\\my_dbt_trino_project_dbt_assets-364f80e-aff5641', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:27.827688Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Registered adapter: trino=1.8.2", "name": "AdapterRegistered", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:28.510288Z"}}
{"data": {"checksum": "ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5", "profile": "", "target": "", "vars": "{}", "version": "1.8.8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8", "name": "StateCheckVarsHash", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:28.564145Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:29.172274Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:29.172274Z"}}
{"data": {"unused_config_paths": ["models.my_dbt_trino_project.stage", "models.my_dbt_trino_project.source"]}, "info": {"category": "", "code": "I051", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 2 unused configuration paths:\n- models.my_dbt_trino_project.stage\n- models.my_dbt_trino_project.source", "name": "UnusedResourceConfigPath", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:29.190257Z"}}
{"data": {"stat_line": "86 models, 2 operations, 15 sources, 1337 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Found 86 models, 2 operations, 15 sources, 1337 macros", "name": "FoundStats", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:29.615507Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:29.639431Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:29.639431Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 59316, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T03:28:29.649712Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 59316, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T03:28:29.906411Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 59316, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T03:28:29.908169Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59316, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T03:28:29.908169Z"}}
{"data": {"elapsed": 0.1427411, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: SUCCESS in 0.143 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T03:28:30.051869Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-25T03:28:30.054417Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_omop'", "name": "NewConnection", "pid": 59316, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T03:28:30.063768Z"}}
{"data": {"conn_name": "list_iceberg_omop", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"list_iceberg_omop\"", "name": "ConnectionUsed", "pid": 59316, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T03:28:30.093246Z"}}
{"data": {"conn_name": "list_iceberg_omop", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On list_iceberg_omop: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"list_iceberg_omop\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'omop') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'omop'", "name": "SQLQuery", "pid": 59316, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T03:28:30.093246Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59316, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T03:28:30.096922Z"}}
{"data": {"elapsed": 0.3201375, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: SUCCESS in 0.320 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T03:28:30.417718Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On list_iceberg_omop: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T03:28:30.424408Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On list_iceberg_omop: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-25T03:28:30.426177Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.450649Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.452481Z"}}
{"data": {"hook_type": "on-run-start", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Running 1 on-run-start hook", "name": "HooksRunning", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.453164Z"}}
{"data": {"msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "\nIMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations. \nElementary requires this ability to support collection of samples and failed row count for dbt tests.\nPlease add the following flag to dbt_project.yml to allow it:\n\nflags:\n  require_explicit_package_overrides_for_builtin_materializations: false\n\nNotes - \n* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.\n* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.\n        ", "name": "JinjaLogInfo", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.533798Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.596254Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\nselect count(*)\n        from \"iceberg\".INFORMATION_SCHEMA.schemata\n        where catalog_name = 'iceberg'\n          and schema_name = 'omop__tests'", "name": "SQLQuery", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.600496Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.604055Z"}}
{"data": {"elapsed": 0.1534702, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: SUCCESS in 0.153 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.757082Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-start-0\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.764812Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]", "name": "LogHookStartLine", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.779289Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T03:28:30.781956", "node_name": "elementary-on-run-start-0", "node_path": "hooks\\elementary-on-run-start-0.sql", "node_relation": {"alias": "elementary-on-run-start-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.454174", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-start-0"}, "statement": "elementary.on-run-start.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-start.0 ...................................... [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.782104Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.783736Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.784605Z"}}
{"data": {"node_count": 8, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.786642Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:30.787839Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_care_site", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.794782Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "1 of 8 START sql table model omop.omop_care_site ............................... [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.796513Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Acquiring new trino connection 'model.my_dbt_trino_project.omop_care_site'", "name": "NewConnection", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.797696Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_care_site", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.799457Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.809689Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_care_site", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.814908Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_care_site\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.900963Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.907026Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.908045Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:30.910062Z"}}
{"data": {"elapsed": 1.4393629, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (3 rows) in 1.439 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.348610Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.366047Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site\" rename to \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.367046Z"}}
{"data": {"elapsed": 0.1634329, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.163 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.531904Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.542716Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\nalter table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_care_site\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.543838Z"}}
{"data": {"elapsed": 0.0572746, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.057 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.601809Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.616033Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_care_site\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.621518Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_care_site__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:32.622527Z"}}
{"data": {"elapsed": 0.7510708, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.751 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.374941Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.415710Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_care_site", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_care_site: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.416713Z"}}
{"data": {"description": "sql table model omop.omop_care_site", "execution_time": 2.6203747, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:33.418071", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "status": "CREATE TABLE (3 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "1 of 8 OK created sql table model omop.omop_care_site .......................... [\u001b[32mCREATE TABLE (3 rows)\u001b[0m in 2.62s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.420797Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:33.418071", "node_name": "omop_care_site", "node_path": "staging\\omop_care_site.sql", "node_relation": {"alias": "omop_care_site", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_care_site\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:30.793770", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_care_site"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_032830_00041_u6rsp", "rows_affected": 3.0}, "execution_time": 2.6203747, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:30.812716Z", "name": "compile", "started_at": "2024-10-25T03:28:30.801195Z"}, {"completed_at": "2024-10-25T03:28:33.414715Z", "name": "execute", "started_at": "2024-10-25T03:28:30.816035Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_care_site", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.422797Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_measurement", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.423567Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "2 of 8 START sql table model omop.omop_measurement ............................. [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.427038Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "orig_conn_name": "model.my_dbt_trino_project.omop_care_site"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_care_site, now model.my_dbt_trino_project.omop_measurement)", "name": "ConnectionReused", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.429040Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_measurement", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.432313Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.446555Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_measurement", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.450455Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_measurement\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.465697Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.476767Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.477764Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:33.478763Z"}}
{"data": {"elapsed": 0.7353521, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.735 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.215121Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.224848Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement\" rename to \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.226619Z"}}
{"data": {"elapsed": 0.1073284, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.107 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.336196Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.346769Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\nalter table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_measurement\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.346769Z"}}
{"data": {"elapsed": 0.0572412, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.057 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.406032Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.417482Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_measurement\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.419313Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_measurement__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.420038Z"}}
{"data": {"elapsed": 0.2222918, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.222 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.644999Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.649767Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_measurement", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_measurement: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.651278Z"}}
{"data": {"description": "sql table model omop.omop_measurement", "execution_time": 1.2242868, "index": 2, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:34.653327", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "2 of 8 OK created sql table model omop.omop_measurement ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.22s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.654476Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:34.653327", "node_name": "omop_measurement", "node_path": "staging\\omop_measurement.sql", "node_relation": {"alias": "omop_measurement", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_measurement\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:33.423567", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_measurement"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_032833_00045_u6rsp", "rows_affected": 5.0}, "execution_time": 1.2242868, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:33.450160Z", "name": "compile", "started_at": "2024-10-25T03:28:33.434067Z"}, {"completed_at": "2024-10-25T03:28:34.649767Z", "name": "execute", "started_at": "2024-10-25T03:28:33.451504Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_measurement", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.656009Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_observation", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.658893Z"}}
{"data": {"description": "sql table model omop.omop_observation", "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "3 of 8 START sql table model omop.omop_observation ............................. [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.660011Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "orig_conn_name": "model.my_dbt_trino_project.omop_measurement"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_measurement, now model.my_dbt_trino_project.omop_observation)", "name": "ConnectionReused", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.664157Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_observation", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.665787Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_observation\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.676675Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_observation", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.680130Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_observation\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.699042Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.707703Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.709602Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:34.711841Z"}}
{"data": {"elapsed": 0.6161633, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (5 rows) in 0.616 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.328052Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.338353Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation\" rename to \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.340156Z"}}
{"data": {"elapsed": 0.1044824, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.104 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.445978Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.456991Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\nalter table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_observation\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.459699Z"}}
{"data": {"elapsed": 0.1126711, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.113 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.575321Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.584882Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_observation\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.587097Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_observation__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.588445Z"}}
{"data": {"elapsed": 0.2147958, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.215 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.805080Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.810211Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_observation", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_observation: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.811868Z"}}
{"data": {"description": "sql table model omop.omop_observation", "execution_time": 1.150276, "index": 3, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:35.813607", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "status": "CREATE TABLE (5 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "3 of 8 OK created sql table model omop.omop_observation ........................ [\u001b[32mCREATE TABLE (5 rows)\u001b[0m in 1.15s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.814913Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:35.813607", "node_name": "omop_observation", "node_path": "staging\\omop_observation.sql", "node_relation": {"alias": "omop_observation", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_observation\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:34.658893", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_observation"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_032834_00049_u6rsp", "rows_affected": 5.0}, "execution_time": 1.150276, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:34.679947Z", "name": "compile", "started_at": "2024-10-25T03:28:34.665787Z"}, {"completed_at": "2024-10-25T03:28:35.810211Z", "name": "execute", "started_at": "2024-10-25T03:28:34.681764Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_observation", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.817201Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_person", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.819369Z"}}
{"data": {"description": "sql table model omop.omop_person", "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "4 of 8 START sql table model omop.omop_person .................................. [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.821225Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "orig_conn_name": "model.my_dbt_trino_project.omop_observation"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_observation, now model.my_dbt_trino_project.omop_person)", "name": "ConnectionReused", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.824100Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_person", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.825553Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_person\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.836131Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_person", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.838666Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_person\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.857808Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.866733Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.868218Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:35.870228Z"}}
{"data": {"elapsed": 0.5877982, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.588 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.458157Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.470205Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person\" rename to \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.471244Z"}}
{"data": {"elapsed": 0.1092477, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.109 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.582936Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.588935Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\nalter table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_person\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.595098Z"}}
{"data": {"elapsed": 0.0973045, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.097 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.693640Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.702191Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_person\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.705600Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_person__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.707543Z"}}
{"data": {"elapsed": 0.2224223, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.222 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.931380Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.936952Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_person", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_person: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.938857Z"}}
{"data": {"description": "sql table model omop.omop_person", "execution_time": 1.116581, "index": 4, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:36.939682", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "4 of 8 OK created sql table model omop.omop_person ............................. [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.12s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.940692Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:36.939682", "node_name": "omop_person", "node_path": "staging\\omop_person.sql", "node_relation": {"alias": "omop_person", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_person\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:35.819369", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_person"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_032835_00053_u6rsp", "rows_affected": 1.0}, "execution_time": 1.116581, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:35.837329Z", "name": "compile", "started_at": "2024-10-25T03:28:35.826652Z"}, {"completed_at": "2024-10-25T03:28:36.936952Z", "name": "execute", "started_at": "2024-10-25T03:28:35.840189Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_person", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.943091Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.945318Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "5 of 8 START sql table model omop.omop_procedure_occurrence .................... [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.946510Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_person"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_person, now model.my_dbt_trino_project.omop_procedure_occurrence)", "name": "ConnectionReused", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.949774Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.950979Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.959564Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.965302Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.982822Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.986789Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.989249Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:36.991135Z"}}
{"data": {"elapsed": 0.518021, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.518 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.508310Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.519482Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.521160Z"}}
{"data": {"elapsed": 0.1065071, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.107 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.629405Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.641228Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.642558Z"}}
{"data": {"elapsed": 0.1029714, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.103 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.747023Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.756968Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_procedure_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.759746Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.761566Z"}}
{"data": {"elapsed": 0.2083814, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.208 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.971613Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.978206Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_procedure_occurrence: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.980016Z"}}
{"data": {"description": "sql table model omop.omop_procedure_occurrence", "execution_time": 1.033067, "index": 5, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:37.981841", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "5 of 8 OK created sql table model omop.omop_procedure_occurrence ............... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.03s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.982991Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:37.981841", "node_name": "omop_procedure_occurrence", "node_path": "staging\\omop_procedure_occurrence.sql", "node_relation": {"alias": "omop_procedure_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_procedure_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:36.944563", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_032837_00057_u6rsp", "rows_affected": 1.0}, "execution_time": 1.033067, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:36.965302Z", "name": "compile", "started_at": "2024-10-25T03:28:36.952050Z"}, {"completed_at": "2024-10-25T03:28:37.977546Z", "name": "execute", "started_at": "2024-10-25T03:28:36.966315Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_procedure_occurrence", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.985555Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_provider", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.987231Z"}}
{"data": {"description": "sql table model omop.omop_provider", "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "6 of 8 START sql table model omop.omop_provider ................................ [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.988867Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "orig_conn_name": "model.my_dbt_trino_project.omop_procedure_occurrence"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_procedure_occurrence, now model.my_dbt_trino_project.omop_provider)", "name": "ConnectionReused", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.990523Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_provider", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:37.993866Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_provider\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.010671Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_provider", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.013498Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_provider\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.029525Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.038724Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.040429Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.041427Z"}}
{"data": {"elapsed": 0.6695224, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (6 rows) in 0.670 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.711803Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.723829Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider\" rename to \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.725725Z"}}
{"data": {"elapsed": 0.1172621, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.117 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.844091Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.855413Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\nalter table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_provider\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.856589Z"}}
{"data": {"elapsed": 0.0617681, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.062 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.920846Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.932193Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_provider\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.935114Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_provider__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:38.937427Z"}}
{"data": {"elapsed": 0.1863021, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.186 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.125519Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.131745Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_provider", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_provider: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.133247Z"}}
{"data": {"description": "sql table model omop.omop_provider", "execution_time": 1.1443305, "index": 6, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:39.134303", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "status": "CREATE TABLE (6 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "6 of 8 OK created sql table model omop.omop_provider ........................... [\u001b[32mCREATE TABLE (6 rows)\u001b[0m in 1.14s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.134303Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:39.134303", "node_name": "omop_provider", "node_path": "staging\\omop_provider.sql", "node_relation": {"alias": "omop_provider", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_provider\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:37.987231", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_provider"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_032838_00061_u6rsp", "rows_affected": 6.0}, "execution_time": 1.1443305, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:38.012990Z", "name": "compile", "started_at": "2024-10-25T03:28:37.996310Z"}, {"completed_at": "2024-10-25T03:28:39.131745Z", "name": "execute", "started_at": "2024-10-25T03:28:38.014627Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_provider", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.137797Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_specimen", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.141160Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "7 of 8 START sql table model omop.omop_specimen ................................ [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.143152Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "orig_conn_name": "model.my_dbt_trino_project.omop_provider"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_provider, now model.my_dbt_trino_project.omop_specimen)", "name": "ConnectionReused", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.145373Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_specimen", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.147114Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.160499Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_specimen", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.163469Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_specimen\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.179832Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.185146Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.187789Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.189171Z"}}
{"data": {"elapsed": 0.5007151, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.501 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.690151Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.701167Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen\" rename to \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.703313Z"}}
{"data": {"elapsed": 0.1053911, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.105 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.809669Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.823222Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\nalter table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_specimen\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.824825Z"}}
{"data": {"elapsed": 0.0977809, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.098 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.925047Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.935249Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_specimen\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.937268Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_specimen__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:39.938784Z"}}
{"data": {"elapsed": 0.1841951, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.184 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.124875Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.130738Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_specimen", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_specimen: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.131751Z"}}
{"data": {"description": "sql table model omop.omop_specimen", "execution_time": 0.9863777, "index": 7, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:40.131751", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "7 of 8 OK created sql table model omop.omop_specimen ........................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 0.99s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.134600Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:40.131751", "node_name": "omop_specimen", "node_path": "staging\\omop_specimen.sql", "node_relation": {"alias": "omop_specimen", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_specimen\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:39.141160", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_specimen"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_032839_00065_u6rsp", "rows_affected": 1.0}, "execution_time": 0.9863777, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:39.163469Z", "name": "compile", "started_at": "2024-10-25T03:28:39.149126Z"}, {"completed_at": "2024-10-25T03:28:40.130648Z", "name": "execute", "started_at": "2024-10-25T03:28:39.165144Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_specimen", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.136989Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeStart", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.137993Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "total": 8}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "8 of 8 START sql table model omop.omop_visit_occurrence ........................ [RUN]", "name": "LogStartLine", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.140583Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "orig_conn_name": "model.my_dbt_trino_project.omop_specimen"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly model.my_dbt_trino_project.omop_specimen, now model.my_dbt_trino_project.omop_visit_occurrence)", "name": "ConnectionReused", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.142046Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began compiling node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeCompiling", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.143170Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.157158Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Began executing node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeExecuting", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.159845Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.173848Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.180143Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.180143Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.183893Z"}}
{"data": {"elapsed": 0.5464595, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: CREATE TABLE (1 rows) in 0.546 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.730983Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.742064Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.743790Z"}}
{"data": {"elapsed": 0.1045333, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.105 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.848546Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.859995Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\nalter table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\" rename to \"iceberg\".\"omop\".\"omop_visit_occurrence\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.861994Z"}}
{"data": {"elapsed": 0.0985577, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.099 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.961353Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.969479Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "conn_type": "trino", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"model.my_dbt_trino_project.omop_visit_occurrence\"", "name": "ConnectionUsed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.969479Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n    drop table if exists \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_backup\"", "name": "SQLQuery", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:40.969479Z"}}
{"data": {"elapsed": 0.1799699, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: DROP TABLE in 0.180 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:41.154976Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: ROLLBACK", "name": "Rollback", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:41.162641Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On model.my_dbt_trino_project.omop_visit_occurrence: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:41.163640Z"}}
{"data": {"description": "sql table model omop.omop_visit_occurrence", "execution_time": 1.0227275, "index": 8, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:41.164774", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "status": "CREATE TABLE (1 rows)", "total": 8}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "8 of 8 OK created sql table model omop.omop_visit_occurrence ................... [\u001b[32mCREATE TABLE (1 rows)\u001b[0m in 1.02s]", "name": "LogModelResult", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:41.164774Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-25T03:28:41.164774", "node_name": "omop_visit_occurrence", "node_path": "staging\\omop_visit_occurrence.sql", "node_relation": {"alias": "omop_visit_occurrence", "database": "iceberg", "relation_name": "\"iceberg\".\"omop\".\"omop_visit_occurrence\"", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:40.137993", "node_status": "success", "resource_type": "model", "unique_id": "model.my_dbt_trino_project.omop_visit_occurrence"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_032840_00069_u6rsp", "rows_affected": 1.0}, "execution_time": 1.0227275, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:40.159845Z", "name": "compile", "started_at": "2024-10-25T03:28:40.145383Z"}, {"completed_at": "2024-10-25T03:28:41.161645Z", "name": "execute", "started_at": "2024-10-25T03:28:40.161544Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Finished running node model.my_dbt_trino_project.omop_visit_occurrence", "name": "NodeFinished", "pid": 59316, "thread": "Thread-1 (worker)", "ts": "2024-10-25T03:28:41.168850Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.169002Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.169002Z"}}
{"data": {"hook_type": "on-run-end", "num_hooks": 1}, "info": {"category": "", "code": "E046", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Running 1 on-run-end hook", "name": "HooksRunning", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.169002Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.278779Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n    select artifacts_model, metadata_hash from \"iceberg\".\"omop\".\"dbt_artifacts_hashes\"\n    order by metadata_hash", "name": "SQLQuery", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.279918Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.280931Z"}}
{"data": {"elapsed": 0.5967958, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: SUCCESS in 0.597 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.878675Z"}}
{"data": {"msg": "Elementary: Uploading dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Uploading dbt artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.898159Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_models] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:41.965910Z"}}
{"data": {"msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_models] Flattened 86 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.200025Z"}}
{"data": {"msg": "Elementary: [dbt_models] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_models] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.223570Z"}}
{"data": {"msg": "Elementary: [dbt_models] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_models] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.227550Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.233037Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.230826 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.230826 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.236232Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.265652 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.265652 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.239438Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_tests] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.250655Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_tests] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.254374Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_tests] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.257858Z"}}
{"data": {"msg": "Elementary: [dbt_tests] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_tests] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.260962Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.264583Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.001924 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.001924 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.268680Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.013928 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.013928 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.270905Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_sources] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.282670Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_sources] Flattened 15 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.335241Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_sources] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.341827Z"}}
{"data": {"msg": "Elementary: [dbt_sources] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_sources] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.346811Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.350611Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.050906 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.050906 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.353151Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.067541 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.067541 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.357304Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.370194Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_snapshots] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.374195Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_snapshots] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.378678Z"}}
{"data": {"msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_snapshots] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.381440Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.384090Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000998 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000998 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.387890Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.013896 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.013896 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.387890Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.401703Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_metrics] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.408480Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_metrics] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.415236Z"}}
{"data": {"msg": "Elementary: [dbt_metrics] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_metrics] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.418572Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.421850Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.426690Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.020147 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.020147 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.428447Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.442935Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_exposures] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.446752Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_exposures] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.451724Z"}}
{"data": {"msg": "Elementary: [dbt_exposures] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_exposures] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.454593Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.458737Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000698 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000698 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.459630Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.017610 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.017610 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.465387Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.477459Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_seeds] Flattened 0 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.481830Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_seeds] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.486549Z"}}
{"data": {"msg": "Elementary: [dbt_seeds] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_seeds] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.489008Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.492201Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.494887Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.013943 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.013943 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.496948Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_columns] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:42.510980Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_columns] Flattened 551 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.702043Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_columns] Comparing the artifacts state.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.708460Z"}}
{"data": {"msg": "Elementary: [dbt_columns] Artifacts did not change.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_columns] Artifacts did not change.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.714751Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.718668Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:01.188101 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:01.188101 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.722541Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:01.207479 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:01.207479 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.725166Z"}}
{"data": {"msg": "Elementary: Uploaded dbt artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Uploaded dbt artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.729421Z"}}
{"data": {"msg": "Elementary: Uploading run results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Uploading run results.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.741632Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattening the artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.741632Z"}}
{"data": {"msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [dbt_run_results] Flattened 8 artifacts.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.836513Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.911105Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "SQLQuery", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:43.911972Z"}}
{"data": {"elapsed": 0.1606363, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: SUCCESS in 0.161 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:44.074348Z"}}
{"data": {"msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Inserting 8 rows to table \"iceberg\".\"omop\".\"dbt_run_results\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:44.081683Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:44.447706Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:44.468373Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',2.6203746795654297,'2024-10-25T03:28:30.816035Z','2024-10-25T03:28:33.414715Z','2024-10-25T03:28:30.801195Z','2024-10-25T03:28:30.812716Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_032830_00041_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_032830_00041_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.2242867946624756,'2024-10-25T03:28:33.451504Z','2024-10-25T03:28:34.649767Z','2024-10-25T03:28:33.434067Z','2024-10-25T03:28:33.450160Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_032833_00045_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_032833_00045_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.1502759456634521,'2024-10-25T03:28:34.681764Z','2024-10-25T03:28:35.810211Z','2024-10-25T03:28:34.665787Z','2024-10-25T03:28:34.679947Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_032834_00049_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_032834_00049_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',1.1165809631347656,'2024-10-25T03:28:35.840189Z','2024-10-25T03:28:36.936952Z','2024-10-25T03:28:35.826652Z','2024-10-25T03:28:35.837329Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_032835_00053_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_032835_00053_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',1.033066987991333,'2024-10-25T03:28:36.966315Z','2024-10-25T03:28:37.977546Z','2024-10-25T03:28:36.952050Z','2024-10-25T03:28:36.965302Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_032837_00057_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_032837_00057_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',1.1443305015563965,'2024-10-25T03:28:38.014627Z','2024-10-25T03:28:39.131745Z','2024-10-25T03:28:37.996310Z','2024-10-25T03:28:38.012990Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_032838_00061_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_032838_00061_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',0.9863777160644531,'2024-10-25T03:28:39.165144Z','2024-10-25T03:28:40.130648Z','2024-10-25T03:28:39.149126Z','2024-10-25T03:28:39.163469Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_032839_00065_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_032839_00065_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',1.0227274894714355,'2024-10-25T03:28:40.161544Z','2024-10-25T03:28:41.161645Z','2024-10-25T03:28:40.145383Z','2024-10-25T03:28:40.159845Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_032840_00069_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_032840_00069_u6rsp\"}')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_run_results\"\n         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values\n    ('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_care_site','model.my_dbt_trino_project.omop_care_site','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_care_site','CREATE TABLE (3 rows)','success','model',2.6203746795654297,'2024-10-25T03:28:30.816035Z','2024-10-25T03:28:33.414715Z','2024-10-25T03:28:30.801195Z','2024-10-25T03:28:30.812716Z',3,False,'--OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"',NULL,'20241025_032830_00041_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (3 rows)\", \"rows_affected\": 3, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_care_site\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_care_site__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nselect \\n  json_extract_scalar(json_extract(identifier, ''$[0]''), ''$.value'') as \\\"care_site_id\\\",\\n  name as \\\"care_site_name\\\",\\n  json_extract_scalar(json_extract(type, ''$[0]''), ''$.coding[0].code'') as \\\"place_of_service_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_organization\\\"\\n    )\", \"query_id\": \"20241025_032830_00041_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_measurement','model.my_dbt_trino_project.omop_measurement','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_measurement','CREATE TABLE (5 rows)','success','model',1.2242867946624756,'2024-10-25T03:28:33.451504Z','2024-10-25T03:28:34.649767Z','2024-10-25T03:28:33.434067Z','2024-10-25T03:28:33.450160Z',5,False,'\n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  --substring(code from ''\"code\": \"([^\"]+)\"'') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_032833_00045_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_measurement\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_measurement__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nSELECT\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.low.value'') AS \\\"range_low\\\",\\n  json_extract_scalar(json_array_get(referenceRange, 0), ''$.high.value'') AS \\\"range_high\\\",\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_source_value\\\", --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  --substring(code from ''\\\"code\\\": \\\"([^\\\"]+)\\\"'') as \\\"measurement_concept_id\\\",  --\\u4e0d\\u77e5\\u9053\\u53d6\\u54ea\\u500b \\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_032833_00045_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_observation','model.my_dbt_trino_project.omop_observation','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_observation','CREATE TABLE (5 rows)','success','model',1.1502759456634521,'2024-10-25T03:28:34.681764Z','2024-10-25T03:28:35.810211Z','2024-10-25T03:28:34.665787Z','2024-10-25T03:28:34.679947Z',5,False,'--OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, ''$.reference'') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"',NULL,'20241025_032834_00049_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (5 rows)\", \"rows_affected\": 5, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_observation\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_observation__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      --OK\\n\\n\\nSELECT\\n\\n  substring(resource_id, -36) as \\\"observation_id\\\",  -- \\u91ab\\u7642\\u89c0\\u5bdf\\u7d00\\u9304id\\n  json_extract_scalar(json_extract(valueQuantity, ''$.unit''), ''$'') AS \\\"unit_concept_id\\\",  --\\u89c0\\u5bdf\\u7d50\\u679c\\u7684\\u55ae\\u4f4d\\uff08unit\\uff09\\u61c9\\u63db\\u6210\\u4ee3\\u865fid\\n  json_extract_scalar(json_array_get(performer, 0), ''$.reference'') AS \\\"provider_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005id\\n  resource_id AS \\\"visit_occurrence_id\\\",--\\u5c31\\u8a3aid\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"person_id\\\",\\n  json_extract_scalar(json_array_get(json_extract(code, ''$.coding''), 0), ''$.code'') AS \\\"observation_concept_id\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_date\\\",\\n  \\\"effectiveDateTime\\\" as \\\"observation_datetime\\\",\\n  json_extract_scalar(json_extract(valueQuantity, ''$.value''), ''$'') AS \\\"value_as_number\\\",--\\u91cf\\u6e2c\\u7d50\\u679c\\n  valueString AS \\\"value_as_string\\\",--\\u89c0\\u5bdf\\u7d50\\u679c\\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, ''$.coding''), 0), ''$.code'') AS \\\"value_as_concept_id\\\",\\n  current_timestamp as create_time\\n\\nFROM \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_observation\\\"\\n    )\", \"query_id\": \"20241025_032834_00049_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_person','model.my_dbt_trino_project.omop_person','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_person','CREATE TABLE (1 rows)','success','model',1.1165809631347656,'2024-10-25T03:28:35.840189Z','2024-10-25T03:28:36.936952Z','2024-10-25T03:28:35.826652Z','2024-10-25T03:28:35.837329Z',1,False,'\n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = ''male'' THEN 8507\n    WHEN gender = ''female'' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", ''%Y-%m-%d'')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"',NULL,'20241025_032835_00053_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_person\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_person__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nSELECT\\n  id as person_id,\\n  CASE\\n    WHEN gender = ''male'' THEN 8507\\n    WHEN gender = ''female'' THEN 8532\\n    ELSE 8551\\n  END as gender_concept_id,\\n  \\n  EXTRACT(YEAR FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS year_of_birth,\\n  EXTRACT(MONTH FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS month_of_birth,\\n  EXTRACT(DAY FROM date_parse(\\\"birthDate\\\", ''%Y-%m-%d'')) AS day_of_birth,\\n  \\\"birthDate\\\" as birth_datetime,\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') AS person_source_value,\\n  gender as gender_source_value,\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_patient\\\"\\n    )\", \"query_id\": \"20241025_032835_00053_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_procedure_occurrence','model.my_dbt_trino_project.omop_procedure_occurrence','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_procedure_occurrence','CREATE TABLE (1 rows)','success','model',1.033066987991333,'2024-10-25T03:28:36.966315Z','2024-10-25T03:28:37.977546Z','2024-10-25T03:28:36.952050Z','2024-10-25T03:28:36.965302Z',1,False,'\n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, ''$.reference'') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"',NULL,'20241025_032837_00057_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_procedure_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_procedure_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  resource_id as \\\"procedure_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  json_extract_scalar(subject, ''$.reference'') AS \\\"visit_occurrence_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_procedure\\\"\\n    )\", \"query_id\": \"20241025_032837_00057_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_provider','model.my_dbt_trino_project.omop_provider','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_provider','CREATE TABLE (6 rows)','success','model',1.1443305015563965,'2024-10-25T03:28:38.014627Z','2024-10-25T03:28:39.131745Z','2024-10-25T03:28:37.996310Z','2024-10-25T03:28:38.012990Z',6,False,'\n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  ''qualification'' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, ''\"code\":\\s*\"([^\"]+)\"'', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  ''location'' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  ''birthDate'' as \"year_of_birth\", --\u7f3a\u6f0f\n  ''gender'' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"',NULL,'20241025_032838_00061_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (6 rows)\", \"rows_affected\": 6, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_provider\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_provider__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n  \\nselect \\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_id\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005id\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"provider_name\\\",--\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005name\\u7f3a\\u6f0f\\n  json_extract_scalar(json_array_get(identifier, 0), ''$.value'') as \\\"npi\\\",--\\u5168\\u570b\\u91ab\\u7642\\u670d\\u52d9\\u63d0\\u4f9b\\u8005\\u8b58\\u5225\\u78bc\\u3002\\u552f\\u4e0010\\u4f4d\\u6578\\u5b57\\u8b58\\u5225\\u78bc\\n  ''qualification'' as \\\"dea\\\", --\\u7f3a\\u6f0f\\uff0c\\u6709\\u6b0a\\u958b\\u5177\\u53d7\\u7ba1\\u5236\\u85e5\\u7269\\u7684\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\u3002\\n  regexp_extract(identifier, ''\\\"code\\\":\\\\s*\\\"([^\\\"]+)\\\"'', 1) as \\\"specialty_concept_id\\\",--\\u91ab\\u7642\\u63d0\\u4f9b\\u8005\\u7684\\u5c08\\u696d(\\u5167\\u5916\\u79d1\\u7b49\\u5c0d\\u61c9\\u4e00\\u500bid)\\n  ''location'' as \\\"care_site_id\\\", --\\u7f3a\\u6f0f \\u91ab\\u7642\\u6a5f\\u69cbCare Site\\u552f\\u4e00\\u8b58\\u5225\\u78bc\\n  ''birthDate'' as \\\"year_of_birth\\\", --\\u7f3a\\u6f0f\\n  ''gender'' as \\\"gender_concept_id\\\", --\\u7f3a\\u6f0f\\n  current_timestamp as create_time\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_practitioner\\\"\\n    )\", \"query_id\": \"20241025_032838_00061_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_specimen','model.my_dbt_trino_project.omop_specimen','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_specimen','CREATE TABLE (1 rows)','success','model',0.9863777160644531,'2024-10-25T03:28:39.165144Z','2024-10-25T03:28:40.130648Z','2024-10-25T03:28:39.149126Z','2024-10-25T03:28:39.163469Z',1,False,'\n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, ''$.coding[0].code'') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  ''quantity'' as \"quantity\", --\u7f3a\u6f0f quantity\n  ''unit'' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  ''text'' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"',NULL,'20241025_032839_00065_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_specimen\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_specimen__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\nselect \\n  id as \\\"specimen_id\\\",--\\u6aa2\\u9ad4\\u8b58\\u5225\\u78bc\\n  subject as \\\"person_id\\\", --\\u503c\\u540d\\u8207\\u5b98\\u7db2\\u4e0d\\u540c\\n  json_extract_scalar(type, ''$.coding[0].code'') as \\\"specimen_concept_id\\\",--\\u6aa2\\u9ad4\\u985e\\u578bid\\n  receivedTime as \\\"specimen_date\\\", --\\u91cd\\u8907\\u6642\\u9593\\n  receivedTime as \\\"specimen_datetime\\\" , --\\u91cd\\u8907\\u6642\\u9593\\n  ''quantity'' as \\\"quantity\\\", --\\u7f3a\\u6f0f quantity\\n  ''unit'' as \\\"unit_concept_id\\\", --\\u7f3a\\u6f0f quantity.unit\\n  ''text'' as \\\"anatomic_site_concept_id\\\", --\\u4f4d\\u7f6e\\u8207\\u5b98\\u7db2\\u4e0d\\u540c \\n  current_timestamp as create_time\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_specimen\\\"\\n    )\", \"query_id\": \"20241025_032839_00065_u6rsp\"}'),('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd.model.my_dbt_trino_project.omop_visit_occurrence','model.my_dbt_trino_project.omop_visit_occurrence','77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd','2024-10-25 03:28:43',current_timestamp(6),'omop_visit_occurrence','CREATE TABLE (1 rows)','success','model',1.0227274894714355,'2024-10-25T03:28:40.161544Z','2024-10-25T03:28:41.161645Z','2024-10-25T03:28:40.145383Z','2024-10-25T03:28:40.159845Z',1,False,'\n\n\nSELECT\n  ''resource_id'' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \"care_site_id\", --\u7f3a\u6f0f\n--''unknown'' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--''unknown'' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--''unknown'' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--''unknown'' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--''unknown'' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--''partOf'' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--''subject.identifier'' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> ''start'' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> ''start'' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--''unknown'' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, ''$.code'') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--''performer.identifier'' as \"provider_id\"\n  ''identifier'' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"',NULL,'20241025_032840_00069_u6rsp','Thread-1 (worker)','table','{\"_message\": \"CREATE TABLE (1 rows)\", \"rows_affected\": 1, \"query\": \"/* {\\\"app\\\": \\\"dbt\\\", \\\"dbt_version\\\": \\\"1.8.8\\\", \\\"profile_name\\\": \\\"my_dbt_trino_project\\\", \\\"target_name\\\": \\\"dev\\\", \\\"node_id\\\": \\\"model.my_dbt_trino_project.omop_visit_occurrence\\\"} */\\n\\n  \\n    \\n\\n    create table \\\"iceberg\\\".\\\"omop\\\".\\\"omop_visit_occurrence__dbt_tmp\\\"\\n      \\n      \\n    as (\\n      \\n\\n\\nSELECT\\n  ''resource_id'' as \\\"visit_occurence_id\\\", --\\u53d6value\\n  serviceType as \\\"visit_source_value\\\", --\\u8a2a\\u8996\\u539f\\u59cb\\u6578\\u64da\\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(location::jsonb) -> ''location'' ->> ''display''  as \\\"care_site_id\\\", --\\u7f3a\\u6f0f\\n--''unknown'' as \\\"admitting_from_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90id\\n--''unknown'' as \\\"admitting_from_source_value\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684 \\u539f\\u59cb\\u63cf\\u8ff0\\u503c\\n--''unknown'' as \\\"admitting_from_source_concept_id\\\", --\\u5165\\u9662\\u4f86\\u6e90\\u7684\\u6a19\\u6e96\\u5316\\u6982\\u5ff5\\u7684\\u9032\\u4e00\\u6b65\\u5206\\u985e\\n--''unknown'' as \\\"discharge_to_concept_id\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u8b58\\u5225\\u78bc\\n--''unknown'' as \\\"discharge_to_source_value\\\", --\\u51fa\\u9662\\u53bb\\u5411\\u63cf\\u8ff0\\n--''partOf'' as \\\"preceding_visit_occurence\\\", --\\u524d\\u4e00\\u6b21\\u8a2a\\u8996\\u7d00\\u9304\\n--''subject.identifier'' as \\\"person_id\\\",\\n-- jsonb_array_elements(subject::jsonb) ->> ''identifier'' as \\\"person_id\\\", --\\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''id'' as \\\"visit_concept_id\\\", -- \\u7f3a\\u6f0f\\n--jsonb_array_elements(type::jsonb) ->> ''text'' as \\\"visit_source_value2\\\", -- \\u7f3a\\u6f0f\\n\\n--period::jsonb ->> ''start'' as \\\"visit_start_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_start_datetime\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_date\\\", -- \\u7f3a\\u6f0f\\n--period::jsonb ->> ''start'' as \\\"visit_end_datetime\\\", -- \\u7f3a\\u6f0f\\n--''unknown'' as \\\"visit_type_concept_id\\\", --\\u4e0d\\u660e  \\u8a2a\\u8996\\u985e\\u578b\\u4ee3\\u78bc\\n  json_extract_scalar(class, ''$.code'') as \\\"visit_type_source_value\\\", --\\u8a2a\\u8996\\u985e\\u578b\\u539f\\u59cb \\u6025\\u8a3a \\u4f4f\\u9662 \\u9580\\u8a3a\\n--''performer.identifier'' as \\\"provider_id\\\"\\n  ''identifier'' as \\\"provider_id\\\", -- \\u7f3a\\u6f0f performer\\n  current_timestamp as create_time\\n\\n\\n\\nFROM \\n  \\\"iceberg\\\".\\\"omop\\\".\\\"base_table_encounter\\\"\\n    )\", \"query_id\": \"20241025_032840_00069_u6rsp\"}')", "name": "SQLQuery", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:44.472459Z"}}
{"data": {"elapsed": 0.5857561, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (8 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: INSERT (8 rows) in 0.586 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.063268Z"}}
{"data": {"msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.068497Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.088822 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.088822 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.073866Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.193694 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.193694 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.076290Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.002306 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.002306 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.078038Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.308258 (8 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.308258 (8 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.081634Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.330422 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.330422 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.083529Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.613949 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.613949 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.085535Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:01.181030 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:01.181030 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.088056Z"}}
{"data": {"msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.326865 (1 runs)", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.326865 (1 runs)", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.089816Z"}}
{"data": {"msg": "Elementary: Uploaded run results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Uploaded run results successfully.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.093636Z"}}
{"data": {"msg": "Elementary: Handling test results.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Handling test results.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.113380Z"}}
{"data": {"msg": "Elementary: Handled test results successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Handled test results successfully.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.170215Z"}}
{"data": {"msg": "Elementary: Uploading dbt invocation.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Uploading dbt invocation.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.206882Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.354243Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    describe \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "SQLQuery", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.355540Z"}}
{"data": {"elapsed": 0.1488057, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: SUCCESS in 0.149 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.505575Z"}}
{"data": {"msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Inserting 1 rows to table \"iceberg\".\"omop\".\"dbt_invocations\"", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.511098Z"}}
{"data": {"msg": "Elementary: [1/1] Running insert query.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: [1/1] Running insert query.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.560120Z"}}
{"data": {"conn_name": "master", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Using trino connection \"master\"", "name": "ConnectionUsed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.568088Z"}}
{"data": {"conn_name": "master", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd',NULL,NULL,NULL,'2024-10-25 03:28:27','2024-10-25 03:28:45','2024-10-25 03:28:45',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_specimen\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_visit_occurrence\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"connection_name\": \"master\"} */\n\n    \n       insert into \"iceberg\".\"omop\".\"dbt_invocations\"\n         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values\n    ('77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd',NULL,NULL,NULL,'2024-10-25 03:28:27','2024-10-25 03:28:45','2024-10-25 03:28:45',current_timestamp(6),'build','1.8.8','0.16.1',False,'{}','{}','dev','iceberg','omop','my_dbt_trino_project',1,'[\"my_dbt_trino_project.staging.omop_measurement\", \"my_dbt_trino_project.staging.omop_provider\", \"my_dbt_trino_project.staging.omop_person\", \"my_dbt_trino_project.staging.omop_care_site\", \"my_dbt_trino_project.staging.omop_specimen\", \"my_dbt_trino_project.staging.omop_observation\", \"my_dbt_trino_project.staging.omop_procedure_occurrence\", \"my_dbt_trino_project.staging.omop_visit_occurrence\"]',NULL,NULL,'my_dbt_trino_project',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'')", "name": "SQLQuery", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:45.568088Z"}}
{"data": {"elapsed": 0.5172285, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "status": "INSERT (1 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "SQL status: INSERT (1 rows) in 0.517 seconds", "name": "SQLQueryStatus", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.091525Z"}}
{"data": {"msg": "Elementary: Uploaded dbt invocation successfully.", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Elementary: Uploaded dbt invocation successfully.", "name": "JinjaLogDebug", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.098090Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Writing injected SQL for node \"operation.elementary.elementary-on-run-end-0\"", "name": "WritingInjectedSQLForNode", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.115868Z"}}
{"data": {"index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "started", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "total": 1}, "info": {"category": "", "code": "Q032", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]", "name": "LogHookStartLine", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.118340Z"}}
{"data": {"execution_time": 0.0, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2024-10-25T03:28:46.120322", "node_name": "elementary-on-run-end-0", "node_path": "hooks\\elementary-on-run-end-0.sql", "node_relation": {"alias": "elementary-on-run-end-0", "database": "iceberg", "relation_name": "", "schema": "omop"}, "node_started_at": "2024-10-25T03:28:41.175165", "node_status": "success", "resource_type": "operation", "unique_id": "operation.elementary.elementary-on-run-end-0"}, "statement": "elementary.on-run-end.0", "status": "OK", "total": 1}, "info": {"category": "", "code": "Q033", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "1 of 1 OK hook: elementary.on-run-end.0 ........................................ [\u001b[32mOK\u001b[0m in 0.00s]", "name": "LogHookEndLine", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.120322Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.122328Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.123547Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.125102Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Connection 'list_iceberg' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.125267Z"}}
{"data": {"conn_name": "list_iceberg_omop"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Connection 'list_iceberg_omop' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.126638Z"}}
{"data": {"conn_name": "model.my_dbt_trino_project.omop_visit_occurrence"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Connection 'model.my_dbt_trino_project.omop_visit_occurrence' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.127948Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.129436Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 16.49 seconds", "execution_time": 16.489857, "stat_line": "8 table models, 2 project hooks"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Finished running 8 table models, 2 project hooks in 0 hours 0 minutes and 16.49 seconds (16.49s).", "name": "FinishedRunningStats", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.130620Z"}}
{"data": {"elapsed_time": 16.489857, "generated_at": "2024-10-25T03:28:46Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (3 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_care_site\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_care_site__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nselect \n  json_extract_scalar(json_extract(identifier, '$[0]'), '$.value') as \"care_site_id\",\n  name as \"care_site_name\",\n  json_extract_scalar(json_extract(type, '$[0]'), '$.coding[0].code') as \"place_of_service_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_organization\"\n    )", "query_id": "20241025_032830_00041_u6rsp", "rows_affected": 3.0}, "execution_time": 2.6203747, "message": "CREATE TABLE (3 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:30.812716Z", "name": "compile", "started_at": "2024-10-25T03:28:30.801195Z"}, {"completed_at": "2024-10-25T03:28:33.414715Z", "name": "execute", "started_at": "2024-10-25T03:28:30.816035Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_measurement\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_measurement__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.low.value') AS \"range_low\",\n  json_extract_scalar(json_array_get(referenceRange, 0), '$.high.value') AS \"range_high\",\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_source_value\", --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  --substring(code from '\"code\": \"([^\"]+)\"') as \"measurement_concept_id\",  --\u4e0d\u77e5\u9053\u53d6\u54ea\u500b \n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_032833_00045_u6rsp", "rows_affected": 5.0}, "execution_time": 1.2242868, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:33.450160Z", "name": "compile", "started_at": "2024-10-25T03:28:33.434067Z"}, {"completed_at": "2024-10-25T03:28:34.649767Z", "name": "execute", "started_at": "2024-10-25T03:28:33.451504Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (5 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_observation\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_observation__dbt_tmp\"\n      \n      \n    as (\n      --OK\n\n\nSELECT\n\n  substring(resource_id, -36) as \"observation_id\",  -- \u91ab\u7642\u89c0\u5bdf\u7d00\u9304id\n  json_extract_scalar(json_extract(valueQuantity, '$.unit'), '$') AS \"unit_concept_id\",  --\u89c0\u5bdf\u7d50\u679c\u7684\u55ae\u4f4d\uff08unit\uff09\u61c9\u63db\u6210\u4ee3\u865fid\n  json_extract_scalar(json_array_get(performer, 0), '$.reference') AS \"provider_id\",--\u91ab\u7642\u63d0\u4f9b\u8005id\n  resource_id AS \"visit_occurrence_id\",--\u5c31\u8a3aid\n  json_extract_scalar(subject, '$.reference') AS \"person_id\",\n  json_extract_scalar(json_array_get(json_extract(code, '$.coding'), 0), '$.code') AS \"observation_concept_id\",\n  \"effectiveDateTime\" as \"observation_date\",\n  \"effectiveDateTime\" as \"observation_datetime\",\n  json_extract_scalar(json_extract(valueQuantity, '$.value'), '$') AS \"value_as_number\",--\u91cf\u6e2c\u7d50\u679c\n  valueString AS \"value_as_string\",--\u89c0\u5bdf\u7d50\u679c\n  json_extract_scalar(json_array_get(json_extract(valuecodeableconcept, '$.coding'), 0), '$.code') AS \"value_as_concept_id\",\n  current_timestamp as create_time\n\nFROM \"iceberg\".\"omop\".\"base_table_observation\"\n    )", "query_id": "20241025_032834_00049_u6rsp", "rows_affected": 5.0}, "execution_time": 1.150276, "message": "CREATE TABLE (5 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:34.679947Z", "name": "compile", "started_at": "2024-10-25T03:28:34.665787Z"}, {"completed_at": "2024-10-25T03:28:35.810211Z", "name": "execute", "started_at": "2024-10-25T03:28:34.681764Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_person\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_person__dbt_tmp\"\n      \n      \n    as (\n      \n  \nSELECT\n  id as person_id,\n  CASE\n    WHEN gender = 'male' THEN 8507\n    WHEN gender = 'female' THEN 8532\n    ELSE 8551\n  END as gender_concept_id,\n  \n  EXTRACT(YEAR FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS year_of_birth,\n  EXTRACT(MONTH FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS month_of_birth,\n  EXTRACT(DAY FROM date_parse(\"birthDate\", '%Y-%m-%d')) AS day_of_birth,\n  \"birthDate\" as birth_datetime,\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') AS person_source_value,\n  gender as gender_source_value,\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_patient\"\n    )", "query_id": "20241025_032835_00053_u6rsp", "rows_affected": 1.0}, "execution_time": 1.116581, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:35.837329Z", "name": "compile", "started_at": "2024-10-25T03:28:35.826652Z"}, {"completed_at": "2024-10-25T03:28:36.936952Z", "name": "execute", "started_at": "2024-10-25T03:28:35.840189Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_procedure_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_procedure_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  resource_id as \"procedure_occurrence_id\", --\u7f3a\u6f0f\n  json_extract_scalar(subject, '$.reference') AS \"visit_occurrence_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_procedure\"\n    )", "query_id": "20241025_032837_00057_u6rsp", "rows_affected": 1.0}, "execution_time": 1.033067, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:36.965302Z", "name": "compile", "started_at": "2024-10-25T03:28:36.952050Z"}, {"completed_at": "2024-10-25T03:28:37.977546Z", "name": "execute", "started_at": "2024-10-25T03:28:36.966315Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (6 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_provider\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_provider__dbt_tmp\"\n      \n      \n    as (\n      \n  \nselect \n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_id\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005id\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"provider_name\",--\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005name\u7f3a\u6f0f\n  json_extract_scalar(json_array_get(identifier, 0), '$.value') as \"npi\",--\u5168\u570b\u91ab\u7642\u670d\u52d9\u63d0\u4f9b\u8005\u8b58\u5225\u78bc\u3002\u552f\u4e0010\u4f4d\u6578\u5b57\u8b58\u5225\u78bc\n  'qualification' as \"dea\", --\u7f3a\u6f0f\uff0c\u6709\u6b0a\u958b\u5177\u53d7\u7ba1\u5236\u85e5\u7269\u7684\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u552f\u4e00\u8b58\u5225\u78bc\u3002\n  regexp_extract(identifier, '\"code\":\\s*\"([^\"]+)\"', 1) as \"specialty_concept_id\",--\u91ab\u7642\u63d0\u4f9b\u8005\u7684\u5c08\u696d(\u5167\u5916\u79d1\u7b49\u5c0d\u61c9\u4e00\u500bid)\n  'location' as \"care_site_id\", --\u7f3a\u6f0f \u91ab\u7642\u6a5f\u69cbCare Site\u552f\u4e00\u8b58\u5225\u78bc\n  'birthDate' as \"year_of_birth\", --\u7f3a\u6f0f\n  'gender' as \"gender_concept_id\", --\u7f3a\u6f0f\n  current_timestamp as create_time\nFROM \n  \"iceberg\".\"omop\".\"base_table_practitioner\"\n    )", "query_id": "20241025_032838_00061_u6rsp", "rows_affected": 6.0}, "execution_time": 1.1443305, "message": "CREATE TABLE (6 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:38.012990Z", "name": "compile", "started_at": "2024-10-25T03:28:37.996310Z"}, {"completed_at": "2024-10-25T03:28:39.131745Z", "name": "execute", "started_at": "2024-10-25T03:28:38.014627Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_specimen\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_specimen__dbt_tmp\"\n      \n      \n    as (\n      \n\nselect \n  id as \"specimen_id\",--\u6aa2\u9ad4\u8b58\u5225\u78bc\n  subject as \"person_id\", --\u503c\u540d\u8207\u5b98\u7db2\u4e0d\u540c\n  json_extract_scalar(type, '$.coding[0].code') as \"specimen_concept_id\",--\u6aa2\u9ad4\u985e\u578bid\n  receivedTime as \"specimen_date\", --\u91cd\u8907\u6642\u9593\n  receivedTime as \"specimen_datetime\" , --\u91cd\u8907\u6642\u9593\n  'quantity' as \"quantity\", --\u7f3a\u6f0f quantity\n  'unit' as \"unit_concept_id\", --\u7f3a\u6f0f quantity.unit\n  'text' as \"anatomic_site_concept_id\", --\u4f4d\u7f6e\u8207\u5b98\u7db2\u4e0d\u540c \n  current_timestamp as create_time\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_specimen\"\n    )", "query_id": "20241025_032839_00065_u6rsp", "rows_affected": 1.0}, "execution_time": 0.9863777, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:39.163469Z", "name": "compile", "started_at": "2024-10-25T03:28:39.149126Z"}, {"completed_at": "2024-10-25T03:28:40.130648Z", "name": "execute", "started_at": "2024-10-25T03:28:39.165144Z"}]}, {"adapter_response": {"_message": "CREATE TABLE (1 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.8\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.omop_visit_occurrence\"} */\n\n  \n    \n\n    create table \"iceberg\".\"omop\".\"omop_visit_occurrence__dbt_tmp\"\n      \n      \n    as (\n      \n\n\nSELECT\n  'resource_id' as \"visit_occurence_id\", --\u53d6value\n  serviceType as \"visit_source_value\", --\u8a2a\u8996\u539f\u59cb\u6578\u64da\n-- jsonb_array_elements(location::jsonb) -> location -> managingOrganization ->> identifier as \"care_site_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(location::jsonb) -> 'location' ->> 'display'  as \"care_site_id\", --\u7f3a\u6f0f\n--'unknown' as \"admitting_from_concept_id\", --\u5165\u9662\u4f86\u6e90id\n--'unknown' as \"admitting_from_source_value\", --\u5165\u9662\u4f86\u6e90\u7684 \u539f\u59cb\u63cf\u8ff0\u503c\n--'unknown' as \"admitting_from_source_concept_id\", --\u5165\u9662\u4f86\u6e90\u7684\u6a19\u6e96\u5316\u6982\u5ff5\u7684\u9032\u4e00\u6b65\u5206\u985e\n--'unknown' as \"discharge_to_concept_id\", --\u51fa\u9662\u53bb\u5411\u8b58\u5225\u78bc\n--'unknown' as \"discharge_to_source_value\", --\u51fa\u9662\u53bb\u5411\u63cf\u8ff0\n--'partOf' as \"preceding_visit_occurence\", --\u524d\u4e00\u6b21\u8a2a\u8996\u7d00\u9304\n--'subject.identifier' as \"person_id\",\n-- jsonb_array_elements(subject::jsonb) ->> 'identifier' as \"person_id\", --\u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'id' as \"visit_concept_id\", -- \u7f3a\u6f0f\n--jsonb_array_elements(type::jsonb) ->> 'text' as \"visit_source_value2\", -- \u7f3a\u6f0f\n\n--period::jsonb ->> 'start' as \"visit_start_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_start_datetime\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_date\", -- \u7f3a\u6f0f\n--period::jsonb ->> 'start' as \"visit_end_datetime\", -- \u7f3a\u6f0f\n--'unknown' as \"visit_type_concept_id\", --\u4e0d\u660e  \u8a2a\u8996\u985e\u578b\u4ee3\u78bc\n  json_extract_scalar(class, '$.code') as \"visit_type_source_value\", --\u8a2a\u8996\u985e\u578b\u539f\u59cb \u6025\u8a3a \u4f4f\u9662 \u9580\u8a3a\n--'performer.identifier' as \"provider_id\"\n  'identifier' as \"provider_id\", -- \u7f3a\u6f0f performer\n  current_timestamp as create_time\n\n\n\nFROM \n  \"iceberg\".\"omop\".\"base_table_encounter\"\n    )", "query_id": "20241025_032840_00069_u6rsp", "rows_affected": 1.0}, "execution_time": 1.0227275, "message": "CREATE TABLE (1 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-25T03:28:40.159845Z", "name": "compile", "started_at": "2024-10-25T03:28:40.145383Z"}, {"completed_at": "2024-10-25T03:28:41.161645Z", "name": "execute", "started_at": "2024-10-25T03:28:40.161544Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.135510Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.462568Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.463448Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "", "name": "Formatting", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.465188Z"}}
{"data": {"stats": {"error": 0, "pass": 8, "skip": 0, "total": 8, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "info", "msg": "Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8", "name": "StatsLine", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.465839Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-10-25T03:28:46.468233Z", "elapsed": 18.945644, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Command `dbt build` succeeded at 11:28:46.468233 after 18.95 seconds", "name": "CommandCompleted", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.468233Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "77ae36c7-7f37-4a3a-a5ec-5e1657ad07fd", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 59316, "thread": "MainThread", "ts": "2024-10-25T03:28:46.470060Z"}}
