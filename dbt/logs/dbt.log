[0m13:25:20.997705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B407D9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B41492350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B416C0A10>]}


============================== 13:25:21.000362 | 4d4330a7-d186-4d6b-b374-be12e68c5d2b ==============================
[0m13:25:21.000362 [info ] [MainThread]: Running with dbt=1.8.5
[0m13:25:21.001372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:21.107582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d4330a7-d186-4d6b-b374-be12e68c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B41716D50>]}
[0m13:25:21.153656 [debug] [MainThread]: Set downloads directory='C:\Users\ASUS\AppData\Local\Temp\dbt-downloads-zuuch3tm'
[0m13:25:21.155012 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:25:21.262230 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:25:21.263231 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:25:21.311493 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:25:21.314629 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/starburstdata/trino_utils.json
[0m13:25:21.715566 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/starburstdata/trino_utils.json 200
[0m13:25:21.716568 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:25:22.247843 [info ] [MainThread]: Installed from version 1.1.1
[0m13:25:22.248378 [info ] [MainThread]: Updated version available: 1.2.0
[0m13:25:22.248918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4d4330a7-d186-4d6b-b374-be12e68c5d2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B4177AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B4176D1D0>]}
[0m13:25:22.250958 [info ] [MainThread]: Installing starburstdata/trino_utils
[0m13:25:22.708038 [info ] [MainThread]: Installed from version 0.6.0
[0m13:25:22.708038 [info ] [MainThread]: Up to date!
[0m13:25:22.708038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4d4330a7-d186-4d6b-b374-be12e68c5d2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B4174BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B414923D0>]}
[0m13:25:22.711080 [info ] [MainThread]: 
[0m13:25:22.711080 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:25:22.713064 [debug] [MainThread]: Command `dbt deps` succeeded at 13:25:22.713064 after 1.82 seconds
[0m13:25:22.713064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3CA89B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B416F6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3C9EBC10>]}
[0m13:25:22.714063 [debug] [MainThread]: Flushing usage events
[0m13:25:29.043165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219FFE89550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021981DE0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021981DE2B90>]}


============================== 13:25:29.045552 | 05b590d5-72f3-419f-926c-b85857027821 ==============================
[0m13:25:29.045552 [info ] [MainThread]: Running with dbt=1.8.5
[0m13:25:29.046560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:29.058865 [info ] [MainThread]: dbt version: 1.8.5
[0m13:25:29.058865 [info ] [MainThread]: python version: 3.11.5
[0m13:25:29.059982 [info ] [MainThread]: python path: C:\Users\ASUS\Desktop\work\datalake\dbt\dbt-venv\Scripts\python.exe
[0m13:25:29.060989 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m13:25:29.107303 [info ] [MainThread]: Using profiles dir at C:\Users\ASUS\Desktop\work\datalake\dbt
[0m13:25:29.108308 [info ] [MainThread]: Using profiles.yml file at C:\Users\ASUS\Desktop\work\datalake\dbt\profiles.yml
[0m13:25:29.108308 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ASUS\Desktop\work\datalake\dbt\dbt_project.yml
[0m13:25:29.109303 [info ] [MainThread]: adapter type: trino
[0m13:25:29.109303 [info ] [MainThread]: adapter version: 1.8.1
[0m13:25:29.178618 [info ] [MainThread]: Configuration:
[0m13:25:29.178618 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:25:29.180144 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:25:29.181179 [info ] [MainThread]: Required dependencies:
[0m13:25:29.182596 [debug] [MainThread]: Executing "git --help"
[0m13:25:29.263715 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:25:29.263715 [debug] [MainThread]: STDERR: "b''"
[0m13:25:29.264722 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:25:29.264722 [info ] [MainThread]: Connection:
[0m13:25:29.265729 [info ] [MainThread]:   host: localhost
[0m13:25:29.265729 [info ] [MainThread]:   port: 8080
[0m13:25:29.265729 [info ] [MainThread]:   user: minio
[0m13:25:29.266731 [info ] [MainThread]:   database: iceberg
[0m13:25:29.266731 [info ] [MainThread]:   schema: analytics
[0m13:25:29.267728 [info ] [MainThread]:   cert: None
[0m13:25:29.267728 [info ] [MainThread]:   prepared_statements_enabled: True
[0m13:25:29.268727 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m13:25:29.268727 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m13:25:29.315844 [debug] [MainThread]: Using trino connection "debug"
[0m13:25:29.316367 [debug] [MainThread]: On debug: select 1 as id
[0m13:25:29.316367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:30.006314 [debug] [MainThread]: SQL status: SUCCESS in 0.689 seconds
[0m13:25:30.007911 [debug] [MainThread]: On debug: Close
[0m13:25:30.008450 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:25:30.009523 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:25:30.010586 [debug] [MainThread]: Command `dbt debug` succeeded at 13:25:30.010586 after 1.07 seconds
[0m13:25:30.011119 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:25:30.011119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219FD0F9B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219821FAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219FF096290>]}
[0m13:25:30.012160 [debug] [MainThread]: Flushing usage events
[0m13:25:45.079754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39AE2EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39AE2DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39AE2E950>]}


============================== 13:25:45.083278 | 24b17de4-a2c0-430c-87cc-254fb1861311 ==============================
[0m13:25:45.083278 [info ] [MainThread]: Running with dbt=1.8.5
[0m13:25:45.084278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models source', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:25:45.214238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39AEBA050>]}
[0m13:25:45.252512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F398276D90>]}
[0m13:25:45.253019 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m13:25:45.266029 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m13:25:45.330588 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:25:45.331587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F399C43BD0>]}
[0m13:25:46.234813 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:25:46.234813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B319790>]}
[0m13:25:46.243880 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'auth_events' in the 'models' section of file 'models\schema.yml'
[0m13:25:46.392279 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_trino_project.unique_auth_events_sessionId.d4e6c5c31c' (models\schema.yml) depends on a node named 'auth_events' in package '' which was not found
[0m13:25:46.392807 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_trino_project.accepted_values_auth_events_level__free__paid.d9038ceb20' (models\schema.yml) depends on a node named 'auth_events' in package '' which was not found
[0m13:25:46.394418 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_trino_project.not_null_auth_events_itemInSession.f485d08ef6' (models\schema.yml) depends on a node named 'auth_events' in package '' which was not found
[0m13:25:46.395507 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_trino_project.accepted_values_auth_events_gender__M__F.2485b60684' (models\schema.yml) depends on a node named 'auth_events' in package '' which was not found
[0m13:25:46.396018 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_trino_project.accepted_values_auth_events_success__True__False.00a11715d4' (models\schema.yml) depends on a node named 'auth_events' in package '' which was not found
[0m13:25:46.458187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B3E7150>]}
[0m13:25:46.536098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B502650>]}
[0m13:25:46.537100 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m13:25:46.538100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B24F6D0>]}
[0m13:25:46.539098 [info ] [MainThread]: 
[0m13:25:46.540099 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:25:46.545098 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:25:46.601123 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:25:46.601649 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:25:46.601649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:47.156274 [debug] [ThreadPool]: SQL status: SUCCESS in 0.555 seconds
[0m13:25:47.157865 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:25:47.158399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_analytics_source)
[0m13:25:47.159447 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "analytics_source"
"
[0m13:25:47.163560 [debug] [ThreadPool]: Using trino connection "create_iceberg_analytics_source"
[0m13:25:47.163560 [debug] [ThreadPool]: On create_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "create_iceberg_analytics_source"} */
create schema if not exists "iceberg"."analytics_source"
[0m13:25:47.163560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:47.271349 [debug] [ThreadPool]: SQL status: SUCCESS in 0.107 seconds
[0m13:25:47.272413 [debug] [ThreadPool]: On create_iceberg_analytics_source: COMMIT
[0m13:25:47.272413 [debug] [ThreadPool]: On create_iceberg_analytics_source: Close
[0m13:25:47.274525 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics_stage'
[0m13:25:47.284718 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m13:25:47.284718 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m13:25:47.285715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:47.764470 [debug] [ThreadPool]: SQL status: SUCCESS in 0.478 seconds
[0m13:25:47.765509 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m13:25:47.766034 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m13:25:47.766557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_stage, now list_iceberg_analytics_source)
[0m13:25:47.770778 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m13:25:47.771305 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m13:25:47.771305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:47.980876 [debug] [ThreadPool]: SQL status: SUCCESS in 0.209 seconds
[0m13:25:47.982490 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m13:25:47.983015 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m13:25:47.984087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics)
[0m13:25:47.989932 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m13:25:47.989932 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m13:25:47.990941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:48.183647 [debug] [ThreadPool]: SQL status: SUCCESS in 0.193 seconds
[0m13:25:48.184704 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m13:25:48.185220 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m13:25:48.186264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B4114D0>]}
[0m13:25:48.186859 [debug] [MainThread]: On master: COMMIT
[0m13:25:48.187367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:48.187909 [info ] [MainThread]: 
[0m13:25:48.192239 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_auth_events
[0m13:25:48.192765 [info ] [Thread-1 (]: 1 of 3 START sql incremental model analytics_source.src_auth_events ............ [RUN]
[0m13:25:48.193291 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.src_auth_events'
[0m13:25:48.194302 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_auth_events
[0m13:25:48.197302 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_auth_events"
[0m13:25:48.197302 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_auth_events
[0m13:25:48.237629 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_auth_events"
[0m13:25:48.241305 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m13:25:48.241831 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

  
    

    create table "iceberg"."analytics_source"."src_auth_events"
      
      
    as (
      

with source as (
    select
        CAST(ts AS VARCHAR) as id, 
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        level,
        itemInSession,
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, 
        lastName,
        firstName,
        gender,
        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,
        success
    from "postgresql"."public"."auth_events"
)

select
    id,
    ts,
    sessionId,
    level,
    itemInSession,
    city,
    zip,
    state,
    userAgent,
    lon,
    lat,
    userId,
    lastName,
    firstName,
    gender,
    registration, 
    CASE 
        WHEN CAST(success AS VARCHAR) = 't' THEN true 
        WHEN CAST(success AS VARCHAR) = 'f' THEN false
        ELSE NULL 
    END AS success_boolean
from source



    )
[0m13:25:48.241831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:51.683438 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.441 seconds
[0m13:25:51.689203 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m13:25:51.690783 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m13:25:51.691303 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    drop view if exists "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m13:25:51.756876 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.065 seconds
[0m13:25:51.769107 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: ROLLBACK
[0m13:25:51.769638 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: Close
[0m13:25:51.771256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39C9F80D0>]}
[0m13:25:51.771787 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model analytics_source.src_auth_events ....... [[32mSUCCESS[0m in 3.58s]
[0m13:25:51.772311 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_auth_events
[0m13:25:51.772831 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_listen_events
[0m13:25:51.774744 [info ] [Thread-1 (]: 2 of 3 START sql incremental model analytics_source.src_listen_events .......... [RUN]
[0m13:25:51.775248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_auth_events, now model.my_dbt_trino_project.src_listen_events)
[0m13:25:51.775785 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_listen_events
[0m13:25:51.778925 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_listen_events"
[0m13:25:51.779971 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_listen_events
[0m13:25:51.782070 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_listen_events"
[0m13:25:51.785582 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m13:25:51.785582 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

  
    

    create table "iceberg"."analytics_source"."src_listen_events"
      
      
    as (
      

with source as (

    select
        CAST(_id AS VARCHAR) as id,
        artist,
        song,
        CAST(NULLIF(duration, '') AS DOUBLE) as duration,
        ts,
        sessionid,
        auth,
        level,
        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,
        city,
        zip,
        state,
        country,
        userAgent,
        CAST(NULLIF(lon, '') AS DOUBLE) as lon,
        CAST(NULLIF(lat, '') AS DOUBLE) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,
 -- Assurez-vous que userId peut aussi être converti de cette manière.
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration
    from "mongo"."demo"."listen_events"

)

select * from source


    )
[0m13:25:51.786582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:52.539355 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.753 seconds
[0m13:25:52.542518 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m13:25:52.543046 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m13:25:52.543563 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    drop view if exists "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m13:25:52.605023 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.061 seconds
[0m13:25:52.606090 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: ROLLBACK
[0m13:25:52.606624 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: Close
[0m13:25:52.607157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B37CED0>]}
[0m13:25:52.607687 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model analytics_source.src_listen_events ..... [[32mSUCCESS[0m in 0.83s]
[0m13:25:52.608753 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_listen_events
[0m13:25:52.608753 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_page_view_events
[0m13:25:52.611165 [info ] [Thread-1 (]: 3 of 3 START sql incremental model analytics_source.src_page_view_events ....... [RUN]
[0m13:25:52.611686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_listen_events, now model.my_dbt_trino_project.src_page_view_events)
[0m13:25:52.611686 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_page_view_events
[0m13:25:52.614262 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_page_view_events"
[0m13:25:52.615262 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_page_view_events
[0m13:25:52.620676 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_page_view_events"
[0m13:25:52.624987 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m13:25:52.625532 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

  
    

    create table "iceberg"."analytics_source"."src_page_view_events"
      
      
    as (
      

with source as (
    select
        CAST(_id AS VARCHAR) as id,
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        page,
        auth,
        level,
        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, 
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, 
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, 
        artist,
        song,
        CAST(NULLIF(duration, '') AS double) as duration
    from "mongo"."demo"."page_view_events"
)

select * from source


    )
[0m13:25:52.626584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:52.998650 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.372 seconds
[0m13:25:53.001837 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m13:25:53.002901 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m13:25:53.002901 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    drop view if exists "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m13:25:53.072811 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m13:25:53.074398 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: ROLLBACK
[0m13:25:53.074923 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: Close
[0m13:25:53.075446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b17de4-a2c0-430c-87cc-254fb1861311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39C5EA590>]}
[0m13:25:53.075967 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model analytics_source.src_page_view_events .. [[32mSUCCESS[0m in 0.46s]
[0m13:25:53.076496 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_page_view_events
[0m13:25:53.079183 [debug] [MainThread]: On master: COMMIT
[0m13:25:53.079708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:53.080252 [debug] [MainThread]: Connection 'create_iceberg_analytics_source' was properly closed.
[0m13:25:53.080252 [debug] [MainThread]: Connection 'list_iceberg_analytics' was properly closed.
[0m13:25:53.080782 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.src_page_view_events' was properly closed.
[0m13:25:53.081308 [info ] [MainThread]: 
[0m13:25:53.081833 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m13:25:53.082382 [debug] [MainThread]: Command end result
[0m13:25:53.113827 [info ] [MainThread]: 
[0m13:25:53.114360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:53.114890 [info ] [MainThread]: 
[0m13:25:53.115896 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:25:53.116901 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:53.116901 after 8.13 seconds
[0m13:25:53.116901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39AEA7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39611BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39615BCD0>]}
[0m13:25:53.117896 [debug] [MainThread]: Flushing usage events
[0m13:27:16.974936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404562410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404790910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404791C10>]}


============================== 13:27:16.978120 | ca676f68-5019-4892-a064-abd3813aeee2 ==============================
[0m13:27:16.978120 [info ] [MainThread]: Running with dbt=1.8.5
[0m13:27:16.978643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stage', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:27:17.110295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244047D5450>]}
[0m13:27:17.143161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024401BD6B10>]}
[0m13:27:17.144162 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m13:27:17.157169 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m13:27:17.281898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:17.281898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:17.311042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404E04110>]}
[0m13:27:17.382929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404DDFFD0>]}
[0m13:27:17.384261 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m13:27:17.384261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404C53590>]}
[0m13:27:17.387309 [info ] [MainThread]: 
[0m13:27:17.388827 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:27:17.395318 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:27:17.454353 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:27:17.454888 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:27:17.455429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:17.501535 [debug] [ThreadPool]: SQL status: SUCCESS in 0.046 seconds
[0m13:27:17.502622 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:27:17.503680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_analytics_stage)
[0m13:27:17.504211 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "analytics_stage"
"
[0m13:27:17.508434 [debug] [ThreadPool]: Using trino connection "create_iceberg_analytics_stage"
[0m13:27:17.508960 [debug] [ThreadPool]: On create_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "create_iceberg_analytics_stage"} */
create schema if not exists "iceberg"."analytics_stage"
[0m13:27:17.508960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:17.533535 [debug] [ThreadPool]: SQL status: SUCCESS in 0.024 seconds
[0m13:27:17.534594 [debug] [ThreadPool]: On create_iceberg_analytics_stage: COMMIT
[0m13:27:17.535133 [debug] [ThreadPool]: On create_iceberg_analytics_stage: Close
[0m13:27:17.537282 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics_source'
[0m13:27:17.548892 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m13:27:17.549418 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m13:27:17.549418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:17.669335 [debug] [ThreadPool]: SQL status: SUCCESS in 0.120 seconds
[0m13:27:17.671461 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m13:27:17.671982 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m13:27:17.672550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics)
[0m13:27:17.677319 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m13:27:17.677833 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m13:27:17.677833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:17.797932 [debug] [ThreadPool]: SQL status: SUCCESS in 0.120 seconds
[0m13:27:17.799519 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m13:27:17.799519 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m13:27:17.800585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics, now list_iceberg_analytics_stage)
[0m13:27:17.803743 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m13:27:17.804269 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m13:27:17.804796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:17.928716 [debug] [ThreadPool]: SQL status: SUCCESS in 0.124 seconds
[0m13:27:17.930286 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m13:27:17.930286 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m13:27:17.931326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404C6BDD0>]}
[0m13:27:17.931852 [debug] [MainThread]: On master: COMMIT
[0m13:27:17.932382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:17.932924 [info ] [MainThread]: 
[0m13:27:17.935534 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_streams_hourly
[0m13:27:17.936063 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_stage.stg_streams_hourly ................ [RUN]
[0m13:27:17.937122 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.stg_streams_hourly'
[0m13:27:17.937122 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_streams_hourly
[0m13:27:17.940774 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m13:27:17.942000 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_streams_hourly
[0m13:27:17.971801 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m13:27:17.974019 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m13:27:17.975027 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

  
    

    create table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp"
      
      
    as (
      

SELECT
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, 
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,
    COUNT(*) AS total_streams
FROM "iceberg"."analytics_source"."src_listen_events"
GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')
    )
[0m13:27:17.975027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:18.607356 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.632 seconds
[0m13:27:18.612554 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m13:27:18.613059 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp" rename to "iceberg"."analytics_stage"."stg_streams_hourly"
[0m13:27:18.709071 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m13:27:18.715273 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m13:27:18.716273 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m13:27:18.717273 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

    drop table if exists "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m13:27:18.793569 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:27:18.804740 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: ROLLBACK
[0m13:27:18.805270 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: Close
[0m13:27:18.805270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024405258FD0>]}
[0m13:27:18.806456 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_stage.stg_streams_hourly ........... [[32mSUCCESS[0m in 0.87s]
[0m13:27:18.807466 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_streams_hourly
[0m13:27:18.808503 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_top_songs_artists
[0m13:27:18.809477 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics_stage.stg_top_songs_artists .............. [RUN]
[0m13:27:18.810465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_streams_hourly, now model.my_dbt_trino_project.stg_top_songs_artists)
[0m13:27:18.810465 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_top_songs_artists
[0m13:27:18.813277 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m13:27:18.814276 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_top_songs_artists
[0m13:27:18.826231 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m13:27:18.828369 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_top_songs_artists"
[0m13:27:18.828369 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_top_songs_artists"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_top_songs_artists"
  security definer
  as
    

WITH song_plays AS (
    SELECT
        artist,
        song,
        COUNT(*) AS play_count
    FROM "iceberg"."analytics_source"."src_listen_events"
    GROUP BY artist, song
)

SELECT
    artist,
    song,
    play_count
FROM song_plays
ORDER BY play_count DESC
  
[0m13:27:18.828891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:18.951897 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.123 seconds
[0m13:27:18.953481 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: ROLLBACK
[0m13:27:18.954020 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: Close
[0m13:27:18.954547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244066C1890>]}
[0m13:27:18.955072 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics_stage.stg_top_songs_artists ......... [[32mSUCCESS[0m in 0.14s]
[0m13:27:18.955595 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_top_songs_artists
[0m13:27:18.956117 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_unique_users
[0m13:27:18.956641 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics_stage.stg_unique_users ................... [RUN]
[0m13:27:18.957166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_top_songs_artists, now model.my_dbt_trino_project.stg_unique_users)
[0m13:27:18.957704 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_unique_users
[0m13:27:18.961563 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_unique_users"
[0m13:27:18.962091 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_unique_users
[0m13:27:18.965025 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_unique_users"
[0m13:27:18.966079 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_unique_users"
[0m13:27:18.966604 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_unique_users"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_unique_users"
  security definer
  as
    

SELECT
    COUNT(DISTINCT userid) AS total_unique_users
FROM "iceberg"."analytics_source"."src_listen_events"
WHERE userid IS NOT NULL
  
[0m13:27:18.967130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:19.034082 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.067 seconds
[0m13:27:19.035655 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: ROLLBACK
[0m13:27:19.035655 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: Close
[0m13:27:19.036693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404CCAB90>]}
[0m13:27:19.037223 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics_stage.stg_unique_users .............. [[32mSUCCESS[0m in 0.08s]
[0m13:27:19.037736 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_unique_users
[0m13:27:19.038257 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m13:27:19.040188 [info ] [Thread-1 (]: 4 of 6 START sql view model analytics_stage.stg_user_activity_per_country ...... [RUN]
[0m13:27:19.040742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_unique_users, now model.my_dbt_trino_project.stg_user_activity_per_country)
[0m13:27:19.041269 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_country
[0m13:27:19.044418 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m13:27:19.044936 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_country
[0m13:27:19.047121 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m13:27:19.049237 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m13:27:19.049757 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_country"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_country"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    country,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  WHERE country IS NOT NULL
  UNION ALL
  SELECT
    'Unknown' AS country,
    'auth_event' AS event_type, 
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    'Unknown' AS country, 
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  country,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY country
  
[0m13:27:19.049757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:19.162125 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.112 seconds
[0m13:27:19.163731 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: ROLLBACK
[0m13:27:19.164251 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: Close
[0m13:27:19.164778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404CCB110>]}
[0m13:27:19.165300 [info ] [Thread-1 (]: 4 of 6 OK created sql view model analytics_stage.stg_user_activity_per_country . [[32mSUCCESS[0m in 0.12s]
[0m13:27:19.165827 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m13:27:19.166910 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m13:27:19.168658 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics_stage.stg_user_activity_per_location ..... [RUN]
[0m13:27:19.169183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_country, now model.my_dbt_trino_project.stg_user_activity_per_location)
[0m13:27:19.169183 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_location
[0m13:27:19.172348 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m13:27:19.172876 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_location
[0m13:27:19.175546 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m13:27:19.177676 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m13:27:19.178228 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_location"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_location"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    city,
    state,
    'auth_event' AS event_type,
    ts,
    userid
 FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    city,
    state,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  UNION ALL
  SELECT
    city,
    state,
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  state,
  city,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY state, city
  
[0m13:27:19.178228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:19.281618 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.103 seconds
[0m13:27:19.283197 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: ROLLBACK
[0m13:27:19.283846 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: Close
[0m13:27:19.284369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244066D8B90>]}
[0m13:27:19.284893 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics_stage.stg_user_activity_per_location  [[32mSUCCESS[0m in 0.12s]
[0m13:27:19.285947 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m13:27:19.287963 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m13:27:19.288491 [info ] [Thread-1 (]: 6 of 6 START sql view model analytics_stage.stg_user_level_by_gender ........... [RUN]
[0m13:27:19.289014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_location, now model.my_dbt_trino_project.stg_user_level_by_gender)
[0m13:27:19.289014 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_level_by_gender
[0m13:27:19.292136 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m13:27:19.292655 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_level_by_gender
[0m13:27:19.294755 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m13:27:19.295793 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m13:27:19.296316 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_level_by_gender"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_level_by_gender"
  security definer
  as
    

WITH user_subscriptions AS (
    SELECT
        gender,
        level, 
        COUNT(DISTINCT userId) AS user_count
    FROM "iceberg"."analytics_source"."src_auth_events"
    WHERE gender IS NOT NULL AND level IS NOT NULL
    GROUP BY gender, level
)

SELECT
    gender,
    level,
    user_count
FROM user_subscriptions
  
[0m13:27:19.296843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:19.363020 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m13:27:19.364623 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: ROLLBACK
[0m13:27:19.364623 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: Close
[0m13:27:19.365155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca676f68-5019-4892-a064-abd3813aeee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244066EDCD0>]}
[0m13:27:19.365677 [info ] [Thread-1 (]: 6 of 6 OK created sql view model analytics_stage.stg_user_level_by_gender ...... [[32mSUCCESS[0m in 0.08s]
[0m13:27:19.366740 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m13:27:19.369131 [debug] [MainThread]: On master: COMMIT
[0m13:27:19.369131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:19.369662 [debug] [MainThread]: Connection 'create_iceberg_analytics_stage' was properly closed.
[0m13:27:19.369662 [debug] [MainThread]: Connection 'list_iceberg_analytics_stage' was properly closed.
[0m13:27:19.370189 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.stg_user_level_by_gender' was properly closed.
[0m13:27:19.370189 [info ] [MainThread]: 
[0m13:27:19.370717 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m13:27:19.371778 [debug] [MainThread]: Command end result
[0m13:27:19.401298 [info ] [MainThread]: 
[0m13:27:19.401811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:19.402334 [info ] [MainThread]: 
[0m13:27:19.402866 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:27:19.403929 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:19.403929 after 2.54 seconds
[0m13:27:19.404454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002447F97BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024404CF8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002447F9BBCD0>]}
[0m13:27:19.404976 [debug] [MainThread]: Flushing usage events
[0m13:27:26.307387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD2BE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD2F5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD2F46D0>]}


============================== 13:27:26.310028 | 66c1b380-890f-4188-9a47-e788790a19d9 ==============================
[0m13:27:26.310028 [info ] [MainThread]: Running with dbt=1.8.5
[0m13:27:26.311113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models mart', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:27:26.445228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD1D3A10>]}
[0m13:27:26.478749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFA706C10>]}
[0m13:27:26.479748 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m13:27:26.494007 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m13:27:26.612067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:26.613075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:26.644591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD1E6090>]}
[0m13:27:26.713311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD90F410>]}
[0m13:27:26.714310 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m13:27:26.714310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD76D9D0>]}
[0m13:27:26.717432 [info ] [MainThread]: 
[0m13:27:26.718423 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:27:26.723451 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:27:26.782681 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:27:26.783202 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:27:26.783202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:26.819363 [debug] [ThreadPool]: SQL status: SUCCESS in 0.036 seconds
[0m13:27:26.820402 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:27:26.820921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_analytics)
[0m13:27:26.821443 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "analytics"
"
[0m13:27:26.825632 [debug] [ThreadPool]: Using trino connection "create_iceberg_analytics"
[0m13:27:26.825632 [debug] [ThreadPool]: On create_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "create_iceberg_analytics"} */
create schema if not exists "iceberg"."analytics"
[0m13:27:26.826156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:26.844484 [debug] [ThreadPool]: SQL status: SUCCESS in 0.018 seconds
[0m13:27:26.845532 [debug] [ThreadPool]: On create_iceberg_analytics: COMMIT
[0m13:27:26.845532 [debug] [ThreadPool]: On create_iceberg_analytics: Close
[0m13:27:26.847637 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics'
[0m13:27:26.857088 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m13:27:26.858088 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m13:27:26.858088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:26.950272 [debug] [ThreadPool]: SQL status: SUCCESS in 0.092 seconds
[0m13:27:26.951825 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m13:27:26.952342 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m13:27:26.953402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics, now list_iceberg_analytics_stage)
[0m13:27:26.957086 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m13:27:26.957605 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m13:27:26.958133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:27.070469 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m13:27:27.071528 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m13:27:27.072059 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m13:27:27.072576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_stage, now list_iceberg_analytics_source)
[0m13:27:27.077871 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m13:27:27.078397 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m13:27:27.078927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:27.188558 [debug] [ThreadPool]: SQL status: SUCCESS in 0.110 seconds
[0m13:27:27.189610 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m13:27:27.190138 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m13:27:27.191724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD7422D0>]}
[0m13:27:27.192254 [debug] [MainThread]: On master: COMMIT
[0m13:27:27.192782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:27.193299 [info ] [MainThread]: 
[0m13:27:27.195930 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m13:27:27.198073 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.mart_hourly_stream_evolution ............ [RUN]
[0m13:27:27.199167 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.mart_hourly_stream_evolution'
[0m13:27:27.199167 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m13:27:27.202179 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m13:27:27.203178 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m13:27:27.233823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m13:27:27.235823 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m13:27:27.235823 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

  
    

    create table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp"
      
      
    as (
      

SELECT
    stream_date,
    stream_hour,
    total_streams,
    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams
FROM "iceberg"."analytics_stage"."stg_streams_hourly"
ORDER BY
    stream_date,
    stream_hour
    )
[0m13:27:27.236821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:27.641883 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.405 seconds
[0m13:27:27.647775 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m13:27:27.648342 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp" rename to "iceberg"."analytics"."mart_hourly_stream_evolution"
[0m13:27:27.760210 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.112 seconds
[0m13:27:27.765947 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m13:27:27.768010 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m13:27:27.768010 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

    drop table if exists "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m13:27:27.835458 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.067 seconds
[0m13:27:27.846994 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: ROLLBACK
[0m13:27:27.847148 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: Close
[0m13:27:27.848740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD8CBB50>]}
[0m13:27:27.849272 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics.mart_hourly_stream_evolution ....... [[32mSUCCESS[0m in 0.65s]
[0m13:27:27.849799 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m13:27:27.850316 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_top_songs_artists
[0m13:27:27.852192 [info ] [Thread-1 (]: 2 of 6 START sql table model analytics.mart_top_songs_artists .................. [RUN]
[0m13:27:27.853252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_hourly_stream_evolution, now model.my_dbt_trino_project.mart_top_songs_artists)
[0m13:27:27.853772 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_top_songs_artists
[0m13:27:27.856390 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m13:27:27.856918 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_top_songs_artists
[0m13:27:27.859013 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m13:27:27.860940 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m13:27:27.860940 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

  
    

    create table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp"
      
      
    as (
      

WITH top_songs AS (
    SELECT
        artist,
        song,
        play_count
    FROM "iceberg"."analytics_stage"."stg_top_songs_artists"
)

SELECT
    artist,
    song,
    play_count
FROM top_songs
    )
[0m13:27:27.861462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:28.162576 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.301 seconds
[0m13:27:28.167356 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m13:27:28.167879 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp" rename to "iceberg"."analytics"."mart_top_songs_artists"
[0m13:27:28.250874 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.083 seconds
[0m13:27:28.253540 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m13:27:28.254616 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m13:27:28.254616 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

    drop table if exists "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m13:27:28.321635 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m13:27:28.323242 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: ROLLBACK
[0m13:27:28.323781 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: Close
[0m13:27:28.324317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFF21DF90>]}
[0m13:27:28.324914 [info ] [Thread-1 (]: 2 of 6 OK created sql table model analytics.mart_top_songs_artists ............. [[32mSUCCESS[0m in 0.47s]
[0m13:27:28.325417 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_top_songs_artists
[0m13:27:28.327335 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_total_unique_users
[0m13:27:28.328257 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.mart_total_unique_users ................. [RUN]
[0m13:27:28.328765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_top_songs_artists, now model.my_dbt_trino_project.mart_total_unique_users)
[0m13:27:28.328765 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_total_unique_users
[0m13:27:28.331277 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m13:27:28.331277 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_total_unique_users
[0m13:27:28.334794 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m13:27:28.335791 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m13:27:28.335791 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

  
    

    create table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp"
      
      
    as (
      

SELECT
    total_unique_users
FROM "iceberg"."analytics_stage"."stg_unique_users"
    )
[0m13:27:28.336793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:28.690110 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.354 seconds
[0m13:27:28.693354 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m13:27:28.693861 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp" rename to "iceberg"."analytics"."mart_total_unique_users"
[0m13:27:28.776351 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m13:27:28.779025 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m13:27:28.779559 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m13:27:28.780075 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

    drop table if exists "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m13:27:28.842631 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m13:27:28.844221 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: ROLLBACK
[0m13:27:28.844752 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: Close
[0m13:27:28.845284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD90D7D0>]}
[0m13:27:28.845880 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.mart_total_unique_users ............ [[32mSUCCESS[0m in 0.52s]
[0m13:27:28.846386 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_total_unique_users
[0m13:27:28.848088 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m13:27:28.848666 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.mart_user_activity_per_country .......... [RUN]
[0m13:27:28.849197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_total_unique_users, now model.my_dbt_trino_project.mart_user_activity_per_country)
[0m13:27:28.849740 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_country
[0m13:27:28.852367 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m13:27:28.852895 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_country
[0m13:27:28.855426 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m13:27:28.856426 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m13:27:28.856426 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp"
      
      
    as (
      

SELECT
  country,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_country"
GROUP BY country
ORDER BY SUM(activity_count) DESC
    )
[0m13:27:28.857429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:29.263941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.407 seconds
[0m13:27:29.267079 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m13:27:29.267601 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_country"
[0m13:27:29.357657 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.090 seconds
[0m13:27:29.361818 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m13:27:29.362336 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m13:27:29.362852 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m13:27:29.421151 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.058 seconds
[0m13:27:29.422720 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: ROLLBACK
[0m13:27:29.422720 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: Close
[0m13:27:29.423367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFF293450>]}
[0m13:27:29.423876 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.mart_user_activity_per_country ..... [[32mSUCCESS[0m in 0.57s]
[0m13:27:29.424409 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m13:27:29.425726 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m13:27:29.426998 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.mart_user_activity_per_state ............ [RUN]
[0m13:27:29.427526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_activity_per_country, now model.my_dbt_trino_project.mart_user_activity_per_state)
[0m13:27:29.428052 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_state
[0m13:27:29.430658 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m13:27:29.431217 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_state
[0m13:27:29.433767 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m13:27:29.434761 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m13:27:29.435762 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp"
      
      
    as (
      

SELECT
  state,
  city,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_location"
GROUP BY state, city
ORDER BY state, SUM(activity_count) DESC
    )
[0m13:27:29.435762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:29.776893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.341 seconds
[0m13:27:29.780091 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m13:27:29.780091 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_state"
[0m13:27:29.875522 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m13:27:29.878140 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m13:27:29.879228 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m13:27:29.879228 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m13:27:29.941525 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.062 seconds
[0m13:27:29.943146 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: ROLLBACK
[0m13:27:29.943146 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: Close
[0m13:27:29.943681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFF293450>]}
[0m13:27:29.944215 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.mart_user_activity_per_state ....... [[32mSUCCESS[0m in 0.52s]
[0m13:27:29.945254 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m13:27:29.947196 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m13:27:29.947780 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.mart_user_level_by_gender ............... [RUN]
[0m13:27:29.948313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_activity_per_state, now model.my_dbt_trino_project.mart_user_level_by_gender)
[0m13:27:29.948313 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_level_by_gender
[0m13:27:29.950938 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m13:27:29.951986 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_level_by_gender
[0m13:27:29.954555 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m13:27:29.955555 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m13:27:29.955555 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

  
    

    create table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp"
      
      
    as (
      

SELECT
    gender,
    level,
    SUM(user_count) AS total_users,
    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users
FROM "iceberg"."analytics_stage"."stg_user_level_by_gender"
GROUP BY gender, level
    )
[0m13:27:29.956558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:30.426802 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.470 seconds
[0m13:27:30.431006 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m13:27:30.431532 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp" rename to "iceberg"."analytics"."mart_user_level_by_gender"
[0m13:27:30.508078 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:27:30.511837 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m13:27:30.512902 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m13:27:30.513971 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

    drop table if exists "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m13:27:30.582135 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.068 seconds
[0m13:27:30.583706 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: ROLLBACK
[0m13:27:30.584231 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: Close
[0m13:27:30.584753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c1b380-890f-4188-9a47-e788790a19d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD94BB10>]}
[0m13:27:30.585808 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.mart_user_level_by_gender .......... [[32mSUCCESS[0m in 0.64s]
[0m13:27:30.586337 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m13:27:30.589210 [debug] [MainThread]: On master: COMMIT
[0m13:27:30.589739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:30.589814 [debug] [MainThread]: Connection 'create_iceberg_analytics' was properly closed.
[0m13:27:30.590322 [debug] [MainThread]: Connection 'list_iceberg_analytics_source' was properly closed.
[0m13:27:30.590322 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.mart_user_level_by_gender' was properly closed.
[0m13:27:30.590848 [info ] [MainThread]: 
[0m13:27:30.591375 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m13:27:30.592428 [debug] [MainThread]: Command end result
[0m13:27:30.678910 [info ] [MainThread]: 
[0m13:27:30.679445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:30.679969 [info ] [MainThread]: 
[0m13:27:30.681527 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:27:30.682614 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:30.682614 after 4.47 seconds
[0m13:27:30.683150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBFD091C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBF868DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBF868DE10>]}
[0m13:27:30.683680 [debug] [MainThread]: Flushing usage events
[0m15:08:08.495962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192867A9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192876D7BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192876D7D50>]}


============================== 15:08:08.500698 | 4d8b1382-46e3-4217-a5dd-e9ebc83f6da9 ==============================
[0m15:08:08.500698 [info ] [MainThread]: Running with dbt=1.8.5
[0m15:08:08.501222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:08.710186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287A73C10>]}
[0m15:08:08.746585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019284AD3010>]}
[0m15:08:08.746585 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m15:08:08.762048 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m15:08:08.951457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:08.952093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:08.983516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287C03510>]}
[0m15:08:09.062731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287CC1750>]}
[0m15:08:09.062731 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m15:08:09.062731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287B3DB50>]}
[0m15:08:09.062731 [info ] [MainThread]: 
[0m15:08:09.062731 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:08:09.062731 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:08:09.210642 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:08:09.210642 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:08:09.210642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:09.724572 [debug] [ThreadPool]: SQL status: SUCCESS in 0.516 seconds
[0m15:08:09.724572 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:08:09.729582 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:08:09.729582 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:08:09.729582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:09.792239 [debug] [ThreadPool]: SQL status: SUCCESS in 0.063 seconds
[0m15:08:09.792239 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:08:09.796756 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:08:09.796756 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:08:09.796756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:09.846801 [debug] [ThreadPool]: SQL status: SUCCESS in 0.047 seconds
[0m15:08:09.846801 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:08:09.850856 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics_stage'
[0m15:08:09.859393 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m15:08:09.859393 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m15:08:09.859393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:10.189305 [debug] [ThreadPool]: SQL status: SUCCESS in 0.326 seconds
[0m15:08:10.191325 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m15:08:10.191325 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m15:08:10.192344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_stage, now list_iceberg_analytics_source)
[0m15:08:10.197846 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m15:08:10.197846 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m15:08:10.197846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:10.343229 [debug] [ThreadPool]: SQL status: SUCCESS in 0.143 seconds
[0m15:08:10.344748 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m15:08:10.344748 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m15:08:10.344748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics)
[0m15:08:10.344748 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m15:08:10.344748 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m15:08:10.344748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:10.471076 [debug] [ThreadPool]: SQL status: SUCCESS in 0.120 seconds
[0m15:08:10.471076 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m15:08:10.471076 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m15:08:10.471076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287A88950>]}
[0m15:08:10.471076 [debug] [MainThread]: On master: COMMIT
[0m15:08:10.471076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:10.471076 [info ] [MainThread]: 
[0m15:08:10.477916 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_auth_events
[0m15:08:10.481433 [info ] [Thread-1 (]: 1 of 15 START sql incremental model analytics_source.src_auth_events ........... [RUN]
[0m15:08:10.481433 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.src_auth_events'
[0m15:08:10.481433 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_auth_events
[0m15:08:10.487767 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_auth_events"
[0m15:08:10.487767 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_auth_events
[0m15:08:10.521820 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:08:10.521820 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(ts AS VARCHAR) as id, 
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        level,
        itemInSession,
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, 
        lastName,
        firstName,
        gender,
        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,
        success
    from "postgresql"."public"."auth_events"
)

select
    id,
    ts,
    sessionId,
    level,
    itemInSession,
    city,
    zip,
    state,
    userAgent,
    lon,
    lat,
    userId,
    lastName,
    firstName,
    gender,
    registration, 
    CASE 
        WHEN CAST(success AS VARCHAR) = 't' THEN true 
        WHEN CAST(success AS VARCHAR) = 'f' THEN false
        ELSE NULL 
    END AS success_boolean
from source



    where ts NOT IN (SELECT ts FROM "iceberg"."analytics_source"."src_auth_events")

  
[0m15:08:10.521820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:11.652207 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.124 seconds
[0m15:08:11.659538 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:08:11.659538 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:08:11.812571 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.151 seconds
[0m15:08:11.812571 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:08:11.812571 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m15:08:11.977431 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.160 seconds
[0m15:08:11.982479 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:08:11.987495 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m15:08:12.122529 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.135 seconds
[0m15:08:12.129058 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_auth_events"
[0m15:08:12.129058 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:08:12.129058 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */
insert into "iceberg"."analytics_source"."src_auth_events" ("id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean")
    (
        select "id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean"
        from "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
    )
[0m15:08:14.410736 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.275 seconds
[0m15:08:14.416793 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:08:14.418798 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:08:14.418798 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    drop view if exists "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:08:14.491075 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m15:08:14.506111 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: ROLLBACK
[0m15:08:14.506111 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: Close
[0m15:08:14.508213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019288115DD0>]}
[0m15:08:14.509224 [info ] [Thread-1 (]: 1 of 15 OK created sql incremental model analytics_source.src_auth_events ...... [[32mSUCCESS[0m in 4.03s]
[0m15:08:14.509224 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_auth_events
[0m15:08:14.510735 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_listen_events
[0m15:08:14.510735 [info ] [Thread-1 (]: 2 of 15 START sql incremental model analytics_source.src_listen_events ......... [RUN]
[0m15:08:14.510735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_auth_events, now model.my_dbt_trino_project.src_listen_events)
[0m15:08:14.510735 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_listen_events
[0m15:08:14.515254 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_listen_events"
[0m15:08:14.516255 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_listen_events
[0m15:08:14.522254 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:08:14.522254 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
  security definer
  as
    

with source as (

    select
        CAST(_id AS VARCHAR) as id,
        artist,
        song,
        CAST(NULLIF(duration, '') AS DOUBLE) as duration,
        ts,
        sessionid,
        auth,
        level,
        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,
        city,
        zip,
        state,
        country,
        userAgent,
        CAST(NULLIF(lon, '') AS DOUBLE) as lon,
        CAST(NULLIF(lat, '') AS DOUBLE) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,
 -- Assurez-vous que userId peut aussi être converti de cette manière.
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration
    from "mongo"."demo"."listen_events"

)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_listen_events")

  
[0m15:08:14.522254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:14.615890 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.094 seconds
[0m15:08:14.619368 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:08:14.619368 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:08:14.763401 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.143 seconds
[0m15:08:14.767403 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:08:14.767403 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m15:08:14.895307 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.128 seconds
[0m15:08:14.898831 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:08:14.899835 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m15:08:15.015209 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m15:08:15.017218 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_listen_events"
[0m15:08:15.019217 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:08:15.019217 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */
insert into "iceberg"."analytics_source"."src_listen_events" ("id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration")
    (
        select "id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration"
        from "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
    )
[0m15:08:15.509428 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.490 seconds
[0m15:08:15.513959 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:08:15.514463 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:08:15.514463 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    drop view if exists "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:08:15.590505 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.075 seconds
[0m15:08:15.592499 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: ROLLBACK
[0m15:08:15.592499 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: Close
[0m15:08:15.593503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019289682610>]}
[0m15:08:15.593503 [info ] [Thread-1 (]: 2 of 15 OK created sql incremental model analytics_source.src_listen_events .... [[32mSUCCESS[0m in 1.08s]
[0m15:08:15.593503 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_listen_events
[0m15:08:15.596082 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_page_view_events
[0m15:08:15.597046 [info ] [Thread-1 (]: 3 of 15 START sql incremental model analytics_source.src_page_view_events ...... [RUN]
[0m15:08:15.597046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_listen_events, now model.my_dbt_trino_project.src_page_view_events)
[0m15:08:15.598046 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_page_view_events
[0m15:08:15.601047 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:15.601047 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_page_view_events
[0m15:08:15.607178 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:15.607178 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(_id AS VARCHAR) as id,
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        page,
        auth,
        level,
        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, 
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, 
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, 
        artist,
        song,
        CAST(NULLIF(duration, '') AS double) as duration
    from "mongo"."demo"."page_view_events"
)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_page_view_events")

  
[0m15:08:15.607178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:15.693893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:08:15.696866 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:15.697373 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:08:15.839131 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.142 seconds
[0m15:08:15.843201 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:15.843201 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m15:08:15.967610 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.123 seconds
[0m15:08:15.970782 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:15.971311 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m15:08:16.088227 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:08:16.090236 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:16.092239 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:16.092239 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */
insert into "iceberg"."analytics_source"."src_page_view_events" ("id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration")
    (
        select "id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration"
        from "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
    )
[0m15:08:16.497849 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.405 seconds
[0m15:08:16.500368 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:08:16.501367 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:08:16.501367 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    drop view if exists "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:08:16.579051 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:08:16.580562 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: ROLLBACK
[0m15:08:16.580562 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: Close
[0m15:08:16.581574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019289658B90>]}
[0m15:08:16.581574 [info ] [Thread-1 (]: 3 of 15 OK created sql incremental model analytics_source.src_page_view_events . [[32mSUCCESS[0m in 0.98s]
[0m15:08:16.583060 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_page_view_events
[0m15:08:16.584071 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:08:16.584071 [info ] [Thread-1 (]: 4 of 15 START sql view model analytics_stage.stg_user_level_by_gender .......... [RUN]
[0m15:08:16.585078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_page_view_events, now model.my_dbt_trino_project.stg_user_level_by_gender)
[0m15:08:16.585822 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:08:16.588334 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:08:16.590346 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:08:16.656313 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:08:16.658316 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:08:16.658316 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_level_by_gender"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_level_by_gender"
  security definer
  as
    

WITH user_subscriptions AS (
    SELECT
        gender,
        level, 
        COUNT(DISTINCT userId) AS user_count
    FROM "iceberg"."analytics_source"."src_auth_events"
    WHERE gender IS NOT NULL AND level IS NOT NULL
    GROUP BY gender, level
)

SELECT
    gender,
    level,
    user_count
FROM user_subscriptions
  
[0m15:08:16.659315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:16.771504 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m15:08:16.775502 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: ROLLBACK
[0m15:08:16.775502 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: Close
[0m15:08:16.776503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928714A890>]}
[0m15:08:16.776503 [info ] [Thread-1 (]: 4 of 15 OK created sql view model analytics_stage.stg_user_level_by_gender ..... [[32mSUCCESS[0m in 0.19s]
[0m15:08:16.778014 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:08:16.778014 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_streams_hourly
[0m15:08:16.779039 [info ] [Thread-1 (]: 5 of 15 START sql table model analytics_stage.stg_streams_hourly ............... [RUN]
[0m15:08:16.779039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_level_by_gender, now model.my_dbt_trino_project.stg_streams_hourly)
[0m15:08:16.780041 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_streams_hourly
[0m15:08:16.782554 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:08:16.783566 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_streams_hourly
[0m15:08:16.803403 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:08:16.806405 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:08:16.806405 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

  
    

    create table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp"
      
      
    as (
      

SELECT
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, 
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,
    COUNT(*) AS total_streams
FROM "iceberg"."analytics_source"."src_listen_events"
GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')
    )
[0m15:08:16.807406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:17.334949 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.527 seconds
[0m15:08:17.340500 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:08:17.340500 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly" rename to "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:08:17.437253 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m15:08:17.440259 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:08:17.440259 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp" rename to "iceberg"."analytics_stage"."stg_streams_hourly"
[0m15:08:17.519695 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m15:08:17.522693 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:08:17.523692 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:08:17.524692 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

    drop table if exists "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:08:17.819381 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.294 seconds
[0m15:08:17.821379 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: ROLLBACK
[0m15:08:17.821379 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: Close
[0m15:08:17.822379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192896B4350>]}
[0m15:08:17.823613 [info ] [Thread-1 (]: 5 of 15 OK created sql table model analytics_stage.stg_streams_hourly .......... [[32mSUCCESS[0m in 1.04s]
[0m15:08:17.824627 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_streams_hourly
[0m15:08:17.824627 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:08:17.825624 [info ] [Thread-1 (]: 6 of 15 START sql view model analytics_stage.stg_top_songs_artists ............. [RUN]
[0m15:08:17.826627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_streams_hourly, now model.my_dbt_trino_project.stg_top_songs_artists)
[0m15:08:17.826627 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:08:17.829625 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:08:17.829625 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:08:17.833152 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:08:17.835151 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:08:17.835151 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_top_songs_artists"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_top_songs_artists"
  security definer
  as
    

WITH song_plays AS (
    SELECT
        artist,
        song,
        COUNT(*) AS play_count
    FROM "iceberg"."analytics_source"."src_listen_events"
    GROUP BY artist, song
)

SELECT
    artist,
    song,
    play_count
FROM song_plays
ORDER BY play_count DESC
  
[0m15:08:17.836659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:17.938834 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.102 seconds
[0m15:08:17.939833 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: ROLLBACK
[0m15:08:17.940837 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: Close
[0m15:08:17.941583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019284AAC890>]}
[0m15:08:17.941833 [info ] [Thread-1 (]: 6 of 15 OK created sql view model analytics_stage.stg_top_songs_artists ........ [[32mSUCCESS[0m in 0.12s]
[0m15:08:17.942832 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:08:17.942832 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_unique_users
[0m15:08:17.943833 [info ] [Thread-1 (]: 7 of 15 START sql view model analytics_stage.stg_unique_users .................. [RUN]
[0m15:08:17.943833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_top_songs_artists, now model.my_dbt_trino_project.stg_unique_users)
[0m15:08:17.944836 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_unique_users
[0m15:08:17.949341 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_unique_users"
[0m15:08:17.950347 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_unique_users
[0m15:08:17.952348 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_unique_users"
[0m15:08:17.954450 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_unique_users"
[0m15:08:17.954450 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_unique_users"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_unique_users"
  security definer
  as
    

SELECT
    COUNT(DISTINCT userid) AS total_unique_users
FROM "iceberg"."analytics_source"."src_listen_events"
WHERE userid IS NOT NULL
  
[0m15:08:17.954450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:18.036077 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m15:08:18.038076 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: ROLLBACK
[0m15:08:18.038076 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: Close
[0m15:08:18.038076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287CC10D0>]}
[0m15:08:18.039497 [info ] [Thread-1 (]: 7 of 15 OK created sql view model analytics_stage.stg_unique_users ............. [[32mSUCCESS[0m in 0.09s]
[0m15:08:18.039497 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_unique_users
[0m15:08:18.040504 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:08:18.041504 [info ] [Thread-1 (]: 8 of 15 START sql view model analytics_stage.stg_user_activity_per_country ..... [RUN]
[0m15:08:18.041504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_unique_users, now model.my_dbt_trino_project.stg_user_activity_per_country)
[0m15:08:18.041504 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:08:18.044503 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:08:18.045506 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:08:18.048504 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:08:18.050503 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:08:18.050503 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_country"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_country"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    country,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  WHERE country IS NOT NULL
  UNION ALL
  SELECT
    'Unknown' AS country,
    'auth_event' AS event_type, 
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    'Unknown' AS country, 
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  country,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY country
  
[0m15:08:18.050503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:18.191779 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.141 seconds
[0m15:08:18.194593 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: ROLLBACK
[0m15:08:18.194593 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: Close
[0m15:08:18.195599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928812DA90>]}
[0m15:08:18.196666 [info ] [Thread-1 (]: 8 of 15 OK created sql view model analytics_stage.stg_user_activity_per_country  [[32mSUCCESS[0m in 0.15s]
[0m15:08:18.196666 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:08:18.197672 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:08:18.198177 [info ] [Thread-1 (]: 9 of 15 START sql view model analytics_stage.stg_user_activity_per_location .... [RUN]
[0m15:08:18.198682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_country, now model.my_dbt_trino_project.stg_user_activity_per_location)
[0m15:08:18.198682 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:08:18.203577 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:08:18.204585 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:08:18.207660 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:08:18.211044 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:08:18.211044 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_location"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_location"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    city,
    state,
    'auth_event' AS event_type,
    ts,
    userid
 FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    city,
    state,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  UNION ALL
  SELECT
    city,
    state,
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  state,
  city,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY state, city
  
[0m15:08:18.211044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:18.324438 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m15:08:18.326445 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: ROLLBACK
[0m15:08:18.326445 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: Close
[0m15:08:18.326445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287BF5250>]}
[0m15:08:18.327703 [info ] [Thread-1 (]: 9 of 15 OK created sql view model analytics_stage.stg_user_activity_per_location  [[32mSUCCESS[0m in 0.13s]
[0m15:08:18.328209 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:08:18.329214 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:08:18.329214 [info ] [Thread-1 (]: 10 of 15 START sql table model analytics.mart_user_level_by_gender ............. [RUN]
[0m15:08:18.330215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_location, now model.my_dbt_trino_project.mart_user_level_by_gender)
[0m15:08:18.330215 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:08:18.333214 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:08:18.334216 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:08:18.337214 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:08:18.339215 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:08:18.340217 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

  
    

    create table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp"
      
      
    as (
      

SELECT
    gender,
    level,
    SUM(user_count) AS total_users,
    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users
FROM "iceberg"."analytics_stage"."stg_user_level_by_gender"
GROUP BY gender, level
    )
[0m15:08:18.340217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:18.814668 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.474 seconds
[0m15:08:18.821693 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:08:18.823700 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender" rename to "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:08:18.901575 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m15:08:18.905128 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:08:18.905128 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp" rename to "iceberg"."analytics"."mart_user_level_by_gender"
[0m15:08:18.989303 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.084 seconds
[0m15:08:18.992298 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:08:18.993297 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:08:18.993297 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

    drop table if exists "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:08:19.116092 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m15:08:19.117098 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: ROLLBACK
[0m15:08:19.118100 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: Close
[0m15:08:19.118100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019288120DD0>]}
[0m15:08:19.118100 [info ] [Thread-1 (]: 10 of 15 OK created sql table model analytics.mart_user_level_by_gender ........ [[32mSUCCESS[0m in 0.79s]
[0m15:08:19.119430 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:08:19.120436 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:08:19.122437 [info ] [Thread-1 (]: 11 of 15 START sql table model analytics.mart_hourly_stream_evolution .......... [RUN]
[0m15:08:19.123437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_level_by_gender, now model.my_dbt_trino_project.mart_hourly_stream_evolution)
[0m15:08:19.123437 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:08:19.126436 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:08:19.127436 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:08:19.130438 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:08:19.132435 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:08:19.132435 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

  
    

    create table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp"
      
      
    as (
      

SELECT
    stream_date,
    stream_hour,
    total_streams,
    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams
FROM "iceberg"."analytics_stage"."stg_streams_hourly"
ORDER BY
    stream_date,
    stream_hour
    )
[0m15:08:19.132435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:19.415578 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.283 seconds
[0m15:08:19.419189 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:08:19.420194 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution" rename to "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:08:19.491512 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m15:08:19.494555 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:08:19.495558 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp" rename to "iceberg"."analytics"."mart_hourly_stream_evolution"
[0m15:08:19.581843 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:08:19.584140 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:08:19.585148 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:08:19.585148 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

    drop table if exists "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:08:19.726411 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.141 seconds
[0m15:08:19.728422 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: ROLLBACK
[0m15:08:19.729419 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: Close
[0m15:08:19.730417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287682B50>]}
[0m15:08:19.731118 [info ] [Thread-1 (]: 11 of 15 OK created sql table model analytics.mart_hourly_stream_evolution ..... [[32mSUCCESS[0m in 0.61s]
[0m15:08:19.731118 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:08:19.732129 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:08:19.732129 [info ] [Thread-1 (]: 12 of 15 START sql table model analytics.mart_top_songs_artists ................ [RUN]
[0m15:08:19.733126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_hourly_stream_evolution, now model.my_dbt_trino_project.mart_top_songs_artists)
[0m15:08:19.733126 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:08:19.737635 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:08:19.738636 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:08:19.747171 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:08:19.749173 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:08:19.750172 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

  
    

    create table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp"
      
      
    as (
      

WITH top_songs AS (
    SELECT
        artist,
        song,
        play_count
    FROM "iceberg"."analytics_stage"."stg_top_songs_artists"
)

SELECT
    artist,
    song,
    play_count
FROM top_songs
    )
[0m15:08:19.750172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:20.088923 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.339 seconds
[0m15:08:20.092920 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:08:20.093919 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists" rename to "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:08:20.185404 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.091 seconds
[0m15:08:20.190660 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:08:20.190660 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp" rename to "iceberg"."analytics"."mart_top_songs_artists"
[0m15:08:20.267604 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:08:20.272550 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:08:20.274694 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:08:20.274694 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

    drop table if exists "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:08:20.408164 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.132 seconds
[0m15:08:20.410169 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: ROLLBACK
[0m15:08:20.410169 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: Close
[0m15:08:20.411167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192881C9B10>]}
[0m15:08:20.412168 [info ] [Thread-1 (]: 12 of 15 OK created sql table model analytics.mart_top_songs_artists ........... [[32mSUCCESS[0m in 0.68s]
[0m15:08:20.412168 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:08:20.413679 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_total_unique_users
[0m15:08:20.413679 [info ] [Thread-1 (]: 13 of 15 START sql table model analytics.mart_total_unique_users ............... [RUN]
[0m15:08:20.414690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_top_songs_artists, now model.my_dbt_trino_project.mart_total_unique_users)
[0m15:08:20.415693 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_total_unique_users
[0m15:08:20.418689 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:08:20.419689 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_total_unique_users
[0m15:08:20.423205 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:08:20.424712 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:08:20.424712 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

  
    

    create table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp"
      
      
    as (
      

SELECT
    total_unique_users
FROM "iceberg"."analytics_stage"."stg_unique_users"
    )
[0m15:08:20.425722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:20.725618 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.300 seconds
[0m15:08:20.729181 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:08:20.730184 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users" rename to "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:08:20.802827 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m15:08:20.808347 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:08:20.809467 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp" rename to "iceberg"."analytics"."mart_total_unique_users"
[0m15:08:20.884194 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.074 seconds
[0m15:08:20.888193 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:08:20.889189 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:08:20.889189 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

    drop table if exists "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:08:21.015138 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.125 seconds
[0m15:08:21.017139 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: ROLLBACK
[0m15:08:21.017139 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: Close
[0m15:08:21.018139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192896530D0>]}
[0m15:08:21.018139 [info ] [Thread-1 (]: 13 of 15 OK created sql table model analytics.mart_total_unique_users .......... [[32mSUCCESS[0m in 0.60s]
[0m15:08:21.019138 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_total_unique_users
[0m15:08:21.020139 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:08:21.020139 [info ] [Thread-1 (]: 14 of 15 START sql table model analytics.mart_user_activity_per_country ........ [RUN]
[0m15:08:21.021649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_total_unique_users, now model.my_dbt_trino_project.mart_user_activity_per_country)
[0m15:08:21.021649 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:08:21.025598 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:08:21.026107 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:08:21.034441 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:08:21.036874 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:08:21.036874 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp"
      
      
    as (
      

SELECT
  country,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_country"
GROUP BY country
ORDER BY SUM(activity_count) DESC
    )
[0m15:08:21.036874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:21.382002 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.344 seconds
[0m15:08:21.385392 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:08:21.385392 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country" rename to "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:08:21.472190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:08:21.475239 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:08:21.476239 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_country"
[0m15:08:21.552747 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:08:21.558885 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:08:21.560963 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:08:21.560963 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:08:21.686044 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m15:08:21.688057 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: ROLLBACK
[0m15:08:21.689525 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: Close
[0m15:08:21.690677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192896B5DD0>]}
[0m15:08:21.691305 [info ] [Thread-1 (]: 14 of 15 OK created sql table model analytics.mart_user_activity_per_country ... [[32mSUCCESS[0m in 0.67s]
[0m15:08:21.692644 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:08:21.692644 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:08:21.693992 [info ] [Thread-1 (]: 15 of 15 START sql table model analytics.mart_user_activity_per_state .......... [RUN]
[0m15:08:21.695000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_activity_per_country, now model.my_dbt_trino_project.mart_user_activity_per_state)
[0m15:08:21.695000 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:08:21.698693 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:08:21.699702 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:08:21.708097 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:08:21.713367 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:08:21.714376 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp"
      
      
    as (
      

SELECT
  state,
  city,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_location"
GROUP BY state, city
ORDER BY state, SUM(activity_count) DESC
    )
[0m15:08:21.715458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:22.094114 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.379 seconds
[0m15:08:22.097495 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:08:22.097495 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state" rename to "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:08:22.178408 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m15:08:22.181280 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:08:22.182279 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_state"
[0m15:08:22.260426 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m15:08:22.262955 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:08:22.263957 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:08:22.264959 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:08:22.382669 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m15:08:22.384664 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: ROLLBACK
[0m15:08:22.385664 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: Close
[0m15:08:22.385664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8b1382-46e3-4217-a5dd-e9ebc83f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192881C3410>]}
[0m15:08:22.387000 [info ] [Thread-1 (]: 15 of 15 OK created sql table model analytics.mart_user_activity_per_state ..... [[32mSUCCESS[0m in 0.69s]
[0m15:08:22.388005 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:08:22.389010 [debug] [MainThread]: On master: COMMIT
[0m15:08:22.389010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:22.390006 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:08:22.390006 [debug] [MainThread]: Connection 'list_iceberg_analytics' was properly closed.
[0m15:08:22.390006 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.mart_user_activity_per_state' was properly closed.
[0m15:08:22.391149 [info ] [MainThread]: 
[0m15:08:22.391149 [info ] [MainThread]: Finished running 3 incremental models, 5 view models, 7 table models in 0 hours 0 minutes and 13.33 seconds (13.33s).
[0m15:08:22.393156 [debug] [MainThread]: Command end result
[0m15:08:22.427824 [info ] [MainThread]: 
[0m15:08:22.428829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:22.429828 [info ] [MainThread]: 
[0m15:08:22.429828 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m15:08:22.431127 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:22.431127 after 14.04 seconds
[0m15:08:22.431630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019282A29A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928298BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019287B39990>]}
[0m15:08:22.431630 [debug] [MainThread]: Flushing usage events
[0m15:13:02.662177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548AD72410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548AFD5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548AFD6710>]}


============================== 15:13:02.668248 | c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2 ==============================
[0m15:13:02.668248 [info ] [MainThread]: Running with dbt=1.8.5
[0m15:13:02.668248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:02.807919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025487435410>]}
[0m15:13:02.844276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254883E2AD0>]}
[0m15:13:02.844276 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m15:13:02.856520 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m15:13:02.985225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:02.985225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:03.015230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548AEC5090>]}
[0m15:13:03.088537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B5FD590>]}
[0m15:13:03.092890 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m15:13:03.093587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B02C9D0>]}
[0m15:13:03.093587 [info ] [MainThread]: 
[0m15:13:03.093587 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:13:03.099456 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:13:03.154149 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:13:03.154149 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:13:03.154149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:03.192187 [debug] [ThreadPool]: SQL status: SUCCESS in 0.039 seconds
[0m15:13:03.196172 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:13:03.199567 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:13:03.199567 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:13:03.199567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:03.240160 [debug] [ThreadPool]: SQL status: SUCCESS in 0.040 seconds
[0m15:13:03.241037 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:13:03.245241 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:13:03.245751 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:13:03.245751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:03.275626 [debug] [ThreadPool]: SQL status: SUCCESS in 0.030 seconds
[0m15:13:03.276636 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:13:03.276636 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics'
[0m15:13:03.290000 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m15:13:03.290000 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m15:13:03.290000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:03.403684 [debug] [ThreadPool]: SQL status: SUCCESS in 0.114 seconds
[0m15:13:03.403684 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m15:13:03.403684 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m15:13:03.403684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics, now list_iceberg_analytics_source)
[0m15:13:03.411605 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m15:13:03.411605 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m15:13:03.411605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:03.498829 [debug] [ThreadPool]: SQL status: SUCCESS in 0.086 seconds
[0m15:13:03.500257 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m15:13:03.500257 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m15:13:03.500257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics_stage)
[0m15:13:03.507465 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m15:13:03.507465 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m15:13:03.507465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:03.597522 [debug] [ThreadPool]: SQL status: SUCCESS in 0.088 seconds
[0m15:13:03.597522 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m15:13:03.599534 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m15:13:03.599534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B5BF650>]}
[0m15:13:03.599534 [debug] [MainThread]: On master: COMMIT
[0m15:13:03.599534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:03.599534 [info ] [MainThread]: 
[0m15:13:03.599534 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_auth_events
[0m15:13:03.599534 [info ] [Thread-1 (]: 1 of 15 START sql incremental model analytics_source.src_auth_events ........... [RUN]
[0m15:13:03.605746 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.src_auth_events'
[0m15:13:03.605746 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_auth_events
[0m15:13:03.614063 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_auth_events"
[0m15:13:03.614875 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_auth_events
[0m15:13:03.657348 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:13:03.657877 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(ts AS VARCHAR) as id, 
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        level,
        itemInSession,
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, 
        lastName,
        firstName,
        gender,
        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,
        success
    from "postgresql"."public"."auth_events"
)

select
    id,
    ts,
    sessionId,
    level,
    itemInSession,
    city,
    zip,
    state,
    userAgent,
    lon,
    lat,
    userId,
    lastName,
    firstName,
    gender,
    registration, 
    CASE 
        WHEN CAST(success AS VARCHAR) = 't' THEN true 
        WHEN CAST(success AS VARCHAR) = 'f' THEN false
        ELSE NULL 
    END AS success_boolean
from source



    where ts NOT IN (SELECT ts FROM "iceberg"."analytics_source"."src_auth_events")

  
[0m15:13:03.658789 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:03.790893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.132 seconds
[0m15:13:03.799379 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:13:03.799911 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:13:03.904879 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.104 seconds
[0m15:13:03.908168 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:13:03.908692 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m15:13:04.019564 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m15:13:04.026882 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:13:04.027979 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m15:13:04.144704 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.117 seconds
[0m15:13:04.159000 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_auth_events"
[0m15:13:04.160582 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:13:04.161102 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */
insert into "iceberg"."analytics_source"."src_auth_events" ("id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean")
    (
        select "id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean"
        from "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
    )
[0m15:13:04.452029 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.292 seconds
[0m15:13:04.458471 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:13:04.458471 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:13:04.458471 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    drop view if exists "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:13:04.521599 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.061 seconds
[0m15:13:04.527608 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: ROLLBACK
[0m15:13:04.527608 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: Close
[0m15:13:04.527608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B5A8750>]}
[0m15:13:04.527608 [info ] [Thread-1 (]: 1 of 15 OK created sql incremental model analytics_source.src_auth_events ...... [[32mSUCCESS[0m in 0.92s]
[0m15:13:04.537677 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_auth_events
[0m15:13:04.537677 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_listen_events
[0m15:13:04.538187 [info ] [Thread-1 (]: 2 of 15 START sql incremental model analytics_source.src_listen_events ......... [RUN]
[0m15:13:04.538187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_auth_events, now model.my_dbt_trino_project.src_listen_events)
[0m15:13:04.538187 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_listen_events
[0m15:13:04.538187 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_listen_events"
[0m15:13:04.538187 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_listen_events
[0m15:13:04.546207 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:13:04.546207 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
  security definer
  as
    

with source as (

    select
        CAST(_id AS VARCHAR) as id,
        artist,
        song,
        CAST(NULLIF(duration, '') AS DOUBLE) as duration,
        ts,
        sessionid,
        auth,
        level,
        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,
        city,
        zip,
        state,
        country,
        userAgent,
        CAST(NULLIF(lon, '') AS DOUBLE) as lon,
        CAST(NULLIF(lat, '') AS DOUBLE) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,
 -- Assurez-vous que userId peut aussi être converti de cette manière.
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration
    from "mongo"."demo"."listen_events"

)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_listen_events")

  
[0m15:13:04.546207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:04.593644 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.044 seconds
[0m15:13:04.595130 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:13:04.597140 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:13:04.711299 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m15:13:04.712809 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:13:04.712809 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m15:13:04.837689 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.123 seconds
[0m15:13:04.839798 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:13:04.839798 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m15:13:04.952138 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.112 seconds
[0m15:13:04.952138 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_listen_events"
[0m15:13:04.952138 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:13:04.952138 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */
insert into "iceberg"."analytics_source"."src_listen_events" ("id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration")
    (
        select "id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration"
        from "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
    )
[0m15:13:05.360064 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.401 seconds
[0m15:13:05.363769 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:13:05.364820 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:13:05.364820 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    drop view if exists "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:13:05.432127 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.067 seconds
[0m15:13:05.434636 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: ROLLBACK
[0m15:13:05.435193 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: Close
[0m15:13:05.435742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548CF92290>]}
[0m15:13:05.436271 [info ] [Thread-1 (]: 2 of 15 OK created sql incremental model analytics_source.src_listen_events .... [[32mSUCCESS[0m in 0.90s]
[0m15:13:05.437330 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_listen_events
[0m15:13:05.439189 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_page_view_events
[0m15:13:05.439999 [info ] [Thread-1 (]: 3 of 15 START sql incremental model analytics_source.src_page_view_events ...... [RUN]
[0m15:13:05.440524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_listen_events, now model.my_dbt_trino_project.src_page_view_events)
[0m15:13:05.441052 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_page_view_events
[0m15:13:05.444229 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:05.444750 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_page_view_events
[0m15:13:05.450666 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:05.451196 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(_id AS VARCHAR) as id,
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        page,
        auth,
        level,
        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, 
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, 
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, 
        artist,
        song,
        CAST(NULLIF(duration, '') AS double) as duration
    from "mongo"."demo"."page_view_events"
)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_page_view_events")

  
[0m15:13:05.451720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:05.509179 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.058 seconds
[0m15:13:05.512743 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:05.513277 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:13:05.618082 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.105 seconds
[0m15:13:05.622109 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:05.622617 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m15:13:05.726824 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.105 seconds
[0m15:13:05.731337 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:05.731337 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m15:13:05.842223 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m15:13:05.844546 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:05.846514 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:05.846514 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */
insert into "iceberg"."analytics_source"."src_page_view_events" ("id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration")
    (
        select "id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration"
        from "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
    )
[0m15:13:06.207763 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.360 seconds
[0m15:13:06.207763 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:13:06.210928 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:13:06.210928 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    drop view if exists "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:13:06.273447 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.062 seconds
[0m15:13:06.275560 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: ROLLBACK
[0m15:13:06.276073 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: Close
[0m15:13:06.276597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548CF62AD0>]}
[0m15:13:06.277652 [info ] [Thread-1 (]: 3 of 15 OK created sql incremental model analytics_source.src_page_view_events . [[32mSUCCESS[0m in 0.84s]
[0m15:13:06.278231 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_page_view_events
[0m15:13:06.279476 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:13:06.279476 [info ] [Thread-1 (]: 4 of 15 START sql view model analytics_stage.stg_user_level_by_gender .......... [RUN]
[0m15:13:06.279476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_page_view_events, now model.my_dbt_trino_project.stg_user_level_by_gender)
[0m15:13:06.279476 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:13:06.285217 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:13:06.285217 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:13:06.349664 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:13:06.353731 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:13:06.353731 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_level_by_gender"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_level_by_gender"
  security definer
  as
    

WITH user_subscriptions AS (
    SELECT
        gender,
        level, 
        COUNT(DISTINCT userId) AS user_count
    FROM "iceberg"."analytics_source"."src_auth_events"
    WHERE gender IS NOT NULL AND level IS NOT NULL
    GROUP BY gender, level
)

SELECT
    gender,
    level,
    user_count
FROM user_subscriptions
  
[0m15:13:06.353731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:06.435998 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.083 seconds
[0m15:13:06.440136 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: ROLLBACK
[0m15:13:06.440136 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: Close
[0m15:13:06.442792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548720EF90>]}
[0m15:13:06.443757 [info ] [Thread-1 (]: 4 of 15 OK created sql view model analytics_stage.stg_user_level_by_gender ..... [[32mSUCCESS[0m in 0.16s]
[0m15:13:06.443757 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:13:06.444765 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_streams_hourly
[0m15:13:06.444765 [info ] [Thread-1 (]: 5 of 15 START sql table model analytics_stage.stg_streams_hourly ............... [RUN]
[0m15:13:06.447715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_level_by_gender, now model.my_dbt_trino_project.stg_streams_hourly)
[0m15:13:06.447715 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_streams_hourly
[0m15:13:06.448386 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:13:06.448386 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_streams_hourly
[0m15:13:06.475156 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:13:06.475156 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:13:06.475156 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

  
    

    create table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp"
      
      
    as (
      

SELECT
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, 
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,
    COUNT(*) AS total_streams
FROM "iceberg"."analytics_source"."src_listen_events"
GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')
    )
[0m15:13:06.475156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:06.751775 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.274 seconds
[0m15:13:06.759699 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:13:06.759699 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly" rename to "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:13:06.824922 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.067 seconds
[0m15:13:06.824922 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:13:06.824922 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp" rename to "iceberg"."analytics_stage"."stg_streams_hourly"
[0m15:13:06.896227 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.064 seconds
[0m15:13:06.899137 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:13:06.899137 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:13:06.899137 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

    drop table if exists "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:13:07.020455 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m15:13:07.020455 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: ROLLBACK
[0m15:13:07.020455 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: Close
[0m15:13:07.020455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548AB71B10>]}
[0m15:13:07.020455 [info ] [Thread-1 (]: 5 of 15 OK created sql table model analytics_stage.stg_streams_hourly .......... [[32mSUCCESS[0m in 0.57s]
[0m15:13:07.020455 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_streams_hourly
[0m15:13:07.020455 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:13:07.020455 [info ] [Thread-1 (]: 6 of 15 START sql view model analytics_stage.stg_top_songs_artists ............. [RUN]
[0m15:13:07.028257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_streams_hourly, now model.my_dbt_trino_project.stg_top_songs_artists)
[0m15:13:07.028257 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:13:07.029882 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:13:07.029882 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:13:07.029882 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:13:07.035820 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:13:07.037284 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_top_songs_artists"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_top_songs_artists"
  security definer
  as
    

WITH song_plays AS (
    SELECT
        artist,
        song,
        COUNT(*) AS play_count
    FROM "iceberg"."analytics_source"."src_listen_events"
    GROUP BY artist, song
)

SELECT
    artist,
    song,
    play_count
FROM song_plays
ORDER BY play_count DESC
  
[0m15:13:07.037284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:07.109814 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m15:13:07.119832 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: ROLLBACK
[0m15:13:07.119832 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: Close
[0m15:13:07.119832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548720EFD0>]}
[0m15:13:07.119832 [info ] [Thread-1 (]: 6 of 15 OK created sql view model analytics_stage.stg_top_songs_artists ........ [[32mSUCCESS[0m in 0.10s]
[0m15:13:07.119832 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:13:07.119832 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_unique_users
[0m15:13:07.119832 [info ] [Thread-1 (]: 7 of 15 START sql view model analytics_stage.stg_unique_users .................. [RUN]
[0m15:13:07.119832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_top_songs_artists, now model.my_dbt_trino_project.stg_unique_users)
[0m15:13:07.119832 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_unique_users
[0m15:13:07.130263 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_unique_users"
[0m15:13:07.131273 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_unique_users
[0m15:13:07.132291 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_unique_users"
[0m15:13:07.135812 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_unique_users"
[0m15:13:07.135812 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_unique_users"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_unique_users"
  security definer
  as
    

SELECT
    COUNT(DISTINCT userid) AS total_unique_users
FROM "iceberg"."analytics_source"."src_listen_events"
WHERE userid IS NOT NULL
  
[0m15:13:07.135812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:07.206299 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.070 seconds
[0m15:13:07.208431 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: ROLLBACK
[0m15:13:07.208431 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: Close
[0m15:13:07.208431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548CA7B910>]}
[0m15:13:07.208431 [info ] [Thread-1 (]: 7 of 15 OK created sql view model analytics_stage.stg_unique_users ............. [[32mSUCCESS[0m in 0.09s]
[0m15:13:07.208431 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_unique_users
[0m15:13:07.208431 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:13:07.208431 [info ] [Thread-1 (]: 8 of 15 START sql view model analytics_stage.stg_user_activity_per_country ..... [RUN]
[0m15:13:07.213324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_unique_users, now model.my_dbt_trino_project.stg_user_activity_per_country)
[0m15:13:07.213324 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:13:07.213324 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:13:07.213324 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:13:07.213324 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:13:07.221237 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:13:07.221237 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_country"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_country"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    country,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  WHERE country IS NOT NULL
  UNION ALL
  SELECT
    'Unknown' AS country,
    'auth_event' AS event_type, 
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    'Unknown' AS country, 
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  country,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY country
  
[0m15:13:07.221237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:07.304834 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:13:07.306946 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: ROLLBACK
[0m15:13:07.307475 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: Close
[0m15:13:07.308531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B3B48D0>]}
[0m15:13:07.309070 [info ] [Thread-1 (]: 8 of 15 OK created sql view model analytics_stage.stg_user_activity_per_country  [[32mSUCCESS[0m in 0.10s]
[0m15:13:07.310138 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:13:07.312409 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:13:07.312920 [info ] [Thread-1 (]: 9 of 15 START sql view model analytics_stage.stg_user_activity_per_location .... [RUN]
[0m15:13:07.313984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_country, now model.my_dbt_trino_project.stg_user_activity_per_location)
[0m15:13:07.314518 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:13:07.319290 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:13:07.320354 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:13:07.325120 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:13:07.327232 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:13:07.327756 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_location"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_location"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    city,
    state,
    'auth_event' AS event_type,
    ts,
    userid
 FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    city,
    state,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  UNION ALL
  SELECT
    city,
    state,
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  state,
  city,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY state, city
  
[0m15:13:07.328282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:07.418554 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m15:13:07.423270 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: ROLLBACK
[0m15:13:07.423270 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: Close
[0m15:13:07.425782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B64D0D0>]}
[0m15:13:07.426186 [info ] [Thread-1 (]: 9 of 15 OK created sql view model analytics_stage.stg_user_activity_per_location  [[32mSUCCESS[0m in 0.11s]
[0m15:13:07.426186 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:13:07.426186 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:13:07.426186 [info ] [Thread-1 (]: 10 of 15 START sql table model analytics.mart_user_level_by_gender ............. [RUN]
[0m15:13:07.426186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_location, now model.my_dbt_trino_project.mart_user_level_by_gender)
[0m15:13:07.426186 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:13:07.426186 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:13:07.426186 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:13:07.436308 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:13:07.436308 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:13:07.438422 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

  
    

    create table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp"
      
      
    as (
      

SELECT
    gender,
    level,
    SUM(user_count) AS total_users,
    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users
FROM "iceberg"."analytics_stage"."stg_user_level_by_gender"
GROUP BY gender, level
    )
[0m15:13:07.438422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:07.739060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.302 seconds
[0m15:13:07.744462 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:13:07.744462 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender" rename to "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:13:07.818489 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m15:13:07.818489 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:13:07.818489 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp" rename to "iceberg"."analytics"."mart_user_level_by_gender"
[0m15:13:07.891273 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m15:13:07.895001 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:13:07.896002 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:13:07.896002 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

    drop table if exists "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:13:08.031765 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.135 seconds
[0m15:13:08.033766 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: ROLLBACK
[0m15:13:08.033766 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: Close
[0m15:13:08.034765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548AEC64D0>]}
[0m15:13:08.035768 [info ] [Thread-1 (]: 10 of 15 OK created sql table model analytics.mart_user_level_by_gender ........ [[32mSUCCESS[0m in 0.61s]
[0m15:13:08.035768 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:13:08.037023 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:13:08.037535 [info ] [Thread-1 (]: 11 of 15 START sql table model analytics.mart_hourly_stream_evolution .......... [RUN]
[0m15:13:08.037535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_level_by_gender, now model.my_dbt_trino_project.mart_hourly_stream_evolution)
[0m15:13:08.037535 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:13:08.041561 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:13:08.041561 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:13:08.045570 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:13:08.047075 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:13:08.047715 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

  
    

    create table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp"
      
      
    as (
      

SELECT
    stream_date,
    stream_hour,
    total_streams,
    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams
FROM "iceberg"."analytics_stage"."stg_streams_hourly"
ORDER BY
    stream_date,
    stream_hour
    )
[0m15:13:08.047715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:08.278290 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.232 seconds
[0m15:13:08.282302 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:13:08.282302 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution" rename to "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:13:08.365777 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:13:08.365777 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:13:08.365777 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp" rename to "iceberg"."analytics"."mart_hourly_stream_evolution"
[0m15:13:08.436042 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m15:13:08.436042 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:13:08.436042 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:13:08.436042 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

    drop table if exists "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:13:08.566375 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m15:13:08.567977 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: ROLLBACK
[0m15:13:08.568504 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: Close
[0m15:13:08.569028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B654250>]}
[0m15:13:08.569556 [info ] [Thread-1 (]: 11 of 15 OK created sql table model analytics.mart_hourly_stream_evolution ..... [[32mSUCCESS[0m in 0.53s]
[0m15:13:08.570097 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:13:08.570625 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:13:08.571152 [info ] [Thread-1 (]: 12 of 15 START sql table model analytics.mart_top_songs_artists ................ [RUN]
[0m15:13:08.571678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_hourly_stream_evolution, now model.my_dbt_trino_project.mart_top_songs_artists)
[0m15:13:08.572202 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:13:08.574869 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:13:08.575939 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:13:08.579124 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:13:08.579124 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:13:08.579124 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

  
    

    create table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp"
      
      
    as (
      

WITH top_songs AS (
    SELECT
        artist,
        song,
        play_count
    FROM "iceberg"."analytics_stage"."stg_top_songs_artists"
)

SELECT
    artist,
    song,
    play_count
FROM top_songs
    )
[0m15:13:08.579124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:08.829439 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.247 seconds
[0m15:13:08.832908 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:13:08.832908 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists" rename to "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:13:08.917997 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.084 seconds
[0m15:13:08.917997 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:13:08.917997 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp" rename to "iceberg"."analytics"."mart_top_songs_artists"
[0m15:13:08.982598 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m15:13:08.982598 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:13:08.982598 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:13:08.982598 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

    drop table if exists "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:13:09.090895 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m15:13:09.090895 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: ROLLBACK
[0m15:13:09.100379 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: Close
[0m15:13:09.100379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548CECA250>]}
[0m15:13:09.100379 [info ] [Thread-1 (]: 12 of 15 OK created sql table model analytics.mart_top_songs_artists ........... [[32mSUCCESS[0m in 0.53s]
[0m15:13:09.100379 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:13:09.100379 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_total_unique_users
[0m15:13:09.100379 [info ] [Thread-1 (]: 13 of 15 START sql table model analytics.mart_total_unique_users ............... [RUN]
[0m15:13:09.100379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_top_songs_artists, now model.my_dbt_trino_project.mart_total_unique_users)
[0m15:13:09.100379 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_total_unique_users
[0m15:13:09.100379 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:13:09.100379 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_total_unique_users
[0m15:13:09.100379 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:13:09.100379 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:13:09.113020 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

  
    

    create table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp"
      
      
    as (
      

SELECT
    total_unique_users
FROM "iceberg"."analytics_stage"."stg_unique_users"
    )
[0m15:13:09.113020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:09.345442 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.232 seconds
[0m15:13:09.349057 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:13:09.349057 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users" rename to "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:13:09.420312 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.071 seconds
[0m15:13:09.420312 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:13:09.420312 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp" rename to "iceberg"."analytics"."mart_total_unique_users"
[0m15:13:09.498507 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:13:09.501404 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:13:09.504803 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:13:09.505303 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

    drop table if exists "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:13:09.616058 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.111 seconds
[0m15:13:09.616058 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: ROLLBACK
[0m15:13:09.616058 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: Close
[0m15:13:09.616058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548CF35E90>]}
[0m15:13:09.616058 [info ] [Thread-1 (]: 13 of 15 OK created sql table model analytics.mart_total_unique_users .......... [[32mSUCCESS[0m in 0.52s]
[0m15:13:09.619585 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_total_unique_users
[0m15:13:09.619585 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:13:09.619585 [info ] [Thread-1 (]: 14 of 15 START sql table model analytics.mart_user_activity_per_country ........ [RUN]
[0m15:13:09.619585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_total_unique_users, now model.my_dbt_trino_project.mart_user_activity_per_country)
[0m15:13:09.619585 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:13:09.619585 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:13:09.619585 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:13:09.630091 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:13:09.630091 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:13:09.630091 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp"
      
      
    as (
      

SELECT
  country,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_country"
GROUP BY country
ORDER BY SUM(activity_count) DESC
    )
[0m15:13:09.630091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:09.964535 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.335 seconds
[0m15:13:09.964535 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:13:09.964535 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country" rename to "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:13:10.042781 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m15:13:10.042781 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:13:10.042781 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_country"
[0m15:13:10.134171 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m15:13:10.138178 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:13:10.138178 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:13:10.138178 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:13:10.255154 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:13:10.255154 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: ROLLBACK
[0m15:13:10.255154 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: Close
[0m15:13:10.255154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548B31E0D0>]}
[0m15:13:10.255154 [info ] [Thread-1 (]: 14 of 15 OK created sql table model analytics.mart_user_activity_per_country ... [[32mSUCCESS[0m in 0.64s]
[0m15:13:10.260777 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:13:10.261281 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:13:10.263451 [info ] [Thread-1 (]: 15 of 15 START sql table model analytics.mart_user_activity_per_state .......... [RUN]
[0m15:13:10.263451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_activity_per_country, now model.my_dbt_trino_project.mart_user_activity_per_state)
[0m15:13:10.263451 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:13:10.264957 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:13:10.264957 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:13:10.264957 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:13:10.264957 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:13:10.264957 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp"
      
      
    as (
      

SELECT
  state,
  city,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_location"
GROUP BY state, city
ORDER BY state, SUM(activity_count) DESC
    )
[0m15:13:10.264957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:10.566281 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.293 seconds
[0m15:13:10.566750 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:13:10.566750 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state" rename to "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:13:10.639306 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m15:13:10.644373 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:13:10.644921 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_state"
[0m15:13:10.711467 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.070 seconds
[0m15:13:10.711467 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:13:10.719931 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:13:10.719931 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:13:10.839829 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.119 seconds
[0m15:13:10.841837 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: ROLLBACK
[0m15:13:10.842834 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: Close
[0m15:13:10.842834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0df3adf-0e95-45c7-b98a-1e6bbed5a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548CF78510>]}
[0m15:13:10.842834 [info ] [Thread-1 (]: 15 of 15 OK created sql table model analytics.mart_user_activity_per_state ..... [[32mSUCCESS[0m in 0.58s]
[0m15:13:10.844333 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:13:10.845339 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.845339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:10.846843 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:13:10.846843 [debug] [MainThread]: Connection 'list_iceberg_analytics_stage' was properly closed.
[0m15:13:10.846843 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.mart_user_activity_per_state' was properly closed.
[0m15:13:10.847868 [info ] [MainThread]: 
[0m15:13:10.847868 [info ] [MainThread]: Finished running 3 incremental models, 5 view models, 7 table models in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m15:13:10.850866 [debug] [MainThread]: Command end result
[0m15:13:10.889804 [info ] [MainThread]: 
[0m15:13:10.889804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:10.889804 [info ] [MainThread]: 
[0m15:13:10.889804 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m15:13:10.889804 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:10.889804 after 8.33 seconds
[0m15:13:10.889804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025486319A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548627BB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548627BAD0>]}
[0m15:13:10.889804 [debug] [MainThread]: Flushing usage events
[0m15:14:48.732694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141951A4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141951F3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141951F3BD0>]}


============================== 15:14:48.732694 | 0de06732-9aec-40ba-a2ab-e07e43c8da25 ==============================
[0m15:14:48.732694 [info ] [MainThread]: Running with dbt=1.8.5
[0m15:14:48.732694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:14:48.748344 [info ] [MainThread]: dbt version: 1.8.5
[0m15:14:48.748344 [info ] [MainThread]: python version: 3.11.5
[0m15:14:48.748344 [info ] [MainThread]: python path: C:\Users\ASUS\Desktop\work\datalake\dbt\dbt-venv\Scripts\python.exe
[0m15:14:48.748344 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m15:14:48.808741 [info ] [MainThread]: Using profiles dir at C:\Users\ASUS\Desktop\work\datalake\dbt
[0m15:14:48.811268 [info ] [MainThread]: Using profiles.yml file at C:\Users\ASUS\Desktop\work\datalake\dbt\profiles.yml
[0m15:14:48.811268 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ASUS\Desktop\work\datalake\dbt\dbt_project.yml
[0m15:14:48.811268 [info ] [MainThread]: adapter type: trino
[0m15:14:48.811268 [info ] [MainThread]: adapter version: 1.8.1
[0m15:14:48.874234 [info ] [MainThread]: Configuration:
[0m15:14:48.874234 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:14:48.874234 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:14:48.874234 [info ] [MainThread]: Required dependencies:
[0m15:14:48.874234 [debug] [MainThread]: Executing "git --help"
[0m15:14:48.952880 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:14:48.952880 [debug] [MainThread]: STDERR: "b''"
[0m15:14:48.952880 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:14:48.952880 [info ] [MainThread]: Connection:
[0m15:14:48.952880 [info ] [MainThread]:   host: localhost
[0m15:14:48.952880 [info ] [MainThread]:   port: 8080
[0m15:14:48.952880 [info ] [MainThread]:   user: minio
[0m15:14:48.952880 [info ] [MainThread]:   database: iceberg
[0m15:14:48.952880 [info ] [MainThread]:   schema: analytics
[0m15:14:48.968486 [info ] [MainThread]:   cert: None
[0m15:14:48.968486 [info ] [MainThread]:   prepared_statements_enabled: True
[0m15:14:48.968486 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m15:14:48.968486 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m15:14:49.015872 [debug] [MainThread]: Using trino connection "debug"
[0m15:14:49.015872 [debug] [MainThread]: On debug: select 1 as id
[0m15:14:49.015872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:49.056700 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m15:14:49.056700 [debug] [MainThread]: On debug: Close
[0m15:14:49.056700 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:14:49.056700 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:14:49.056700 [debug] [MainThread]: Command `dbt debug` succeeded at 15:14:49.056700 after 0.42 seconds
[0m15:14:49.063209 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:14:49.063209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014190509A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014195533C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419046BAD0>]}
[0m15:14:49.063209 [debug] [MainThread]: Flushing usage events
[0m15:18:04.417864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162886B2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016288934190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016288935AD0>]}


============================== 15:18:04.417864 | c145023f-7ca4-441f-ab60-109800c913c4 ==============================
[0m15:18:04.417864 [info ] [MainThread]: Running with dbt=1.8.5
[0m15:18:04.417864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models source', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:04.562821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162889010D0>]}
[0m15:18:04.592409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016288808D50>]}
[0m15:18:04.592409 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m15:18:04.608062 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m15:18:04.772358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:04.773355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:04.817908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016288F4C0D0>]}
[0m15:18:04.895429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016288F0A150>]}
[0m15:18:04.895429 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m15:18:04.895429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162887F3B50>]}
[0m15:18:04.895429 [info ] [MainThread]: 
[0m15:18:04.895429 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:18:04.911064 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:18:04.974162 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:18:04.974162 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:18:04.974162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:05.176356 [debug] [ThreadPool]: SQL status: SUCCESS in 0.200 seconds
[0m15:18:05.176356 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:18:05.179650 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics_stage'
[0m15:18:05.199220 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m15:18:05.199220 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m15:18:05.199220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:05.604911 [debug] [ThreadPool]: SQL status: SUCCESS in 0.404 seconds
[0m15:18:05.606997 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m15:18:05.607525 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m15:18:05.608576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_stage, now list_iceberg_analytics_source)
[0m15:18:05.613237 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m15:18:05.614399 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m15:18:05.614906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:05.796184 [debug] [ThreadPool]: SQL status: SUCCESS in 0.182 seconds
[0m15:18:05.796184 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m15:18:05.796184 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m15:18:05.799705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics)
[0m15:18:05.803508 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m15:18:05.803508 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m15:18:05.805023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:05.957588 [debug] [ThreadPool]: SQL status: SUCCESS in 0.154 seconds
[0m15:18:05.960161 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m15:18:05.960161 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m15:18:05.961674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016288936B10>]}
[0m15:18:05.963387 [debug] [MainThread]: On master: COMMIT
[0m15:18:05.963387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:05.963901 [info ] [MainThread]: 
[0m15:18:05.968034 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_auth_events
[0m15:18:05.968034 [info ] [Thread-1 (]: 1 of 3 START sql incremental model analytics_source.src_auth_events ............ [RUN]
[0m15:18:05.968034 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.src_auth_events'
[0m15:18:05.969862 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_auth_events
[0m15:18:05.979502 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_auth_events"
[0m15:18:05.979502 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_auth_events
[0m15:18:06.019556 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:18:06.019556 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(ts AS VARCHAR) as id, 
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        level,
        itemInSession,
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, 
        lastName,
        firstName,
        gender,
        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,
        success
    from "postgresql"."public"."auth_events"
)

select
    id,
    ts,
    sessionId,
    level,
    itemInSession,
    city,
    zip,
    state,
    userAgent,
    lon,
    lat,
    userId,
    lastName,
    firstName,
    gender,
    registration, 
    CASE 
        WHEN CAST(success AS VARCHAR) = 't' THEN true 
        WHEN CAST(success AS VARCHAR) = 'f' THEN false
        ELSE NULL 
    END AS success_boolean
from source



    where ts NOT IN (SELECT ts FROM "iceberg"."analytics_source"."src_auth_events")

  
[0m15:18:06.019556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:06.171146 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.152 seconds
[0m15:18:06.179371 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:18:06.179371 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:18:06.287622 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m15:18:06.296550 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:18:06.296550 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m15:18:06.437665 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.141 seconds
[0m15:18:06.445728 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:18:06.448747 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m15:18:06.582750 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.134 seconds
[0m15:18:06.590963 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_auth_events"
[0m15:18:06.594210 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:18:06.594210 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */
insert into "iceberg"."analytics_source"."src_auth_events" ("id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean")
    (
        select "id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean"
        from "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
    )
[0m15:18:07.124518 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.529 seconds
[0m15:18:07.132014 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:18:07.136582 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m15:18:07.137101 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    drop view if exists "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m15:18:07.205536 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.068 seconds
[0m15:18:07.221969 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: ROLLBACK
[0m15:18:07.222474 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: Close
[0m15:18:07.224069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162893B7310>]}
[0m15:18:07.225125 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model analytics_source.src_auth_events ....... [[32mSUCCESS[0m in 1.25s]
[0m15:18:07.226171 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_auth_events
[0m15:18:07.226171 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_listen_events
[0m15:18:07.226691 [info ] [Thread-1 (]: 2 of 3 START sql incremental model analytics_source.src_listen_events .......... [RUN]
[0m15:18:07.227220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_auth_events, now model.my_dbt_trino_project.src_listen_events)
[0m15:18:07.227749 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_listen_events
[0m15:18:07.229273 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.229273 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_listen_events
[0m15:18:07.237557 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.238083 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
  security definer
  as
    

with source as (

    select
        CAST(_id AS VARCHAR) as id,
        artist,
        song,
        CAST(NULLIF(duration, '') AS DOUBLE) as duration,
        ts,
        sessionid,
        auth,
        level,
        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,
        city,
        zip,
        state,
        country,
        userAgent,
        CAST(NULLIF(lon, '') AS DOUBLE) as lon,
        CAST(NULLIF(lat, '') AS DOUBLE) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,
 -- Assurez-vous que userId peut aussi être converti de cette manière.
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration
    from "mongo"."demo"."listen_events"

)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_listen_events")

  
[0m15:18:07.238083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:07.316417 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m15:18:07.317938 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.320818 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:18:07.428685 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.107 seconds
[0m15:18:07.435108 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.436169 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m15:18:07.560908 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m15:18:07.564513 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.564513 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m15:18:07.676535 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.111 seconds
[0m15:18:07.677044 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.677044 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.677044 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */
insert into "iceberg"."analytics_source"."src_listen_events" ("id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration")
    (
        select "id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration"
        from "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
    )
[0m15:18:07.927136 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.247 seconds
[0m15:18:07.929162 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:18:07.932750 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m15:18:07.932750 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    drop view if exists "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m15:18:07.995889 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m15:18:07.995889 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: ROLLBACK
[0m15:18:07.995889 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: Close
[0m15:18:07.995889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016284B4A190>]}
[0m15:18:07.999405 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model analytics_source.src_listen_events ..... [[32mSUCCESS[0m in 0.77s]
[0m15:18:07.999923 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_listen_events
[0m15:18:07.999923 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_page_view_events
[0m15:18:07.999923 [info ] [Thread-1 (]: 3 of 3 START sql incremental model analytics_source.src_page_view_events ....... [RUN]
[0m15:18:07.999923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_listen_events, now model.my_dbt_trino_project.src_page_view_events)
[0m15:18:08.003939 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_page_view_events
[0m15:18:08.008983 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.008983 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_page_view_events
[0m15:18:08.013523 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.019038 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(_id AS VARCHAR) as id,
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        page,
        auth,
        level,
        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, 
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, 
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, 
        artist,
        song,
        CAST(NULLIF(duration, '') AS double) as duration
    from "mongo"."demo"."page_view_events"
)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_page_view_events")

  
[0m15:18:08.019038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:08.094552 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:18:08.098879 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.098879 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:18:08.212477 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m15:18:08.216065 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.216576 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m15:18:08.333295 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:18:08.336325 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.336325 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m15:18:08.440968 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.103 seconds
[0m15:18:08.442999 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.442999 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.442999 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */
insert into "iceberg"."analytics_source"."src_page_view_events" ("id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration")
    (
        select "id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration"
        from "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
    )
[0m15:18:08.674928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.229 seconds
[0m15:18:08.678992 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:18:08.678992 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m15:18:08.678992 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    drop view if exists "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m15:18:08.753549 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.074 seconds
[0m15:18:08.753549 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: ROLLBACK
[0m15:18:08.757063 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: Close
[0m15:18:08.757063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c145023f-7ca4-441f-ab60-109800c913c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001628983EF10>]}
[0m15:18:08.758481 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model analytics_source.src_page_view_events .. [[32mSUCCESS[0m in 0.76s]
[0m15:18:08.758481 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_page_view_events
[0m15:18:08.758481 [debug] [MainThread]: On master: COMMIT
[0m15:18:08.760989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:08.760989 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:18:08.760989 [debug] [MainThread]: Connection 'list_iceberg_analytics' was properly closed.
[0m15:18:08.760989 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.src_page_view_events' was properly closed.
[0m15:18:08.760989 [info ] [MainThread]: 
[0m15:18:08.760989 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m15:18:08.760989 [debug] [MainThread]: Command end result
[0m15:18:08.845009 [info ] [MainThread]: 
[0m15:18:08.845009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:08.845009 [info ] [MainThread]: 
[0m15:18:08.845009 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:18:08.845009 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:08.845009 after 4.55 seconds
[0m15:18:08.845009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016283C41E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016283BCAFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016283BB88D0>]}
[0m15:18:08.845009 [debug] [MainThread]: Flushing usage events
[0m15:18:18.527266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025098A608D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025098A60A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025098A61650>]}


============================== 15:18:18.527266 | 1bbe6219-3855-478d-be6d-2876e668255e ==============================
[0m15:18:18.527266 [info ] [MainThread]: Running with dbt=1.8.5
[0m15:18:18.527266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stage', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:18:18.671948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025098DCD2D0>]}
[0m15:18:18.700618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025095EA2BD0>]}
[0m15:18:18.700618 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m15:18:18.723521 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m15:18:18.856419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:18.856419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:18.891697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250990583D0>]}
[0m15:18:18.985030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025098DB2610>]}
[0m15:18:18.986071 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m15:18:18.987168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025098F48F50>]}
[0m15:18:18.989247 [info ] [MainThread]: 
[0m15:18:18.990245 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:18:18.995418 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:18:19.050952 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:18:19.050952 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:18:19.050952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:19.101670 [debug] [ThreadPool]: SQL status: SUCCESS in 0.048 seconds
[0m15:18:19.101670 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:18:19.105092 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics_stage'
[0m15:18:19.117828 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m15:18:19.117828 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m15:18:19.117828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:19.185583 [debug] [ThreadPool]: SQL status: SUCCESS in 0.068 seconds
[0m15:18:19.185583 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m15:18:19.185583 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m15:18:19.185583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_stage, now list_iceberg_analytics_source)
[0m15:18:19.192496 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m15:18:19.192496 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m15:18:19.192496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:19.259484 [debug] [ThreadPool]: SQL status: SUCCESS in 0.066 seconds
[0m15:18:19.259484 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m15:18:19.259484 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m15:18:19.259484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics)
[0m15:18:19.267118 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m15:18:19.267118 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m15:18:19.267118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:19.347196 [debug] [ThreadPool]: SQL status: SUCCESS in 0.080 seconds
[0m15:18:19.348868 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m15:18:19.348868 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m15:18:19.350884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025097696E50>]}
[0m15:18:19.350884 [debug] [MainThread]: On master: COMMIT
[0m15:18:19.350884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:19.352557 [info ] [MainThread]: 
[0m15:18:19.354070 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_streams_hourly
[0m15:18:19.356094 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_stage.stg_streams_hourly ................ [RUN]
[0m15:18:19.356094 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.stg_streams_hourly'
[0m15:18:19.357570 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_streams_hourly
[0m15:18:19.360465 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:18:19.360465 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_streams_hourly
[0m15:18:19.397506 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:18:19.398558 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:18:19.399715 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

  
    

    create table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp"
      
      
    as (
      

SELECT
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, 
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,
    COUNT(*) AS total_streams
FROM "iceberg"."analytics_source"."src_listen_events"
GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')
    )
[0m15:18:19.399715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:19.710115 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.314 seconds
[0m15:18:19.719708 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:18:19.720230 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly" rename to "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:18:19.795802 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:18:19.801500 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:18:19.801500 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp" rename to "iceberg"."analytics_stage"."stg_streams_hourly"
[0m15:18:19.871243 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m15:18:19.877010 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:18:19.877010 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m15:18:19.877010 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

    drop table if exists "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m15:18:20.006670 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.127 seconds
[0m15:18:20.018559 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: ROLLBACK
[0m15:18:20.020481 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: Close
[0m15:18:20.020990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025099555050>]}
[0m15:18:20.022640 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_stage.stg_streams_hourly ........... [[32mSUCCESS[0m in 0.66s]
[0m15:18:20.022640 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_streams_hourly
[0m15:18:20.023570 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:18:20.023570 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics_stage.stg_top_songs_artists .............. [RUN]
[0m15:18:20.023570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_streams_hourly, now model.my_dbt_trino_project.stg_top_songs_artists)
[0m15:18:20.023570 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:18:20.023570 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:18:20.023570 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:18:20.037166 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:18:20.040412 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_top_songs_artists"
[0m15:18:20.040412 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_top_songs_artists"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_top_songs_artists"
  security definer
  as
    

WITH song_plays AS (
    SELECT
        artist,
        song,
        COUNT(*) AS play_count
    FROM "iceberg"."analytics_source"."src_listen_events"
    GROUP BY artist, song
)

SELECT
    artist,
    song,
    play_count
FROM song_plays
ORDER BY play_count DESC
  
[0m15:18:20.042483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:20.111626 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m15:18:20.116470 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: ROLLBACK
[0m15:18:20.116470 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: Close
[0m15:18:20.117442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250991078D0>]}
[0m15:18:20.117442 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics_stage.stg_top_songs_artists ......... [[32mSUCCESS[0m in 0.09s]
[0m15:18:20.117442 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_top_songs_artists
[0m15:18:20.117442 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_unique_users
[0m15:18:20.117442 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics_stage.stg_unique_users ................... [RUN]
[0m15:18:20.121049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_top_songs_artists, now model.my_dbt_trino_project.stg_unique_users)
[0m15:18:20.121049 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_unique_users
[0m15:18:20.121049 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_unique_users"
[0m15:18:20.121049 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_unique_users
[0m15:18:20.125713 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_unique_users"
[0m15:18:20.125713 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_unique_users"
[0m15:18:20.125713 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_unique_users"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_unique_users"
  security definer
  as
    

SELECT
    COUNT(DISTINCT userid) AS total_unique_users
FROM "iceberg"."analytics_source"."src_listen_events"
WHERE userid IS NOT NULL
  
[0m15:18:20.125713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:20.196380 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.070 seconds
[0m15:18:20.199904 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: ROLLBACK
[0m15:18:20.199904 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: Close
[0m15:18:20.199904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250990C4650>]}
[0m15:18:20.199904 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics_stage.stg_unique_users .............. [[32mSUCCESS[0m in 0.08s]
[0m15:18:20.199904 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_unique_users
[0m15:18:20.199904 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:18:20.199904 [info ] [Thread-1 (]: 4 of 6 START sql view model analytics_stage.stg_user_activity_per_country ...... [RUN]
[0m15:18:20.199904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_unique_users, now model.my_dbt_trino_project.stg_user_activity_per_country)
[0m15:18:20.199904 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:18:20.206121 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:18:20.206121 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:18:20.206121 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:18:20.212069 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m15:18:20.212069 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_country"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_country"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    country,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  WHERE country IS NOT NULL
  UNION ALL
  SELECT
    'Unknown' AS country,
    'auth_event' AS event_type, 
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    'Unknown' AS country, 
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  country,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY country
  
[0m15:18:20.212069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:20.281198 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.071 seconds
[0m15:18:20.281198 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: ROLLBACK
[0m15:18:20.281198 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: Close
[0m15:18:20.281198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250990EC9D0>]}
[0m15:18:20.281198 [info ] [Thread-1 (]: 4 of 6 OK created sql view model analytics_stage.stg_user_activity_per_country . [[32mSUCCESS[0m in 0.08s]
[0m15:18:20.288085 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m15:18:20.288085 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:18:20.289105 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics_stage.stg_user_activity_per_location ..... [RUN]
[0m15:18:20.289105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_country, now model.my_dbt_trino_project.stg_user_activity_per_location)
[0m15:18:20.289105 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:18:20.292690 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:18:20.292690 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:18:20.292690 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:18:20.292690 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m15:18:20.292690 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_location"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_location"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    city,
    state,
    'auth_event' AS event_type,
    ts,
    userid
 FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    city,
    state,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  UNION ALL
  SELECT
    city,
    state,
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  state,
  city,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY state, city
  
[0m15:18:20.292690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:20.375775 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:18:20.377179 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: ROLLBACK
[0m15:18:20.377179 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: Close
[0m15:18:20.377179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509951FC50>]}
[0m15:18:20.381199 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics_stage.stg_user_activity_per_location  [[32mSUCCESS[0m in 0.09s]
[0m15:18:20.382235 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m15:18:20.382235 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:18:20.382235 [info ] [Thread-1 (]: 6 of 6 START sql view model analytics_stage.stg_user_level_by_gender ........... [RUN]
[0m15:18:20.382235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_location, now model.my_dbt_trino_project.stg_user_level_by_gender)
[0m15:18:20.382235 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:18:20.386260 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:18:20.386260 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:18:20.389460 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:18:20.389460 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m15:18:20.389460 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_level_by_gender"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_level_by_gender"
  security definer
  as
    

WITH user_subscriptions AS (
    SELECT
        gender,
        level, 
        COUNT(DISTINCT userId) AS user_count
    FROM "iceberg"."analytics_source"."src_auth_events"
    WHERE gender IS NOT NULL AND level IS NOT NULL
    GROUP BY gender, level
)

SELECT
    gender,
    level,
    user_count
FROM user_subscriptions
  
[0m15:18:20.389460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:20.471478 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:18:20.472996 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: ROLLBACK
[0m15:18:20.472996 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: Close
[0m15:18:20.472996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbe6219-3855-478d-be6d-2876e668255e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025099611C90>]}
[0m15:18:20.472996 [info ] [Thread-1 (]: 6 of 6 OK created sql view model analytics_stage.stg_user_level_by_gender ...... [[32mSUCCESS[0m in 0.09s]
[0m15:18:20.472996 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m15:18:20.472996 [debug] [MainThread]: On master: COMMIT
[0m15:18:20.478024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:20.478024 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:18:20.479535 [debug] [MainThread]: Connection 'list_iceberg_analytics' was properly closed.
[0m15:18:20.479535 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.stg_user_level_by_gender' was properly closed.
[0m15:18:20.480381 [info ] [MainThread]: 
[0m15:18:20.480381 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m15:18:20.480381 [debug] [MainThread]: Command end result
[0m15:18:20.513074 [info ] [MainThread]: 
[0m15:18:20.515365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:20.515365 [info ] [MainThread]: 
[0m15:18:20.516559 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:18:20.517066 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:20.517066 after 2.09 seconds
[0m15:18:20.517066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025098831C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025094C01CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025093CFBB10>]}
[0m15:18:20.517066 [debug] [MainThread]: Flushing usage events
[0m15:18:41.823174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012914CE0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012914CE0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012914CE1950>]}


============================== 15:18:41.826179 | 4d7f157c-2686-4b5c-bf42-13f8b75fb64f ==============================
[0m15:18:41.826179 [info ] [MainThread]: Running with dbt=1.8.5
[0m15:18:41.827176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models mart', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:41.968522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012914BBEB90>]}
[0m15:18:42.007808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012912122B90>]}
[0m15:18:42.008812 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m15:18:42.023840 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m15:18:42.171316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:42.171316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:42.205827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012914C049D0>]}
[0m15:18:42.278835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129152E9B10>]}
[0m15:18:42.278835 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m15:18:42.279837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001291538FCD0>]}
[0m15:18:42.282916 [info ] [MainThread]: 
[0m15:18:42.282916 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:18:42.286919 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:18:42.342649 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:18:42.343650 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:18:42.343650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:42.375691 [debug] [ThreadPool]: SQL status: SUCCESS in 0.032 seconds
[0m15:18:42.377396 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:18:42.379151 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics_source'
[0m15:18:42.390162 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m15:18:42.390162 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m15:18:42.390162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:42.450683 [debug] [ThreadPool]: SQL status: SUCCESS in 0.060 seconds
[0m15:18:42.452506 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m15:18:42.454020 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m15:18:42.455053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics_stage)
[0m15:18:42.462076 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m15:18:42.463087 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m15:18:42.464084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:42.553712 [debug] [ThreadPool]: SQL status: SUCCESS in 0.089 seconds
[0m15:18:42.554231 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m15:18:42.555243 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m15:18:42.556850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_stage, now list_iceberg_analytics)
[0m15:18:42.563390 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m15:18:42.564450 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m15:18:42.564971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:42.651034 [debug] [ThreadPool]: SQL status: SUCCESS in 0.086 seconds
[0m15:18:42.653114 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m15:18:42.653637 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m15:18:42.655741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012915189DD0>]}
[0m15:18:42.656801 [debug] [MainThread]: On master: COMMIT
[0m15:18:42.657327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:42.657852 [info ] [MainThread]: 
[0m15:18:42.661527 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:18:42.662062 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.mart_hourly_stream_evolution ............ [RUN]
[0m15:18:42.663100 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.mart_hourly_stream_evolution'
[0m15:18:42.663100 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:18:42.666734 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:18:42.668536 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:18:42.704285 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:18:42.706286 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:18:42.707288 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

  
    

    create table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp"
      
      
    as (
      

SELECT
    stream_date,
    stream_hour,
    total_streams,
    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams
FROM "iceberg"."analytics_stage"."stg_streams_hourly"
ORDER BY
    stream_date,
    stream_hour
    )
[0m15:18:42.707288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:42.959432 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.252 seconds
[0m15:18:42.965406 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:18:42.965406 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution" rename to "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:18:43.050288 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.084 seconds
[0m15:18:43.053291 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:18:43.053291 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp" rename to "iceberg"."analytics"."mart_hourly_stream_evolution"
[0m15:18:43.129859 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:18:43.135420 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:18:43.137420 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m15:18:43.138422 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

    drop table if exists "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m15:18:43.255740 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m15:18:43.268948 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: ROLLBACK
[0m15:18:43.268948 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: Close
[0m15:18:43.270951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012916C0CC10>]}
[0m15:18:43.271947 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics.mart_hourly_stream_evolution ....... [[32mSUCCESS[0m in 0.61s]
[0m15:18:43.272949 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m15:18:43.272949 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:18:43.274983 [info ] [Thread-1 (]: 2 of 6 START sql table model analytics.mart_top_songs_artists .................. [RUN]
[0m15:18:43.274983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_hourly_stream_evolution, now model.my_dbt_trino_project.mart_top_songs_artists)
[0m15:18:43.276351 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:18:43.278364 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:18:43.279365 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:18:43.282879 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:18:43.283877 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:18:43.283877 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

  
    

    create table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp"
      
      
    as (
      

WITH top_songs AS (
    SELECT
        artist,
        song,
        play_count
    FROM "iceberg"."analytics_stage"."stg_top_songs_artists"
)

SELECT
    artist,
    song,
    play_count
FROM top_songs
    )
[0m15:18:43.284884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:43.530324 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.246 seconds
[0m15:18:43.534870 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:18:43.536443 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists" rename to "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:18:43.607293 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.071 seconds
[0m15:18:43.610831 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:18:43.611833 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp" rename to "iceberg"."analytics"."mart_top_songs_artists"
[0m15:18:43.677825 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m15:18:43.681820 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:18:43.682820 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m15:18:43.682820 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

    drop table if exists "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m15:18:43.782905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m15:18:43.784435 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: ROLLBACK
[0m15:18:43.785435 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: Close
[0m15:18:43.785435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012915311E90>]}
[0m15:18:43.785435 [info ] [Thread-1 (]: 2 of 6 OK created sql table model analytics.mart_top_songs_artists ............. [[32mSUCCESS[0m in 0.51s]
[0m15:18:43.786748 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_top_songs_artists
[0m15:18:43.787761 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_total_unique_users
[0m15:18:43.787761 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.mart_total_unique_users ................. [RUN]
[0m15:18:43.788762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_top_songs_artists, now model.my_dbt_trino_project.mart_total_unique_users)
[0m15:18:43.788762 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_total_unique_users
[0m15:18:43.791268 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:18:43.792276 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_total_unique_users
[0m15:18:43.795277 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:18:43.796275 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:18:43.797275 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

  
    

    create table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp"
      
      
    as (
      

SELECT
    total_unique_users
FROM "iceberg"."analytics_stage"."stg_unique_users"
    )
[0m15:18:43.797275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:44.051258 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.254 seconds
[0m15:18:44.055267 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:18:44.056265 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users" rename to "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:18:44.130421 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.074 seconds
[0m15:18:44.134941 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:18:44.134941 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp" rename to "iceberg"."analytics"."mart_total_unique_users"
[0m15:18:44.216794 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m15:18:44.219803 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:18:44.220804 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m15:18:44.220804 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

    drop table if exists "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m15:18:44.326289 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.105 seconds
[0m15:18:44.327296 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: ROLLBACK
[0m15:18:44.328296 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: Close
[0m15:18:44.328296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012916C70590>]}
[0m15:18:44.328296 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.mart_total_unique_users ............ [[32mSUCCESS[0m in 0.54s]
[0m15:18:44.329785 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_total_unique_users
[0m15:18:44.330789 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:18:44.330789 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.mart_user_activity_per_country .......... [RUN]
[0m15:18:44.330789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_total_unique_users, now model.my_dbt_trino_project.mart_user_activity_per_country)
[0m15:18:44.332304 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:18:44.335310 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:18:44.335310 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:18:44.341106 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:18:44.342114 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:18:44.342114 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp"
      
      
    as (
      

SELECT
  country,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_country"
GROUP BY country
ORDER BY SUM(activity_count) DESC
    )
[0m15:18:44.343115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:44.668692 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.326 seconds
[0m15:18:44.672896 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:18:44.673895 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country" rename to "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:18:44.754459 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m15:18:44.756900 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:18:44.758084 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_country"
[0m15:18:44.823455 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.065 seconds
[0m15:18:44.826059 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:18:44.827113 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m15:18:44.827113 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m15:18:44.941158 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m15:18:44.942737 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: ROLLBACK
[0m15:18:44.943259 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: Close
[0m15:18:44.943783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129151BBE90>]}
[0m15:18:44.944304 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.mart_user_activity_per_country ..... [[32mSUCCESS[0m in 0.61s]
[0m15:18:44.945360 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m15:18:44.945886 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:18:44.947750 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.mart_user_activity_per_state ............ [RUN]
[0m15:18:44.948287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_activity_per_country, now model.my_dbt_trino_project.mart_user_activity_per_state)
[0m15:18:44.948819 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:18:44.951345 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:18:44.952343 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:18:44.955465 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:18:44.956465 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:18:44.957465 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp"
      
      
    as (
      

SELECT
  state,
  city,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_location"
GROUP BY state, city
ORDER BY state, SUM(activity_count) DESC
    )
[0m15:18:44.957465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:45.236045 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.278 seconds
[0m15:18:45.239218 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:18:45.239218 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state" rename to "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:18:45.308827 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m15:18:45.313603 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:18:45.314662 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_state"
[0m15:18:45.390743 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:18:45.393814 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:18:45.393814 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m15:18:45.394811 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m15:18:45.502350 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.107 seconds
[0m15:18:45.503927 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: ROLLBACK
[0m15:18:45.503927 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: Close
[0m15:18:45.504445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012916CAA890>]}
[0m15:18:45.504970 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.mart_user_activity_per_state ....... [[32mSUCCESS[0m in 0.56s]
[0m15:18:45.506011 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m15:18:45.506011 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:18:45.507925 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.mart_user_level_by_gender ............... [RUN]
[0m15:18:45.508581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_activity_per_state, now model.my_dbt_trino_project.mart_user_level_by_gender)
[0m15:18:45.509086 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:18:45.511706 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:18:45.512231 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:18:45.567491 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:18:45.569094 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:18:45.569622 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

  
    

    create table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp"
      
      
    as (
      

SELECT
    gender,
    level,
    SUM(user_count) AS total_users,
    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users
FROM "iceberg"."analytics_stage"."stg_user_level_by_gender"
GROUP BY gender, level
    )
[0m15:18:45.569622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:45.833384 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.263 seconds
[0m15:18:45.835635 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:18:45.836632 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender" rename to "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:18:45.915445 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m15:18:45.919636 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:18:45.919636 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp" rename to "iceberg"."analytics"."mart_user_level_by_gender"
[0m15:18:45.984001 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.064 seconds
[0m15:18:45.986650 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:18:45.988056 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m15:18:45.988056 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

    drop table if exists "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m15:18:46.096851 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.108 seconds
[0m15:18:46.097852 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: ROLLBACK
[0m15:18:46.098851 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: Close
[0m15:18:46.098851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7f157c-2686-4b5c-bf42-13f8b75fb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001291577F1D0>]}
[0m15:18:46.099853 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.mart_user_level_by_gender .......... [[32mSUCCESS[0m in 0.59s]
[0m15:18:46.099853 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m15:18:46.101200 [debug] [MainThread]: On master: COMMIT
[0m15:18:46.102388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:46.102388 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:18:46.103396 [debug] [MainThread]: Connection 'list_iceberg_analytics' was properly closed.
[0m15:18:46.103396 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.mart_user_level_by_gender' was properly closed.
[0m15:18:46.103396 [info ] [MainThread]: 
[0m15:18:46.104397 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m15:18:46.105397 [debug] [MainThread]: Command end result
[0m15:18:46.135685 [info ] [MainThread]: 
[0m15:18:46.137141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:46.137141 [info ] [MainThread]: 
[0m15:18:46.137141 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:18:46.138305 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:46.138305 after 4.41 seconds
[0m15:18:46.139687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001290FF8BB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001290FFCBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012910061E10>]}
[0m15:18:46.139687 [debug] [MainThread]: Flushing usage events
[0m09:52:04.490972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF4C72410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF4EA0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF4EA1790>]}


============================== 09:52:04.495972 | 42a217f7-97dd-44fb-9710-8d8cb034b95e ==============================
[0m09:52:04.495972 [info ] [MainThread]: Running with dbt=1.8.5
[0m09:52:04.496972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt', 'log_path': 'C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:04.704188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF4EC4D10>]}
[0m09:52:04.742564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF22E6AD0>]}
[0m09:52:04.743073 [info ] [MainThread]: Registered adapter: trino=1.8.1
[0m09:52:04.757458 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m09:52:04.910369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:04.911362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:04.942968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF54EE8D0>]}
[0m09:52:05.018464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF22E6AD0>]}
[0m09:52:05.018994 [info ] [MainThread]: Found 15 models, 7 data tests, 3 sources, 563 macros
[0m09:52:05.019531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF5389A10>]}
[0m09:52:05.023066 [info ] [MainThread]: 
[0m09:52:05.023586 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:52:05.027794 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m09:52:05.129063 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m09:52:05.129063 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m09:52:05.129063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:06.307406 [debug] [ThreadPool]: SQL status: SUCCESS in 1.177 seconds
[0m09:52:06.308457 [debug] [ThreadPool]: On list_iceberg: Close
[0m09:52:06.311587 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m09:52:06.312105 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m09:52:06.312624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:06.364044 [debug] [ThreadPool]: SQL status: SUCCESS in 0.052 seconds
[0m09:52:06.365596 [debug] [ThreadPool]: On list_iceberg: Close
[0m09:52:06.368254 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m09:52:06.368780 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m09:52:06.368780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:06.440250 [debug] [ThreadPool]: SQL status: SUCCESS in 0.071 seconds
[0m09:52:06.441833 [debug] [ThreadPool]: On list_iceberg: Close
[0m09:52:06.443925 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_analytics'
[0m09:52:06.454313 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics"
[0m09:52:06.454899 [debug] [ThreadPool]: On list_iceberg_analytics: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics'
[0m09:52:06.454899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:06.957459 [debug] [ThreadPool]: SQL status: SUCCESS in 0.502 seconds
[0m09:52:06.958560 [debug] [ThreadPool]: On list_iceberg_analytics: ROLLBACK
[0m09:52:06.959064 [debug] [ThreadPool]: On list_iceberg_analytics: Close
[0m09:52:06.960123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics, now list_iceberg_analytics_source)
[0m09:52:06.964290 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_source"
[0m09:52:06.964816 [debug] [ThreadPool]: On list_iceberg_analytics_source: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_source"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_source') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_source'
[0m09:52:06.965343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:07.148222 [debug] [ThreadPool]: SQL status: SUCCESS in 0.183 seconds
[0m09:52:07.149805 [debug] [ThreadPool]: On list_iceberg_analytics_source: ROLLBACK
[0m09:52:07.150330 [debug] [ThreadPool]: On list_iceberg_analytics_source: Close
[0m09:52:07.150854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_analytics_source, now list_iceberg_analytics_stage)
[0m09:52:07.156652 [debug] [ThreadPool]: Using trino connection "list_iceberg_analytics_stage"
[0m09:52:07.157181 [debug] [ThreadPool]: On list_iceberg_analytics_stage: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_analytics_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'analytics_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_stage'
[0m09:52:07.157708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:07.284477 [debug] [ThreadPool]: SQL status: SUCCESS in 0.127 seconds
[0m09:52:07.285528 [debug] [ThreadPool]: On list_iceberg_analytics_stage: ROLLBACK
[0m09:52:07.286053 [debug] [ThreadPool]: On list_iceberg_analytics_stage: Close
[0m09:52:07.287628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF528A450>]}
[0m09:52:07.288145 [debug] [MainThread]: On master: COMMIT
[0m09:52:07.288678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:07.289208 [info ] [MainThread]: 
[0m09:52:07.294421 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_auth_events
[0m09:52:07.294948 [info ] [Thread-1 (]: 1 of 15 START sql incremental model analytics_source.src_auth_events ........... [RUN]
[0m09:52:07.295489 [debug] [Thread-1 (]: Acquiring new trino connection 'model.my_dbt_trino_project.src_auth_events'
[0m09:52:07.295489 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_auth_events
[0m09:52:07.303215 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_auth_events"
[0m09:52:07.304801 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_auth_events
[0m09:52:07.341278 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m09:52:07.342277 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(ts AS VARCHAR) as id, 
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        level,
        itemInSession,
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, 
        lastName,
        firstName,
        gender,
        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,
        success
    from "postgresql"."public"."auth_events"
)

select
    id,
    ts,
    sessionId,
    level,
    itemInSession,
    city,
    zip,
    state,
    userAgent,
    lon,
    lat,
    userId,
    lastName,
    firstName,
    gender,
    registration, 
    CASE 
        WHEN CAST(success AS VARCHAR) = 't' THEN true 
        WHEN CAST(success AS VARCHAR) = 'f' THEN false
        ELSE NULL 
    END AS success_boolean
from source



    where ts NOT IN (SELECT ts FROM "iceberg"."analytics_source"."src_auth_events")

  
[0m09:52:07.342277 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:52:08.512524 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.170 seconds
[0m09:52:08.520393 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m09:52:08.520393 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m09:52:08.672660 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.152 seconds
[0m09:52:08.676295 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m09:52:08.676295 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m09:52:08.815485 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.138 seconds
[0m09:52:08.822905 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m09:52:08.823433 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    describe "iceberg"."analytics_source"."src_auth_events"
[0m09:52:08.961434 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.138 seconds
[0m09:52:08.970789 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_auth_events"
[0m09:52:08.972298 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m09:52:08.972298 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */
insert into "iceberg"."analytics_source"."src_auth_events" ("id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean")
    (
        select "id", "ts", "sessionid", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "success_boolean"
        from "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
    )
[0m09:52:10.816488 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.843 seconds
[0m09:52:10.822313 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m09:52:10.823888 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_auth_events"
[0m09:52:10.824412 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_auth_events"} */

    drop view if exists "iceberg"."analytics_source"."src_auth_events__dbt_tmp"
[0m09:52:10.894387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m09:52:10.905458 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: ROLLBACK
[0m09:52:10.905458 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_auth_events: Close
[0m09:52:10.906468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF54B8290>]}
[0m09:52:10.907469 [info ] [Thread-1 (]: 1 of 15 OK created sql incremental model analytics_source.src_auth_events ...... [[32mSUCCESS[0m in 3.61s]
[0m09:52:10.907469 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_auth_events
[0m09:52:10.908468 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_listen_events
[0m09:52:10.910542 [info ] [Thread-1 (]: 2 of 15 START sql incremental model analytics_source.src_listen_events ......... [RUN]
[0m09:52:10.910542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_auth_events, now model.my_dbt_trino_project.src_listen_events)
[0m09:52:10.911525 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_listen_events
[0m09:52:10.914037 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_listen_events"
[0m09:52:10.915037 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_listen_events
[0m09:52:10.921362 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m09:52:10.921362 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
  security definer
  as
    

with source as (

    select
        CAST(_id AS VARCHAR) as id,
        artist,
        song,
        CAST(NULLIF(duration, '') AS DOUBLE) as duration,
        ts,
        sessionid,
        auth,
        level,
        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,
        city,
        zip,
        state,
        country,
        userAgent,
        CAST(NULLIF(lon, '') AS DOUBLE) as lon,
        CAST(NULLIF(lat, '') AS DOUBLE) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,
 -- Assurez-vous que userId peut aussi être converti de cette manière.
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration
    from "mongo"."demo"."listen_events"

)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_listen_events")

  
[0m09:52:10.922376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:11.121362 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.199 seconds
[0m09:52:11.124041 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m09:52:11.124580 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m09:52:11.213925 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.089 seconds
[0m09:52:11.217034 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m09:52:11.217551 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m09:52:11.354399 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.137 seconds
[0m09:52:11.358081 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m09:52:11.358616 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    describe "iceberg"."analytics_source"."src_listen_events"
[0m09:52:11.476354 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.117 seconds
[0m09:52:11.478981 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_listen_events"
[0m09:52:11.481091 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m09:52:11.481091 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */
insert into "iceberg"."analytics_source"."src_listen_events" ("id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration")
    (
        select "id", "artist", "song", "duration", "ts", "sessionid", "auth", "level", "iteminsession", "city", "zip", "state", "country", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration"
        from "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
    )
[0m09:52:11.807773 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.326 seconds
[0m09:52:11.814131 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m09:52:11.815196 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_listen_events"
[0m09:52:11.815725 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_listen_events"} */

    drop view if exists "iceberg"."analytics_source"."src_listen_events__dbt_tmp"
[0m09:52:11.904794 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.088 seconds
[0m09:52:11.906953 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: ROLLBACK
[0m09:52:11.907490 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_listen_events: Close
[0m09:52:11.908502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF5546150>]}
[0m09:52:11.909546 [info ] [Thread-1 (]: 2 of 15 OK created sql incremental model analytics_source.src_listen_events .... [[32mSUCCESS[0m in 1.00s]
[0m09:52:11.910632 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_listen_events
[0m09:52:11.911168 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.src_page_view_events
[0m09:52:11.911699 [info ] [Thread-1 (]: 3 of 15 START sql incremental model analytics_source.src_page_view_events ...... [RUN]
[0m09:52:11.912768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_listen_events, now model.my_dbt_trino_project.src_page_view_events)
[0m09:52:11.912768 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.src_page_view_events
[0m09:52:11.916490 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:11.917631 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.src_page_view_events
[0m09:52:11.923960 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:11.924487 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

  create or replace view
    "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
  security definer
  as
    

with source as (
    select
        CAST(_id AS VARCHAR) as id,
        ts,
        CAST(sessionId AS VARCHAR) as sessionId,
        page,
        auth,
        level,
        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, 
        city,
        zip,
        state,
        userAgent,
        CAST(NULLIF(lon, '') AS double) as lon,
        CAST(NULLIF(lat, '') AS double) as lat,
        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, 
        lastName,
        firstName,
        gender,
        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, 
        artist,
        song,
        CAST(NULLIF(duration, '') AS double) as duration
    from "mongo"."demo"."page_view_events"
)

select * from source


    where id NOT IN (SELECT id FROM "iceberg"."analytics_source"."src_page_view_events")

  
[0m09:52:11.925016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:12.017341 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.092 seconds
[0m09:52:12.021465 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:12.021987 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m09:52:12.164698 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.142 seconds
[0m09:52:12.168379 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:12.168903 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m09:52:12.294579 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.125 seconds
[0m09:52:12.298251 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:12.298781 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    describe "iceberg"."analytics_source"."src_page_view_events"
[0m09:52:12.425722 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m09:52:12.427814 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:12.429926 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:12.430450 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */
insert into "iceberg"."analytics_source"."src_page_view_events" ("id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration")
    (
        select "id", "ts", "sessionid", "page", "auth", "level", "iteminsession", "city", "zip", "state", "useragent", "lon", "lat", "userid", "lastname", "firstname", "gender", "registration", "artist", "song", "duration"
        from "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
    )
[0m09:52:12.704731 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.274 seconds
[0m09:52:12.707367 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m09:52:12.708417 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.src_page_view_events"
[0m09:52:12.708945 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.src_page_view_events"} */

    drop view if exists "iceberg"."analytics_source"."src_page_view_events__dbt_tmp"
[0m09:52:12.783684 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.075 seconds
[0m09:52:12.785305 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: ROLLBACK
[0m09:52:12.785830 [debug] [Thread-1 (]: On model.my_dbt_trino_project.src_page_view_events: Close
[0m09:52:12.786353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF6E91690>]}
[0m09:52:12.786893 [info ] [Thread-1 (]: 3 of 15 OK created sql incremental model analytics_source.src_page_view_events . [[32mSUCCESS[0m in 0.87s]
[0m09:52:12.787953 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.src_page_view_events
[0m09:52:12.788508 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m09:52:12.790653 [info ] [Thread-1 (]: 4 of 15 START sql view model analytics_stage.stg_user_level_by_gender .......... [RUN]
[0m09:52:12.791180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.src_page_view_events, now model.my_dbt_trino_project.stg_user_level_by_gender)
[0m09:52:12.791180 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_level_by_gender
[0m09:52:12.794315 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m09:52:12.794851 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_level_by_gender
[0m09:52:12.862315 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m09:52:12.863326 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_level_by_gender"
[0m09:52:12.864332 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_level_by_gender"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_level_by_gender"
  security definer
  as
    

WITH user_subscriptions AS (
    SELECT
        gender,
        level, 
        COUNT(DISTINCT userId) AS user_count
    FROM "iceberg"."analytics_source"."src_auth_events"
    WHERE gender IS NOT NULL AND level IS NOT NULL
    GROUP BY gender, level
)

SELECT
    gender,
    level,
    user_count
FROM user_subscriptions
  
[0m09:52:12.864332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:12.985405 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.121 seconds
[0m09:52:12.992364 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: ROLLBACK
[0m09:52:12.993451 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_level_by_gender: Close
[0m09:52:12.993987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF5546810>]}
[0m09:52:12.995612 [info ] [Thread-1 (]: 4 of 15 OK created sql view model analytics_stage.stg_user_level_by_gender ..... [[32mSUCCESS[0m in 0.20s]
[0m09:52:12.996649 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_level_by_gender
[0m09:52:12.999010 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_streams_hourly
[0m09:52:13.000043 [info ] [Thread-1 (]: 5 of 15 START sql table model analytics_stage.stg_streams_hourly ............... [RUN]
[0m09:52:13.000576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_level_by_gender, now model.my_dbt_trino_project.stg_streams_hourly)
[0m09:52:13.001118 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_streams_hourly
[0m09:52:13.004853 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m09:52:13.005912 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_streams_hourly
[0m09:52:13.029299 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_streams_hourly"
[0m09:52:13.030754 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m09:52:13.032163 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

  
    

    create table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp"
      
      
    as (
      

SELECT
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, 
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,
    COUNT(*) AS total_streams
FROM "iceberg"."analytics_source"."src_listen_events"
GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),
    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')
    )
[0m09:52:13.032163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:13.878997 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.846 seconds
[0m09:52:13.886993 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m09:52:13.887529 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly" rename to "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m09:52:13.975454 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.087 seconds
[0m09:52:13.978106 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m09:52:13.978634 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */
alter table "iceberg"."analytics_stage"."stg_streams_hourly__dbt_tmp" rename to "iceberg"."analytics_stage"."stg_streams_hourly"
[0m09:52:14.059967 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m09:52:14.062086 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m09:52:14.063095 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_streams_hourly"
[0m09:52:14.063599 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_streams_hourly"} */

    drop table if exists "iceberg"."analytics_stage"."stg_streams_hourly__dbt_backup"
[0m09:52:14.344530 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.281 seconds
[0m09:52:14.346647 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: ROLLBACK
[0m09:52:14.347170 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_streams_hourly: Close
[0m09:52:14.347700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF5311850>]}
[0m09:52:14.348221 [info ] [Thread-1 (]: 5 of 15 OK created sql table model analytics_stage.stg_streams_hourly .......... [[32mSUCCESS[0m in 1.35s]
[0m09:52:14.349264 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_streams_hourly
[0m09:52:14.351026 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_top_songs_artists
[0m09:52:14.352086 [info ] [Thread-1 (]: 6 of 15 START sql view model analytics_stage.stg_top_songs_artists ............. [RUN]
[0m09:52:14.352609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_streams_hourly, now model.my_dbt_trino_project.stg_top_songs_artists)
[0m09:52:14.353682 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_top_songs_artists
[0m09:52:14.357452 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m09:52:14.357981 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_top_songs_artists
[0m09:52:14.361132 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_top_songs_artists"
[0m09:52:14.363246 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_top_songs_artists"
[0m09:52:14.363771 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_top_songs_artists"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_top_songs_artists"
  security definer
  as
    

WITH song_plays AS (
    SELECT
        artist,
        song,
        COUNT(*) AS play_count
    FROM "iceberg"."analytics_source"."src_listen_events"
    GROUP BY artist, song
)

SELECT
    artist,
    song,
    play_count
FROM song_plays
ORDER BY play_count DESC
  
[0m09:52:14.364300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:14.466350 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.102 seconds
[0m09:52:14.467937 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: ROLLBACK
[0m09:52:14.468478 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_top_songs_artists: Close
[0m09:52:14.469532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF0FA6310>]}
[0m09:52:14.470059 [info ] [Thread-1 (]: 6 of 15 OK created sql view model analytics_stage.stg_top_songs_artists ........ [[32mSUCCESS[0m in 0.12s]
[0m09:52:14.470612 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_top_songs_artists
[0m09:52:14.471287 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_unique_users
[0m09:52:14.472884 [info ] [Thread-1 (]: 7 of 15 START sql view model analytics_stage.stg_unique_users .................. [RUN]
[0m09:52:14.473928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_top_songs_artists, now model.my_dbt_trino_project.stg_unique_users)
[0m09:52:14.473928 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_unique_users
[0m09:52:14.479143 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_unique_users"
[0m09:52:14.480145 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_unique_users
[0m09:52:14.483667 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_unique_users"
[0m09:52:14.484666 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_unique_users"
[0m09:52:14.484666 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_unique_users"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_unique_users"
  security definer
  as
    

SELECT
    COUNT(DISTINCT userid) AS total_unique_users
FROM "iceberg"."analytics_source"."src_listen_events"
WHERE userid IS NOT NULL
  
[0m09:52:14.486177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:14.579554 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.093 seconds
[0m09:52:14.581111 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: ROLLBACK
[0m09:52:14.581637 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_unique_users: Close
[0m09:52:14.582175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF52FC290>]}
[0m09:52:14.582722 [info ] [Thread-1 (]: 7 of 15 OK created sql view model analytics_stage.stg_unique_users ............. [[32mSUCCESS[0m in 0.11s]
[0m09:52:14.583786 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_unique_users
[0m09:52:14.585709 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m09:52:14.586230 [info ] [Thread-1 (]: 8 of 15 START sql view model analytics_stage.stg_user_activity_per_country ..... [RUN]
[0m09:52:14.586754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_unique_users, now model.my_dbt_trino_project.stg_user_activity_per_country)
[0m09:52:14.587291 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_country
[0m09:52:14.589947 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m09:52:14.591014 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_country
[0m09:52:14.593125 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m09:52:14.595241 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_country"
[0m09:52:14.595776 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_country"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_country"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    country,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  WHERE country IS NOT NULL
  UNION ALL
  SELECT
    'Unknown' AS country,
    'auth_event' AS event_type, 
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    'Unknown' AS country, 
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  country,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY country
  
[0m09:52:14.595776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:14.708152 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.112 seconds
[0m09:52:14.709734 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: ROLLBACK
[0m09:52:14.710243 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_country: Close
[0m09:52:14.710776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF5541F90>]}
[0m09:52:14.711314 [info ] [Thread-1 (]: 8 of 15 OK created sql view model analytics_stage.stg_user_activity_per_country  [[32mSUCCESS[0m in 0.12s]
[0m09:52:14.712384 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_country
[0m09:52:14.713974 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m09:52:14.715090 [info ] [Thread-1 (]: 9 of 15 START sql view model analytics_stage.stg_user_activity_per_location .... [RUN]
[0m09:52:14.715625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_country, now model.my_dbt_trino_project.stg_user_activity_per_location)
[0m09:52:14.715625 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.stg_user_activity_per_location
[0m09:52:14.718837 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m09:52:14.719843 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.stg_user_activity_per_location
[0m09:52:14.722844 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m09:52:14.725821 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.stg_user_activity_per_location"
[0m09:52:14.726329 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.stg_user_activity_per_location"} */

  create or replace view
    "iceberg"."analytics_stage"."stg_user_activity_per_location"
  security definer
  as
    

WITH combined_activities AS (
  SELECT
    city,
    state,
    'auth_event' AS event_type,
    ts,
    userid
 FROM "iceberg"."analytics_source"."src_auth_events"
  UNION ALL
  SELECT
    city,
    state,
    'listen_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_listen_events"
  UNION ALL
  SELECT
    city,
    state,
    'page_view_event' AS event_type,
    ts,
    userid
  FROM "iceberg"."analytics_source"."src_page_view_events"
)

SELECT
  state,
  city,
  COUNT(*) AS activity_count
FROM combined_activities
GROUP BY state, city
  
[0m09:52:14.726847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:14.842491 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m09:52:14.844589 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: ROLLBACK
[0m09:52:14.844589 [debug] [Thread-1 (]: On model.my_dbt_trino_project.stg_user_activity_per_location: Close
[0m09:52:14.845142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF4EF5E10>]}
[0m09:52:14.845672 [info ] [Thread-1 (]: 9 of 15 OK created sql view model analytics_stage.stg_user_activity_per_location  [[32mSUCCESS[0m in 0.13s]
[0m09:52:14.846738 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.stg_user_activity_per_location
[0m09:52:14.846738 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m09:52:14.847802 [info ] [Thread-1 (]: 10 of 15 START sql table model analytics.mart_user_level_by_gender ............. [RUN]
[0m09:52:14.847885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.stg_user_activity_per_location, now model.my_dbt_trino_project.mart_user_level_by_gender)
[0m09:52:14.848391 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_level_by_gender
[0m09:52:14.851581 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m09:52:14.852102 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_level_by_gender
[0m09:52:14.855169 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m09:52:14.856684 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m09:52:14.856684 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

  
    

    create table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp"
      
      
    as (
      

SELECT
    gender,
    level,
    SUM(user_count) AS total_users,
    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users
FROM "iceberg"."analytics_stage"."stg_user_level_by_gender"
GROUP BY gender, level
    )
[0m09:52:14.856684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:15.340494 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.483 seconds
[0m09:52:15.345843 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m09:52:15.345843 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender" rename to "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m09:52:15.419364 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.073 seconds
[0m09:52:15.423081 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m09:52:15.423612 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */
alter table "iceberg"."analytics"."mart_user_level_by_gender__dbt_tmp" rename to "iceberg"."analytics"."mart_user_level_by_gender"
[0m09:52:15.495691 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m09:52:15.499931 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m09:52:15.500989 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_level_by_gender"
[0m09:52:15.501519 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_level_by_gender"} */

    drop table if exists "iceberg"."analytics"."mart_user_level_by_gender__dbt_backup"
[0m09:52:15.621743 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.120 seconds
[0m09:52:15.623844 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: ROLLBACK
[0m09:52:15.623844 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_level_by_gender: Close
[0m09:52:15.624373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF68CAC50>]}
[0m09:52:15.624909 [info ] [Thread-1 (]: 10 of 15 OK created sql table model analytics.mart_user_level_by_gender ........ [[32mSUCCESS[0m in 0.78s]
[0m09:52:15.625971 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_level_by_gender
[0m09:52:15.628165 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m09:52:15.628705 [info ] [Thread-1 (]: 11 of 15 START sql table model analytics.mart_hourly_stream_evolution .......... [RUN]
[0m09:52:15.629684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_level_by_gender, now model.my_dbt_trino_project.mart_hourly_stream_evolution)
[0m09:52:15.629684 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m09:52:15.633867 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m09:52:15.634931 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m09:52:15.639145 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m09:52:15.641150 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m09:52:15.642150 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

  
    

    create table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp"
      
      
    as (
      

SELECT
    stream_date,
    stream_hour,
    total_streams,
    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams
FROM "iceberg"."analytics_stage"."stg_streams_hourly"
ORDER BY
    stream_date,
    stream_hour
    )
[0m09:52:15.642150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:15.896341 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.254 seconds
[0m09:52:15.898982 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m09:52:15.899504 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution" rename to "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m09:52:15.990350 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.090 seconds
[0m09:52:15.995144 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m09:52:15.996212 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */
alter table "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_tmp" rename to "iceberg"."analytics"."mart_hourly_stream_evolution"
[0m09:52:16.085266 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.088 seconds
[0m09:52:16.087896 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m09:52:16.088937 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_hourly_stream_evolution"
[0m09:52:16.089471 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution"} */

    drop table if exists "iceberg"."analytics"."mart_hourly_stream_evolution__dbt_backup"
[0m09:52:16.255047 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.165 seconds
[0m09:52:16.257119 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: ROLLBACK
[0m09:52:16.257642 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_hourly_stream_evolution: Close
[0m09:52:16.258181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF5517FD0>]}
[0m09:52:16.259314 [info ] [Thread-1 (]: 11 of 15 OK created sql table model analytics.mart_hourly_stream_evolution ..... [[32mSUCCESS[0m in 0.63s]
[0m09:52:16.260371 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_hourly_stream_evolution
[0m09:52:16.260925 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_top_songs_artists
[0m09:52:16.261455 [info ] [Thread-1 (]: 12 of 15 START sql table model analytics.mart_top_songs_artists ................ [RUN]
[0m09:52:16.262512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_hourly_stream_evolution, now model.my_dbt_trino_project.mart_top_songs_artists)
[0m09:52:16.263054 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_top_songs_artists
[0m09:52:16.266756 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m09:52:16.267803 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_top_songs_artists
[0m09:52:16.273941 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_top_songs_artists"
[0m09:52:16.275945 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m09:52:16.276940 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

  
    

    create table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp"
      
      
    as (
      

WITH top_songs AS (
    SELECT
        artist,
        song,
        play_count
    FROM "iceberg"."analytics_stage"."stg_top_songs_artists"
)

SELECT
    artist,
    song,
    play_count
FROM top_songs
    )
[0m09:52:16.276940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:16.557371 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.280 seconds
[0m09:52:16.560505 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m09:52:16.561024 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists" rename to "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m09:52:16.641706 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m09:52:16.645902 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m09:52:16.645902 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */
alter table "iceberg"."analytics"."mart_top_songs_artists__dbt_tmp" rename to "iceberg"."analytics"."mart_top_songs_artists"
[0m09:52:16.729927 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.083 seconds
[0m09:52:16.733068 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m09:52:16.733582 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_top_songs_artists"
[0m09:52:16.734108 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_top_songs_artists"} */

    drop table if exists "iceberg"."analytics"."mart_top_songs_artists__dbt_backup"
[0m09:52:16.846664 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.112 seconds
[0m09:52:16.848748 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: ROLLBACK
[0m09:52:16.849262 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_top_songs_artists: Close
[0m09:52:16.849789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF6937210>]}
[0m09:52:16.850313 [info ] [Thread-1 (]: 12 of 15 OK created sql table model analytics.mart_top_songs_artists ........... [[32mSUCCESS[0m in 0.59s]
[0m09:52:16.850849 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_top_songs_artists
[0m09:52:16.852902 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_total_unique_users
[0m09:52:16.853927 [info ] [Thread-1 (]: 13 of 15 START sql table model analytics.mart_total_unique_users ............... [RUN]
[0m09:52:16.854446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_top_songs_artists, now model.my_dbt_trino_project.mart_total_unique_users)
[0m09:52:16.854446 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_total_unique_users
[0m09:52:16.857604 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m09:52:16.858109 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_total_unique_users
[0m09:52:16.862148 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_total_unique_users"
[0m09:52:16.863296 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m09:52:16.863815 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

  
    

    create table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp"
      
      
    as (
      

SELECT
    total_unique_users
FROM "iceberg"."analytics_stage"."stg_unique_users"
    )
[0m09:52:16.864340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:17.134171 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.270 seconds
[0m09:52:17.138001 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m09:52:17.138537 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users" rename to "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m09:52:17.216086 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m09:52:17.219792 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m09:52:17.220331 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */
alter table "iceberg"."analytics"."mart_total_unique_users__dbt_tmp" rename to "iceberg"."analytics"."mart_total_unique_users"
[0m09:52:17.303390 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.083 seconds
[0m09:52:17.307147 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m09:52:17.308196 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_total_unique_users"
[0m09:52:17.308709 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_total_unique_users"} */

    drop table if exists "iceberg"."analytics"."mart_total_unique_users__dbt_backup"
[0m09:52:17.433543 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.125 seconds
[0m09:52:17.435126 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: ROLLBACK
[0m09:52:17.435652 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_total_unique_users: Close
[0m09:52:17.436183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF6DD9E10>]}
[0m09:52:17.436712 [info ] [Thread-1 (]: 13 of 15 OK created sql table model analytics.mart_total_unique_users .......... [[32mSUCCESS[0m in 0.58s]
[0m09:52:17.437299 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_total_unique_users
[0m09:52:17.439386 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m09:52:17.439935 [info ] [Thread-1 (]: 14 of 15 START sql table model analytics.mart_user_activity_per_country ........ [RUN]
[0m09:52:17.440455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_total_unique_users, now model.my_dbt_trino_project.mart_user_activity_per_country)
[0m09:52:17.440455 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_country
[0m09:52:17.443568 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m09:52:17.443568 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_country
[0m09:52:17.449576 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m09:52:17.450578 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m09:52:17.450578 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp"
      
      
    as (
      

SELECT
  country,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_country"
GROUP BY country
ORDER BY SUM(activity_count) DESC
    )
[0m09:52:17.451577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:17.858499 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.407 seconds
[0m09:52:17.862710 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m09:52:17.863239 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country" rename to "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m09:52:17.934715 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.071 seconds
[0m09:52:17.938448 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m09:52:17.938967 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */
alter table "iceberg"."analytics"."mart_user_activity_per_country__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_country"
[0m09:52:18.011951 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.073 seconds
[0m09:52:18.014657 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m09:52:18.015704 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_country"
[0m09:52:18.016234 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_country"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_country__dbt_backup"
[0m09:52:18.140060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m09:52:18.142168 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: ROLLBACK
[0m09:52:18.142690 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_country: Close
[0m09:52:18.143805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF2807D50>]}
[0m09:52:18.144333 [info ] [Thread-1 (]: 14 of 15 OK created sql table model analytics.mart_user_activity_per_country ... [[32mSUCCESS[0m in 0.70s]
[0m09:52:18.145424 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_country
[0m09:52:18.145958 [debug] [Thread-1 (]: Began running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m09:52:18.146472 [info ] [Thread-1 (]: 15 of 15 START sql table model analytics.mart_user_activity_per_state .......... [RUN]
[0m09:52:18.147539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_trino_project.mart_user_activity_per_country, now model.my_dbt_trino_project.mart_user_activity_per_state)
[0m09:52:18.148092 [debug] [Thread-1 (]: Began compiling node model.my_dbt_trino_project.mart_user_activity_per_state
[0m09:52:18.153055 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m09:52:18.154119 [debug] [Thread-1 (]: Began executing node model.my_dbt_trino_project.mart_user_activity_per_state
[0m09:52:18.158473 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m09:52:18.160580 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m09:52:18.161115 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

  
    

    create table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp"
      
      
    as (
      

SELECT
  state,
  city,
  SUM(activity_count) AS total_activity
FROM "iceberg"."analytics_stage"."stg_user_activity_per_location"
GROUP BY state, city
ORDER BY state, SUM(activity_count) DESC
    )
[0m09:52:18.161634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:18.505247 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.343 seconds
[0m09:52:18.508369 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m09:52:18.508369 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state" rename to "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m09:52:18.587941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m09:52:18.592183 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m09:52:18.593258 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */
alter table "iceberg"."analytics"."mart_user_activity_per_state__dbt_tmp" rename to "iceberg"."analytics"."mart_user_activity_per_state"
[0m09:52:18.664712 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.071 seconds
[0m09:52:18.667477 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m09:52:18.668537 [debug] [Thread-1 (]: Using trino connection "model.my_dbt_trino_project.mart_user_activity_per_state"
[0m09:52:18.668537 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "my_dbt_trino_project", "target_name": "dev", "node_id": "model.my_dbt_trino_project.mart_user_activity_per_state"} */

    drop table if exists "iceberg"."analytics"."mart_user_activity_per_state__dbt_backup"
[0m09:52:18.793541 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m09:52:18.795566 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: ROLLBACK
[0m09:52:18.796087 [debug] [Thread-1 (]: On model.my_dbt_trino_project.mart_user_activity_per_state: Close
[0m09:52:18.797156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42a217f7-97dd-44fb-9710-8d8cb034b95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF27AF850>]}
[0m09:52:18.797679 [info ] [Thread-1 (]: 15 of 15 OK created sql table model analytics.mart_user_activity_per_state ..... [[32mSUCCESS[0m in 0.65s]
[0m09:52:18.798905 [debug] [Thread-1 (]: Finished running node model.my_dbt_trino_project.mart_user_activity_per_state
[0m09:52:18.799958 [debug] [MainThread]: On master: COMMIT
[0m09:52:18.800484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:18.801011 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m09:52:18.801540 [debug] [MainThread]: Connection 'list_iceberg_analytics_stage' was properly closed.
[0m09:52:18.801540 [debug] [MainThread]: Connection 'model.my_dbt_trino_project.mart_user_activity_per_state' was properly closed.
[0m09:52:18.802063 [info ] [MainThread]: 
[0m09:52:18.802591 [info ] [MainThread]: Finished running 3 incremental models, 5 view models, 7 table models in 0 hours 0 minutes and 13.78 seconds (13.78s).
[0m09:52:18.804661 [debug] [MainThread]: Command end result
[0m09:52:18.844213 [info ] [MainThread]: 
[0m09:52:18.844213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:18.845223 [info ] [MainThread]: 
[0m09:52:18.845223 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m09:52:18.846223 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:18.846223 after 14.45 seconds
[0m09:52:18.847221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BEFA69A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF4F17FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF4F17DD0>]}
[0m09:52:18.847221 [debug] [MainThread]: Flushing usage events
