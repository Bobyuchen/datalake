{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-06-19T06:47:48.746348Z", "invocation_id": "a3ec0d7d-a4ee-44ae-ab9f-b713688a3f4a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T06:47:45.995717Z", "completed_at": "2024-06-19T06:47:45.995717Z"}, {"name": "execute", "started_at": "2024-06-19T06:47:45.995717Z", "completed_at": "2024-06-19T06:47:46.729450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7337331771850586, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_auth_events\"} */\ninsert into \"datalake\".\"analytics_source\".\"src_auth_events\" (\"id\", \"ts\", \"sessionid\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"success_boolean\")\n    (\n        select \"id\", \"ts\", \"sessionid\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"success_boolean\"\n        from \"datalake\".\"analytics_source\".\"src_auth_events__dbt_tmp\"\n    )", "query_id": "20240619_064746_00689_edrr7"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_auth_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(ts AS VARCHAR) as id, \n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        level,\n        itemInSession,\n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,\n        success\n    from \"oltp\".\"public\".\"auth_events\"\n)\n\nselect\n    id,\n    ts,\n    sessionId,\n    level,\n    itemInSession,\n    city,\n    zip,\n    state,\n    userAgent,\n    lon,\n    lat,\n    userId,\n    lastName,\n    firstName,\n    gender,\n    registration, \n    CASE \n        WHEN CAST(success AS VARCHAR) = 't' THEN true \n        WHEN CAST(success AS VARCHAR) = 'f' THEN false\n        ELSE NULL \n    END AS success_boolean\nfrom source\n\n\n\n    where ts NOT IN (SELECT ts FROM \"datalake\".\"analytics_source\".\"src_auth_events\")\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_auth_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T06:47:46.746413Z", "completed_at": "2024-06-19T06:47:46.748258Z"}, {"name": "execute", "started_at": "2024-06-19T06:47:46.748258Z", "completed_at": "2024-06-19T06:47:47.705611Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.960723876953125, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_listen_events\"} */\ninsert into \"datalake\".\"analytics_source\".\"src_listen_events\" (\"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\")\n    (\n        select \"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\"\n        from \"datalake\".\"analytics_source\".\"src_listen_events__dbt_tmp\"\n    )", "query_id": "20240619_064747_00695_edrr7"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_listen_events", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        CAST(_id AS VARCHAR) as id,\n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS DOUBLE) as duration,\n        ts,\n        sessionid,\n        auth,\n        level,\n        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,\n        city,\n        zip,\n        state,\n        country,\n        userAgent,\n        CAST(NULLIF(lon, '') AS DOUBLE) as lon,\n        CAST(NULLIF(lat, '') AS DOUBLE) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,\n -- Assurez-vous que userId peut aussi \u00eatre converti de cette mani\u00e8re.\n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration\n    from \"website\".\"demo\".\"listen_events\"\n\n)\n\nselect * from source\n\n\n    where id NOT IN (SELECT id FROM \"datalake\".\"analytics_source\".\"src_listen_events\")\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_listen_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T06:47:47.709721Z", "completed_at": "2024-06-19T06:47:47.713844Z"}, {"name": "execute", "started_at": "2024-06-19T06:47:47.714859Z", "completed_at": "2024-06-19T06:47:48.739452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0297305583953857, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_page_view_events\"} */\ninsert into \"datalake\".\"analytics_source\".\"src_page_view_events\" (\"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\")\n    (\n        select \"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\"\n        from \"datalake\".\"analytics_source\".\"src_page_view_events__dbt_tmp\"\n    )", "query_id": "20240619_064748_00701_edrr7"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_page_view_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(_id AS VARCHAR) as id,\n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        page,\n        auth,\n        level,\n        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, \n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, \n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS double) as duration\n    from \"website\".\"demo\".\"page_view_events\"\n)\n\nselect * from source\n\n\n    where id NOT IN (SELECT id FROM \"datalake\".\"analytics_source\".\"src_page_view_events\")\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_page_view_events\""}], "elapsed_time": 3.0254933834075928, "args": {"log_level_file": "debug", "static_parser": true, "populate_cache": true, "cache_selected_only": false, "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main-main\\dbt", "exclude": [], "defer": false, "log_format": "default", "favor_state": false, "log_file_max_bytes": 10485760, "log_level": "info", "project_dir": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main-main\\dbt", "empty": false, "invocation_command": "dbt run --models source", "log_path": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main-main\\dbt\\logs", "select": ["source"], "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse_file_diff": true, "use_colors": true, "use_colors_file": true, "introspect": true, "strict_mode": false, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "printer_width": 80, "quiet": false, "log_format_file": "debug", "version_check": true, "source_freshness_run_project_hooks": false, "require_resource_names_without_spaces": false, "print": true, "enable_legacy_logger": false, "partial_parse": true, "send_anonymous_usage_stats": true, "macro_debugging": false, "vars": {}, "indirect_selection": "eager", "which": "run"}}