{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-06-19T02:36:20.033694Z", "invocation_id": "ad86cf40-e840-4e1c-afc0-18283c1d4899", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:13.934366Z", "completed_at": "2024-06-19T02:36:13.940600Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:13.940600Z", "completed_at": "2024-06-19T02:36:14.576922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6445558071136475, "adapter_response": {"_message": "SUCCESS", "rows_affected": 65, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_auth_events\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics_source\".\"src_auth_events__dbt_tmp\"\n      \n      \n    as (\n      \n\nwith source as (\n    select\n        CAST(ts AS VARCHAR) as id, \n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        level,\n        itemInSession,\n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,\n        success\n    from \"oltp\".\"public\".\"auth_events\"\n)\n\nselect\n    id,\n    ts,\n    sessionId,\n    level,\n    itemInSession,\n    city,\n    zip,\n    state,\n    userAgent,\n    lon,\n    lat,\n    userId,\n    lastName,\n    firstName,\n    gender,\n    registration, \n    CASE \n        WHEN CAST(success AS VARCHAR) = 't' THEN true \n        WHEN CAST(success AS VARCHAR) = 'f' THEN false\n        ELSE NULL \n    END AS success_boolean\nfrom source\n\n\n    )", "query_id": "20240619_023614_00507_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_auth_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(ts AS VARCHAR) as id, \n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        level,\n        itemInSession,\n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,\n        success\n    from \"oltp\".\"public\".\"auth_events\"\n)\n\nselect\n    id,\n    ts,\n    sessionId,\n    level,\n    itemInSession,\n    city,\n    zip,\n    state,\n    userAgent,\n    lon,\n    lat,\n    userId,\n    lastName,\n    firstName,\n    gender,\n    registration, \n    CASE \n        WHEN CAST(success AS VARCHAR) = 't' THEN true \n        WHEN CAST(success AS VARCHAR) = 'f' THEN false\n        ELSE NULL \n    END AS success_boolean\nfrom source\n\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_auth_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:14.581428Z", "completed_at": "2024-06-19T02:36:14.586425Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:14.586425Z", "completed_at": "2024-06-19T02:36:15.253137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.67270827293396, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_listen_events\"} */\ninsert into \"datalake\".\"analytics_source\".\"src_listen_events\" (\"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\")\n    (\n        select \"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\"\n        from \"datalake\".\"analytics_source\".\"src_listen_events__dbt_tmp\"\n    )", "query_id": "20240619_023615_00515_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_listen_events", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        CAST(_id AS VARCHAR) as id,\n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS DOUBLE) as duration,\n        ts,\n        sessionid,\n        auth,\n        level,\n        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,\n        city,\n        zip,\n        state,\n        country,\n        userAgent,\n        CAST(NULLIF(lon, '') AS DOUBLE) as lon,\n        CAST(NULLIF(lat, '') AS DOUBLE) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,\n -- Assurez-vous que userId peut aussi \u00eatre converti de cette mani\u00e8re.\n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration\n    from \"website\".\"demo\".\"listen_events\"\n\n)\n\nselect * from source\n\n\n\n    -- this filter will only be applied on an incremental run\n    where ts > (select max(ts) from \"datalake\".\"analytics_source\".\"src_listen_events\")\n\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_listen_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:15.258507Z", "completed_at": "2024-06-19T02:36:15.262503Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:15.263504Z", "completed_at": "2024-06-19T02:36:15.902624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6461195945739746, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_page_view_events\"} */\ninsert into \"datalake\".\"analytics_source\".\"src_page_view_events\" (\"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\")\n    (\n        select \"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\"\n        from \"datalake\".\"analytics_source\".\"src_page_view_events__dbt_tmp\"\n    )", "query_id": "20240619_023615_00521_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_page_view_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(_id AS VARCHAR) as id,\n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        page,\n        auth,\n        level,\n        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, \n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, \n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS double) as duration\n    from \"website\".\"demo\".\"page_view_events\"\n)\n\nselect * from source\n\n\n    where ts > (select max(ts) from \"datalake\".\"analytics_source\".\"src_page_view_events\")\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_page_view_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:15.906892Z", "completed_at": "2024-06-19T02:36:15.909893Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:15.909893Z", "completed_at": "2024-06-19T02:36:15.993134Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0883033275604248, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_level_by_gender\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\"\n  security definer\n  as\n    \n\nWITH user_subscriptions AS (\n    SELECT\n        gender,\n        level, \n        COUNT(DISTINCT userId) AS user_count\n    FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n    WHERE gender IS NOT NULL AND level IS NOT NULL\n    GROUP BY gender, level\n)\n\nSELECT\n    gender,\n    level,\n    user_count\nFROM user_subscriptions\n  ", "query_id": "20240619_023615_00523_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_level_by_gender", "compiled": true, "compiled_code": "\n\nWITH user_subscriptions AS (\n    SELECT\n        gender,\n        level, \n        COUNT(DISTINCT userId) AS user_count\n    FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n    WHERE gender IS NOT NULL AND level IS NOT NULL\n    GROUP BY gender, level\n)\n\nSELECT\n    gender,\n    level,\n    user_count\nFROM user_subscriptions", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:15.998420Z", "completed_at": "2024-06-19T02:36:16.002104Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:16.002625Z", "completed_at": "2024-06-19T02:36:16.492816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.49591636657714844, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_streams_hourly\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics_stage\".\"stg_streams_hourly__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, \n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,\n    COUNT(*) AS total_streams\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nGROUP BY\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')\n    )", "query_id": "20240619_023616_00524_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_streams_hourly", "compiled": true, "compiled_code": "\n\nSELECT\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, \n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,\n    COUNT(*) AS total_streams\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nGROUP BY\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_streams_hourly\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:16.497030Z", "completed_at": "2024-06-19T02:36:16.499475Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:16.500478Z", "completed_at": "2024-06-19T02:36:16.560057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06502509117126465, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_top_songs_artists\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_top_songs_artists\"\n  security definer\n  as\n    \n\nWITH song_plays AS (\n    SELECT\n        artist,\n        song,\n        COUNT(*) AS play_count\n    FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n    GROUP BY artist, song\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM song_plays\nORDER BY play_count DESC\n  ", "query_id": "20240619_023616_00528_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_top_songs_artists", "compiled": true, "compiled_code": "\n\nWITH song_plays AS (\n    SELECT\n        artist,\n        song,\n        COUNT(*) AS play_count\n    FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n    GROUP BY artist, song\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM song_plays\nORDER BY play_count DESC", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_top_songs_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:16.565336Z", "completed_at": "2024-06-19T02:36:16.568497Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:16.569503Z", "completed_at": "2024-06-19T02:36:16.636326Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07298994064331055, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_unique_users\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_unique_users\"\n  security definer\n  as\n    \n\nSELECT\n    COUNT(DISTINCT userid) AS total_unique_users\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nWHERE userid IS NOT NULL\n  ", "query_id": "20240619_023616_00529_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_unique_users", "compiled": true, "compiled_code": "\n\nSELECT\n    COUNT(DISTINCT userid) AS total_unique_users\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nWHERE userid IS NOT NULL", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_unique_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:16.640844Z", "completed_at": "2024-06-19T02:36:16.644853Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:16.645851Z", "completed_at": "2024-06-19T02:36:16.711053Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07120919227600098, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_activity_per_country\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_user_activity_per_country\"\n  security definer\n  as\n    \n\nWITH combined_activities AS (\n  SELECT\n    country,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n  WHERE country IS NOT NULL\n  UNION ALL\n  SELECT\n    'Unknown' AS country,\n    'auth_event' AS event_type, \n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    'Unknown' AS country, \n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  country,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY country\n  ", "query_id": "20240619_023616_00530_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_activity_per_country", "compiled": true, "compiled_code": "\n\nWITH combined_activities AS (\n  SELECT\n    country,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n  WHERE country IS NOT NULL\n  UNION ALL\n  SELECT\n    'Unknown' AS country,\n    'auth_event' AS event_type, \n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    'Unknown' AS country, \n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  country,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY country", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_user_activity_per_country\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:16.716327Z", "completed_at": "2024-06-19T02:36:16.719347Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:16.719347Z", "completed_at": "2024-06-19T02:36:16.794870Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08054542541503906, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_activity_per_location\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\"\n  security definer\n  as\n    \n\nWITH combined_activities AS (\n  SELECT\n    city,\n    state,\n    'auth_event' AS event_type,\n    ts,\n    userid\n FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  state,\n  city,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY state, city\n  ", "query_id": "20240619_023616_00531_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_activity_per_location", "compiled": true, "compiled_code": "\n\nWITH combined_activities AS (\n  SELECT\n    city,\n    state,\n    'auth_event' AS event_type,\n    ts,\n    userid\n FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  state,\n  city,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY state, city", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:16.801345Z", "completed_at": "2024-06-19T02:36:16.804343Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:16.804343Z", "completed_at": "2024-06-19T02:36:17.346586Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5477519035339355, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_level_by_gender\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_user_level_by_gender__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    gender,\n    level,\n    SUM(user_count) AS total_users,\n    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users\nFROM \"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\"\nGROUP BY gender, level\n    )", "query_id": "20240619_023616_00532_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_level_by_gender", "compiled": true, "compiled_code": "\n\nSELECT\n    gender,\n    level,\n    SUM(user_count) AS total_users,\n    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users\nFROM \"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\"\nGROUP BY gender, level", "relation_name": "\"datalake\".\"analytics\".\"mart_user_level_by_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:17.351758Z", "completed_at": "2024-06-19T02:36:17.354371Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:17.354885Z", "completed_at": "2024-06-19T02:36:17.863075Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5123522281646729, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_hourly_stream_evolution\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_hourly_stream_evolution__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    stream_date,\n    stream_hour,\n    total_streams,\n    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams\nFROM \"datalake\".\"analytics_stage\".\"stg_streams_hourly\"\nORDER BY\n    stream_date,\n    stream_hour\n    )", "query_id": "20240619_023617_00536_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution", "compiled": true, "compiled_code": "\n\nSELECT\n    stream_date,\n    stream_hour,\n    total_streams,\n    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams\nFROM \"datalake\".\"analytics_stage\".\"stg_streams_hourly\"\nORDER BY\n    stream_date,\n    stream_hour", "relation_name": "\"datalake\".\"analytics\".\"mart_hourly_stream_evolution\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:17.866868Z", "completed_at": "2024-06-19T02:36:17.870880Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:17.871881Z", "completed_at": "2024-06-19T02:36:18.392271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5264933109283447, "adapter_response": {"_message": "SUCCESS", "rows_affected": 14, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_top_songs_artists\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_top_songs_artists__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH top_songs AS (\n    SELECT\n        artist,\n        song,\n        play_count\n    FROM \"datalake\".\"analytics_stage\".\"stg_top_songs_artists\"\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM top_songs\n    )", "query_id": "20240619_023617_00540_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_top_songs_artists", "compiled": true, "compiled_code": "\n\nWITH top_songs AS (\n    SELECT\n        artist,\n        song,\n        play_count\n    FROM \"datalake\".\"analytics_stage\".\"stg_top_songs_artists\"\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM top_songs", "relation_name": "\"datalake\".\"analytics\".\"mart_top_songs_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:18.396272Z", "completed_at": "2024-06-19T02:36:18.399273Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:18.399273Z", "completed_at": "2024-06-19T02:36:18.913202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5189268589019775, "adapter_response": {"_message": "SUCCESS", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_total_unique_users\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_total_unique_users__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    total_unique_users\nFROM \"datalake\".\"analytics_stage\".\"stg_unique_users\"\n    )", "query_id": "20240619_023618_00544_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_total_unique_users", "compiled": true, "compiled_code": "\n\nSELECT\n    total_unique_users\nFROM \"datalake\".\"analytics_stage\".\"stg_unique_users\"", "relation_name": "\"datalake\".\"analytics\".\"mart_total_unique_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:18.918386Z", "completed_at": "2024-06-19T02:36:18.920385Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:18.921385Z", "completed_at": "2024-06-19T02:36:19.450989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5346050262451172, "adapter_response": {"_message": "SUCCESS", "rows_affected": 6, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_activity_per_country\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_user_activity_per_country__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  country,\n  SUM(activity_count) AS total_activity\nFROM \"datalake\".\"analytics_stage\".\"stg_user_activity_per_country\"\nGROUP BY country\nORDER BY SUM(activity_count) DESC\n    )", "query_id": "20240619_023618_00548_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_activity_per_country", "compiled": true, "compiled_code": "\n\nSELECT\n  country,\n  SUM(activity_count) AS total_activity\nFROM \"datalake\".\"analytics_stage\".\"stg_user_activity_per_country\"\nGROUP BY country\nORDER BY SUM(activity_count) DESC", "relation_name": "\"datalake\".\"analytics\".\"mart_user_activity_per_country\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-19T02:36:19.454987Z", "completed_at": "2024-06-19T02:36:19.457497Z"}, {"name": "execute", "started_at": "2024-06-19T02:36:19.458498Z", "completed_at": "2024-06-19T02:36:20.027831Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5748410224914551, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_activity_per_state\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_user_activity_per_state__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  state,\n  city,\n  SUM(activity_count) AS total_activity\nFROM \"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\"\nGROUP BY state, city\nORDER BY state, SUM(activity_count) DESC\n    )", "query_id": "20240619_023619_00552_uxt54"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_activity_per_state", "compiled": true, "compiled_code": "\n\nSELECT\n  state,\n  city,\n  SUM(activity_count) AS total_activity\nFROM \"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\"\nGROUP BY state, city\nORDER BY state, SUM(activity_count) DESC", "relation_name": "\"datalake\".\"analytics\".\"mart_user_activity_per_state\""}], "elapsed_time": 6.502166271209717, "args": {"partial_parse": true, "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main\\dbt", "invocation_command": "dbt run", "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "log_format": "default", "defer": false, "which": "run", "cache_selected_only": false, "print": true, "static_parser": true, "select": [], "exclude": [], "favor_state": false, "vars": {}, "log_level_file": "debug", "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "printer_width": 80, "strict_mode": false, "write_json": true, "project_dir": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main\\dbt", "use_colors_file": true, "log_level": "info", "quiet": false, "source_freshness_run_project_hooks": false, "show_resource_report": false, "version_check": true, "introspect": true, "populate_cache": true, "empty": false, "log_format_file": "debug", "log_path": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main\\dbt\\logs", "require_resource_names_without_spaces": false, "use_colors": true, "macro_debugging": false, "enable_legacy_logger": false}}