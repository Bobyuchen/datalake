{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-06-18T06:09:05.911337Z", "invocation_id": "57a20281-fad0-4949-9f09-0caec42a9290", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:08:58.803523Z", "completed_at": "2024-06-18T06:08:58.809608Z"}, {"name": "execute", "started_at": "2024-06-18T06:08:58.810608Z", "completed_at": "2024-06-18T06:08:59.567942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7676248550415039, "adapter_response": {"_message": "SUCCESS", "rows_affected": 65, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_auth_events\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics_source\".\"src_auth_events__dbt_tmp\"\n      \n      \n    as (\n      \n\nwith source as (\n    select\n        CAST(ts AS VARCHAR) as id, \n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        level,\n        itemInSession,\n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,\n        success\n    from \"oltp\".\"public\".\"auth_events\"\n)\n\nselect\n    id,\n    ts,\n    sessionId,\n    level,\n    itemInSession,\n    city,\n    zip,\n    state,\n    userAgent,\n    lon,\n    lat,\n    userId,\n    lastName,\n    firstName,\n    gender,\n    registration, \n    CASE \n        WHEN CAST(success AS VARCHAR) = 't' THEN true \n        WHEN CAST(success AS VARCHAR) = 'f' THEN false\n        ELSE NULL \n    END AS success_boolean\nfrom source\n\n\n    )", "query_id": "20240618_044312_00221_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_auth_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(ts AS VARCHAR) as id, \n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        level,\n        itemInSession,\n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,\n        success\n    from \"oltp\".\"public\".\"auth_events\"\n)\n\nselect\n    id,\n    ts,\n    sessionId,\n    level,\n    itemInSession,\n    city,\n    zip,\n    state,\n    userAgent,\n    lon,\n    lat,\n    userId,\n    lastName,\n    firstName,\n    gender,\n    registration, \n    CASE \n        WHEN CAST(success AS VARCHAR) = 't' THEN true \n        WHEN CAST(success AS VARCHAR) = 'f' THEN false\n        ELSE NULL \n    END AS success_boolean\nfrom source\n\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_auth_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:08:59.575670Z", "completed_at": "2024-06-18T06:08:59.579692Z"}, {"name": "execute", "started_at": "2024-06-18T06:08:59.580692Z", "completed_at": "2024-06-18T06:09:00.425920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8532171249389648, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_listen_events\"} */\ninsert into \"datalake\".\"analytics_source\".\"src_listen_events\" (\"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\")\n    (\n        select \"id\", \"artist\", \"song\", \"duration\", \"ts\", \"sessionid\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"country\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\"\n        from \"datalake\".\"analytics_source\".\"src_listen_events__dbt_tmp\"\n    )", "query_id": "20240618_044313_00229_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_listen_events", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        CAST(_id AS VARCHAR) as id,\n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS DOUBLE) as duration,\n        ts,\n        sessionid,\n        auth,\n        level,\n        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,\n        city,\n        zip,\n        state,\n        country,\n        userAgent,\n        CAST(NULLIF(lon, '') AS DOUBLE) as lon,\n        CAST(NULLIF(lat, '') AS DOUBLE) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,\n -- Assurez-vous que userId peut aussi \u00eatre converti de cette mani\u00e8re.\n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration\n    from \"website\".\"demo\".\"listen_events\"\n\n)\n\nselect * from source\n\n\n\n    -- this filter will only be applied on an incremental run\n    where ts > (select max(ts) from \"datalake\".\"analytics_source\".\"src_listen_events\")\n\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_listen_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:00.431953Z", "completed_at": "2024-06-18T06:09:00.435458Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:00.435458Z", "completed_at": "2024-06-18T06:09:01.253485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8239853382110596, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.src_page_view_events\"} */\ninsert into \"datalake\".\"analytics_source\".\"src_page_view_events\" (\"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\")\n    (\n        select \"id\", \"ts\", \"sessionid\", \"page\", \"auth\", \"level\", \"iteminsession\", \"city\", \"zip\", \"state\", \"useragent\", \"lon\", \"lat\", \"userid\", \"lastname\", \"firstname\", \"gender\", \"registration\", \"artist\", \"song\", \"duration\"\n        from \"datalake\".\"analytics_source\".\"src_page_view_events__dbt_tmp\"\n    )", "query_id": "20240618_044314_00235_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.src_page_view_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(_id AS VARCHAR) as id,\n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        page,\n        auth,\n        level,\n        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, \n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, \n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS double) as duration\n    from \"website\".\"demo\".\"page_view_events\"\n)\n\nselect * from source\n\n\n    where ts > (select max(ts) from \"datalake\".\"analytics_source\".\"src_page_view_events\")\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_page_view_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:01.259195Z", "completed_at": "2024-06-18T06:09:01.262398Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:01.262926Z", "completed_at": "2024-06-18T06:09:01.351727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0941169261932373, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_level_by_gender\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\"\n  security definer\n  as\n    \n\nWITH user_subscriptions AS (\n    SELECT\n        gender,\n        level, \n        COUNT(DISTINCT userId) AS user_count\n    FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n    WHERE gender IS NOT NULL AND level IS NOT NULL\n    GROUP BY gender, level\n)\n\nSELECT\n    gender,\n    level,\n    user_count\nFROM user_subscriptions\n  ", "query_id": "20240618_044314_00237_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_level_by_gender", "compiled": true, "compiled_code": "\n\nWITH user_subscriptions AS (\n    SELECT\n        gender,\n        level, \n        COUNT(DISTINCT userId) AS user_count\n    FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n    WHERE gender IS NOT NULL AND level IS NOT NULL\n    GROUP BY gender, level\n)\n\nSELECT\n    gender,\n    level,\n    user_count\nFROM user_subscriptions", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:01.358087Z", "completed_at": "2024-06-18T06:09:01.361109Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:01.361109Z", "completed_at": "2024-06-18T06:09:01.994707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6392233371734619, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_streams_hourly\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics_stage\".\"stg_streams_hourly__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, \n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,\n    COUNT(*) AS total_streams\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nGROUP BY\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')\n    )", "query_id": "20240618_044314_00238_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_streams_hourly", "compiled": true, "compiled_code": "\n\nSELECT\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d') AS stream_date, \n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H') AS stream_hour,\n    COUNT(*) AS total_streams\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nGROUP BY\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%Y-%m-%d'),\n    DATE_FORMAT(FROM_UNIXTIME(ts), '%H')", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_streams_hourly\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:02.001567Z", "completed_at": "2024-06-18T06:09:02.005573Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:02.005573Z", "completed_at": "2024-06-18T06:09:02.105645Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10718965530395508, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_top_songs_artists\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_top_songs_artists\"\n  security definer\n  as\n    \n\nWITH song_plays AS (\n    SELECT\n        artist,\n        song,\n        COUNT(*) AS play_count\n    FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n    GROUP BY artist, song\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM song_plays\nORDER BY play_count DESC\n  ", "query_id": "20240618_044315_00242_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_top_songs_artists", "compiled": true, "compiled_code": "\n\nWITH song_plays AS (\n    SELECT\n        artist,\n        song,\n        COUNT(*) AS play_count\n    FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n    GROUP BY artist, song\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM song_plays\nORDER BY play_count DESC", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_top_songs_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:02.111458Z", "completed_at": "2024-06-18T06:09:02.115356Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:02.115890Z", "completed_at": "2024-06-18T06:09:02.205540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09577059745788574, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_unique_users\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_unique_users\"\n  security definer\n  as\n    \n\nSELECT\n    COUNT(DISTINCT userid) AS total_unique_users\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nWHERE userid IS NOT NULL\n  ", "query_id": "20240618_044315_00243_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_unique_users", "compiled": true, "compiled_code": "\n\nSELECT\n    COUNT(DISTINCT userid) AS total_unique_users\nFROM \"datalake\".\"analytics_source\".\"src_listen_events\"\nWHERE userid IS NOT NULL", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_unique_users\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:02.211561Z", "completed_at": "2024-06-18T06:09:02.216222Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:02.217219Z", "completed_at": "2024-06-18T06:09:02.271070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06701517105102539, "adapter_response": {}, "message": "Database Error in model stg_user_activity_per_country (models\\stage\\stg_user_activity_per_country.sql)\n  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message=\"line 17:3: UNION query has different number of fields: 4, 3\", query_id=20240618_044315_00244_z97n2)\n  compiled Code at target\\run\\my_dbt_trino_project\\models\\stage\\stg_user_activity_per_country.sql", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_activity_per_country", "compiled": true, "compiled_code": "\n\nWITH combined_activities AS (\n  SELECT\n    country,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n  WHERE country IS NOT NULL\n  UNION ALL\n  SELECT\n    'Unknown' AS country, \n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    'Unknown' AS country, \n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  country,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY country", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_user_activity_per_country\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:02.284952Z", "completed_at": "2024-06-18T06:09:02.289030Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:02.290027Z", "completed_at": "2024-06-18T06:09:02.412954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1306154727935791, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.stg_user_activity_per_location\"} */\n\n  create or replace view\n    \"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\"\n  security definer\n  as\n    \n\nWITH combined_activities AS (\n  SELECT\n    city,\n    state,\n    'auth_event' AS event_type,\n    ts,\n    userid\n FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  state,\n  city,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY state, city\n  ", "query_id": "20240618_044315_00245_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.stg_user_activity_per_location", "compiled": true, "compiled_code": "\n\nWITH combined_activities AS (\n  SELECT\n    city,\n    state,\n    'auth_event' AS event_type,\n    ts,\n    userid\n FROM \"datalake\".\"analytics_source\".\"src_auth_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'listen_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_listen_events\"\n  UNION ALL\n  SELECT\n    city,\n    state,\n    'page_view_event' AS event_type,\n    ts,\n    userid\n  FROM \"datalake\".\"analytics_source\".\"src_page_view_events\"\n)\n\nSELECT\n  state,\n  city,\n  COUNT(*) AS activity_count\nFROM combined_activities\nGROUP BY state, city", "relation_name": "\"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:02.420924Z", "completed_at": "2024-06-18T06:09:02.425750Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:02.426845Z", "completed_at": "2024-06-18T06:09:03.147574Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.728801965713501, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_level_by_gender\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_user_level_by_gender__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    gender,\n    level,\n    SUM(user_count) AS total_users,\n    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users\nFROM \"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\"\nGROUP BY gender, level\n    )", "query_id": "20240618_044316_00246_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_level_by_gender", "compiled": true, "compiled_code": "\n\nSELECT\n    gender,\n    level,\n    SUM(user_count) AS total_users,\n    ROUND(SUM(user_count) * 100.0 / SUM(SUM(user_count)) OVER (), 2) AS percentage_of_total_users\nFROM \"datalake\".\"analytics_stage\".\"stg_user_level_by_gender\"\nGROUP BY gender, level", "relation_name": "\"datalake\".\"analytics\".\"mart_user_level_by_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:03.153969Z", "completed_at": "2024-06-18T06:09:03.156054Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:03.157045Z", "completed_at": "2024-06-18T06:09:03.811198Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6604099273681641, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_hourly_stream_evolution\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_hourly_stream_evolution__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    stream_date,\n    stream_hour,\n    total_streams,\n    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams\nFROM \"datalake\".\"analytics_stage\".\"stg_streams_hourly\"\nORDER BY\n    stream_date,\n    stream_hour\n    )", "query_id": "20240618_044316_00250_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_hourly_stream_evolution", "compiled": true, "compiled_code": "\n\nSELECT\n    stream_date,\n    stream_hour,\n    total_streams,\n    SUM(total_streams) OVER (PARTITION BY stream_date ORDER BY stream_hour) AS cumulative_streams\nFROM \"datalake\".\"analytics_stage\".\"stg_streams_hourly\"\nORDER BY\n    stream_date,\n    stream_hour", "relation_name": "\"datalake\".\"analytics\".\"mart_hourly_stream_evolution\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:03.816614Z", "completed_at": "2024-06-18T06:09:03.819820Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:03.819873Z", "completed_at": "2024-06-18T06:09:04.492912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.678093433380127, "adapter_response": {"_message": "SUCCESS", "rows_affected": 14, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_top_songs_artists\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_top_songs_artists__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH top_songs AS (\n    SELECT\n        artist,\n        song,\n        play_count\n    FROM \"datalake\".\"analytics_stage\".\"stg_top_songs_artists\"\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM top_songs\n    )", "query_id": "20240618_044317_00254_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_top_songs_artists", "compiled": true, "compiled_code": "\n\nWITH top_songs AS (\n    SELECT\n        artist,\n        song,\n        play_count\n    FROM \"datalake\".\"analytics_stage\".\"stg_top_songs_artists\"\n)\n\nSELECT\n    artist,\n    song,\n    play_count\nFROM top_songs", "relation_name": "\"datalake\".\"analytics\".\"mart_top_songs_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:04.499363Z", "completed_at": "2024-06-18T06:09:04.503065Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:04.503585Z", "completed_at": "2024-06-18T06:09:05.161607Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6649198532104492, "adapter_response": {"_message": "SUCCESS", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_total_unique_users\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_total_unique_users__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    total_unique_users\nFROM \"datalake\".\"analytics_stage\".\"stg_unique_users\"\n    )", "query_id": "20240618_044318_00258_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_total_unique_users", "compiled": true, "compiled_code": "\n\nSELECT\n    total_unique_users\nFROM \"datalake\".\"analytics_stage\".\"stg_unique_users\"", "relation_name": "\"datalake\".\"analytics\".\"mart_total_unique_users\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_activity_per_country", "compiled": false, "compiled_code": null, "relation_name": "\"datalake\".\"analytics\".\"mart_user_activity_per_country\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-18T06:09:05.169677Z", "completed_at": "2024-06-18T06:09:05.172784Z"}, {"name": "execute", "started_at": "2024-06-18T06:09:05.173786Z", "completed_at": "2024-06-18T06:09:05.904330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7368390560150146, "adapter_response": {"_message": "SUCCESS", "rows_affected": 15, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"my_dbt_trino_project\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_trino_project.mart_user_activity_per_state\"} */\n\n  \n    \n\n    create table \"datalake\".\"analytics\".\"mart_user_activity_per_state__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n  state,\n  city,\n  SUM(activity_count) AS total_activity\nFROM \"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\"\nGROUP BY state, city\nORDER BY state, SUM(activity_count) DESC\n    )", "query_id": "20240618_044318_00262_z97n2"}, "message": "SUCCESS", "failures": null, "unique_id": "model.my_dbt_trino_project.mart_user_activity_per_state", "compiled": true, "compiled_code": "\n\nSELECT\n  state,\n  city,\n  SUM(activity_count) AS total_activity\nFROM \"datalake\".\"analytics_stage\".\"stg_user_activity_per_location\"\nGROUP BY state, city\nORDER BY state, SUM(activity_count) DESC", "relation_name": "\"datalake\".\"analytics\".\"mart_user_activity_per_state\""}], "elapsed_time": 7.6038312911987305, "args": {"log_path": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main\\dbt\\logs", "empty": false, "project_dir": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main\\dbt", "vars": {}, "indirect_selection": "eager", "populate_cache": true, "select": [], "source_freshness_run_project_hooks": false, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "write_json": true, "log_format": "default", "enable_legacy_logger": false, "profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\Iceberg-Dbt-Trino-Hive-modern-open-source-data-stack-main\\dbt", "use_colors_file": true, "log_level_file": "debug", "log_file_max_bytes": 10485760, "quiet": false, "require_resource_names_without_spaces": false, "show_resource_report": false, "print": true, "introspect": true, "partial_parse": true, "strict_mode": false, "invocation_command": "dbt run", "printer_width": 80, "partial_parse_file_diff": true, "use_colors": true, "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "which": "run", "static_parser": true, "defer": false, "cache_selected_only": false, "version_check": true, "favor_state": false, "macro_debugging": false, "exclude": []}}