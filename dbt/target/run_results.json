{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-07-23T08:59:30.282740Z", "invocation_id": "fc2d4eaf-e32b-4297-af25-d1e895c961ad", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2024-07-23T08:59:28.536916Z", "completed_at": "2024-07-23T08:59:28.543488Z"}, {"name": "execute", "started_at": "2024-07-23T08:59:28.543488Z", "completed_at": "2024-07-23T08:59:29.618899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0887694358825684, "adapter_response": {}, "message": "Database Error in model src_auth_events (models\\source\\src_auth_events.sql)\n  TrinoQueryError(type=INTERNAL_ERROR, name=GENERIC_INTERNAL_ERROR, message=\"The AWS Access Key Id you provided does not exist in our records. (Service: Amazon S3; Status Code: 403; Error Code: InvalidAccessKeyId; Request ID: KJT7N9KH8WA031JD; S3 Extended Request ID: Zy3MDJKLTGnJoQYzAGYnUA+bPMv6Tsdqm2urHkbiJLlNwcKYNvrRxgDSkU/Xtmv2iP8y+VipaD0XUAAa08ozQQ==; Proxy: null)\", query_id=20240723_085928_00014_q56p3)\n  compiled Code at target\\run\\my_dbt_trino_project\\models\\source\\src_auth_events.sql", "failures": null, "unique_id": "model.my_dbt_trino_project.src_auth_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(ts AS VARCHAR) as id, \n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        level,\n        itemInSession,\n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(FLOOR(CAST(NULLIF(userId, '') AS DOUBLE)) AS INT) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(FLOOR(CAST(NULLIF(registration, '') AS DOUBLE)) AS BIGINT) as registration,\n        success\n    from \"oltp\".\"public\".\"auth_events\"\n)\n\nselect\n    id,\n    ts,\n    sessionId,\n    level,\n    itemInSession,\n    city,\n    zip,\n    state,\n    userAgent,\n    lon,\n    lat,\n    userId,\n    lastName,\n    firstName,\n    gender,\n    registration, \n    CASE \n        WHEN CAST(success AS VARCHAR) = 't' THEN true \n        WHEN CAST(success AS VARCHAR) = 'f' THEN false\n        ELSE NULL \n    END AS success_boolean\nfrom source\n\n\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_auth_events\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2024-07-23T08:59:29.630186Z", "completed_at": "2024-07-23T08:59:29.633699Z"}, {"name": "execute", "started_at": "2024-07-23T08:59:29.633699Z", "completed_at": "2024-07-23T08:59:29.977056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3515610694885254, "adapter_response": {}, "message": "Database Error in model src_listen_events (models\\source\\src_listen_events.sql)\n  TrinoQueryError(type=INTERNAL_ERROR, name=GENERIC_INTERNAL_ERROR, message=\"The AWS Access Key Id you provided does not exist in our records. (Service: Amazon S3; Status Code: 403; Error Code: InvalidAccessKeyId; Request ID: KJT0KR7GAYCPTMQV; S3 Extended Request ID: z6iM2voB02VlsxUbPRbULdosMyVXz3xedpBS++dVfeeQkVzXfJJNlb+g/zJ0UZAHwMfJ+b6DbWQULgVlx8Xq4Q==; Proxy: null)\", query_id=20240723_085929_00015_q56p3)\n  compiled Code at target\\run\\my_dbt_trino_project\\models\\source\\src_listen_events.sql", "failures": null, "unique_id": "model.my_dbt_trino_project.src_listen_events", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        CAST(_id AS VARCHAR) as id,\n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS DOUBLE) as duration,\n        ts,\n        sessionid,\n        auth,\n        level,\n        CAST(NULLIF(itemInSession, '') AS INTEGER) as itemInSession,\n        city,\n        zip,\n        state,\n        country,\n        userAgent,\n        CAST(NULLIF(lon, '') AS DOUBLE) as lon,\n        CAST(NULLIF(lat, '') AS DOUBLE) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId,\n -- Assurez-vous que userId peut aussi \u00eatre converti de cette mani\u00e8re.\n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration\n    from \"website\".\"demo\".\"listen_events\"\n\n)\n\nselect * from source\n\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_listen_events\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2024-07-23T08:59:29.986285Z", "completed_at": "2024-07-23T08:59:29.990649Z"}, {"name": "execute", "started_at": "2024-07-23T08:59:29.991173Z", "completed_at": "2024-07-23T08:59:30.274219Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.29250097274780273, "adapter_response": {}, "message": "Database Error in model src_page_view_events (models\\source\\src_page_view_events.sql)\n  TrinoQueryError(type=INTERNAL_ERROR, name=GENERIC_INTERNAL_ERROR, message=\"The AWS Access Key Id you provided does not exist in our records. (Service: Amazon S3; Status Code: 403; Error Code: InvalidAccessKeyId; Request ID: PQN9MF714AYA9S9Q; S3 Extended Request ID: bSdCZVnJo+KUHj8PccPDHnkU4zpHh3M+SsQCPUI4QWenHJ4ZCnR5n6avQz863De8Gu6RcSoXEoOAGJdgK3pY4w==; Proxy: null)\", query_id=20240723_085930_00016_q56p3)\n  compiled Code at target\\run\\my_dbt_trino_project\\models\\source\\src_page_view_events.sql", "failures": null, "unique_id": "model.my_dbt_trino_project.src_page_view_events", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n        CAST(_id AS VARCHAR) as id,\n        ts,\n        CAST(sessionId AS VARCHAR) as sessionId,\n        page,\n        auth,\n        level,\n        CAST(CAST(NULLIF(itemInSession, '') AS DOUBLE) AS INTEGER) as itemInSession, \n        city,\n        zip,\n        state,\n        userAgent,\n        CAST(NULLIF(lon, '') AS double) as lon,\n        CAST(NULLIF(lat, '') AS double) as lat,\n        CAST(CAST(NULLIF(userId, '') AS DOUBLE) AS INTEGER) as userId, \n        lastName,\n        firstName,\n        gender,\n        CAST(CAST(NULLIF(registration, '') AS DOUBLE) AS BIGINT) as registration, \n        artist,\n        song,\n        CAST(NULLIF(duration, '') AS double) as duration\n    from \"website\".\"demo\".\"page_view_events\"\n)\n\nselect * from source\n\n", "relation_name": "\"datalake\".\"analytics_source\".\"src_page_view_events\""}], "elapsed_time": 2.9696602821350098, "args": {"profiles_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt", "print": true, "partial_parse": true, "quiet": false, "empty": false, "project_dir": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt", "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "exclude": [], "indirect_selection": "eager", "favor_state": false, "defer": false, "vars": {}, "printer_width": 80, "strict_mode": false, "macro_debugging": false, "use_colors": true, "enable_legacy_logger": false, "invocation_command": "dbt run --models source", "log_format": "default", "log_level": "info", "source_freshness_run_project_hooks": false, "send_anonymous_usage_stats": true, "populate_cache": true, "use_colors_file": true, "introspect": true, "log_file_max_bytes": 10485760, "write_json": true, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "select": ["source"], "log_path": "C:\\Users\\ASUS\\Desktop\\work\\datalake\\dbt\\logs", "log_level_file": "debug", "partial_parse_file_diff": true, "static_parser": true, "which": "run", "log_format_file": "debug", "show_resource_report": false}}